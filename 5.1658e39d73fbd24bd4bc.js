(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{Iab2:function(t,e,i){var n,r;void 0===(r="function"==typeof(n=function(){"use strict";function e(t,e,i){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){o(n.response,e,i)},n.onerror=function(){console.error("could not download file")},n.send()}function i(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function n(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(e){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(i)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(t,a,o){var s=r.URL||r.webkitURL,c=document.createElement("a");c.download=a=a||t.name||"download",c.rel="noopener","string"==typeof t?(c.href=t,c.origin===location.origin?n(c):i(c.href)?e(t,a,o):n(c,c.target="_blank")):(c.href=s.createObjectURL(t),setTimeout(function(){s.revokeObjectURL(c.href)},4e4),setTimeout(function(){n(c)},0))}:"msSaveOrOpenBlob"in navigator?function(t,r,a){if(r=r||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,a),r);else if(i(t))e(t,r,a);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout(function(){n(o)})}}:function(t,i,n,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof t)return e(t,i,n);var s="application/octet-stream"===t.type,c=/constructor/i.test(r.HTMLElement)||r.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||s&&c||a)&&"undefined"!=typeof FileReader){var l=new FileReader;l.onloadend=function(){var t=l.result;t=g?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=t:location=t,o=null},l.readAsDataURL(t)}else{var b=r.URL||r.webkitURL,d=b.createObjectURL(t);o?o.location=d:location.href=d,o=null,setTimeout(function(){b.revokeObjectURL(d)},4e4)}});r.saveAs=o.saveAs=o,t.exports=o})?n.apply(e,[]):n)||(t.exports=r)},b0Xh:function(t,e,i){var r;(function(){var i=function(t){return t instanceof i?t:this instanceof i?void(this.EXIFwrapped=t):new i(t)};t.exports&&(e=t.exports=i),e.EXIF=i;var a=i.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},o=i.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},s=i.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},c=i.IFD1Tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},g=i.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function l(t){return!!t.exifdata}function b(t){var e=new DataView(t);if(255!=e.getUint8(0)||216!=e.getUint8(1))return!1;for(var i=2,n=t.byteLength;i<n;){if(255!=e.getUint8(i))return!1;if(225==e.getUint8(i+1))return f(e,i+4,e.getUint16(i+2));i+=2+e.getUint16(i+2)}}var d={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function u(t,e,i){for(var n,r,a,o,s=new DataView(t),c={},g=e;g<e+i;)28===s.getUint8(g)&&2===s.getUint8(g+1)&&(o=s.getUint8(g+2))in d&&(a=s.getInt16(g+3),r=d[o],n=m(s,g+5,a),c.hasOwnProperty(r)?c[r]instanceof Array?c[r].push(n):c[r]=[c[r],n]:c[r]=n),g++;return c}function h(t,e,i,n,r){var a,o,s=t.getUint16(i,!r),c={};for(o=0;o<s;o++)c[n[t.getUint16(a=i+12*o+2,!r)]]=p(t,a,e,0,r);return c}function p(t,e,i,n,r){var a,o,s,c,g,l,b=t.getUint16(e+2,!r),d=t.getUint32(e+4,!r),u=t.getUint32(e+8,!r)+i;switch(b){case 1:case 7:if(1==d)return t.getUint8(e+8,!r);for(a=d>4?u:e+8,o=[],c=0;c<d;c++)o[c]=t.getUint8(a+c);return o;case 2:return m(t,a=d>4?u:e+8,d-1);case 3:if(1==d)return t.getUint16(e+8,!r);for(a=d>2?u:e+8,o=[],c=0;c<d;c++)o[c]=t.getUint16(a+2*c,!r);return o;case 4:if(1==d)return t.getUint32(e+8,!r);for(o=[],c=0;c<d;c++)o[c]=t.getUint32(u+4*c,!r);return o;case 5:if(1==d)return g=t.getUint32(u,!r),l=t.getUint32(u+4,!r),(s=new Number(g/l)).numerator=g,s.denominator=l,s;for(o=[],c=0;c<d;c++)g=t.getUint32(u+8*c,!r),l=t.getUint32(u+4+8*c,!r),o[c]=new Number(g/l),o[c].numerator=g,o[c].denominator=l;return o;case 9:if(1==d)return t.getInt32(e+8,!r);for(o=[],c=0;c<d;c++)o[c]=t.getInt32(u+4*c,!r);return o;case 10:if(1==d)return t.getInt32(u,!r)/t.getInt32(u+4,!r);for(o=[],c=0;c<d;c++)o[c]=t.getInt32(u+8*c,!r)/t.getInt32(u+4+8*c,!r);return o}}function m(t,e,i){var r="";for(n=e;n<e+i;n++)r+=String.fromCharCode(t.getUint8(n));return r}function f(t,e){if("Exif"!=m(t,e,4))return!1;var i,n,r,l,b,d=e+6;if(18761==t.getUint16(d))i=!1;else{if(19789!=t.getUint16(d))return!1;i=!0}if(42!=t.getUint16(d+2,!i))return!1;var u=t.getUint32(d+4,!i);if(u<8)return!1;if((n=h(t,d,d+u,o,i)).ExifIFDPointer)for(r in l=h(t,d,d+n.ExifIFDPointer,a,i)){switch(r){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":l[r]=g[r][l[r]];break;case"ExifVersion":case"FlashpixVersion":l[r]=String.fromCharCode(l[r][0],l[r][1],l[r][2],l[r][3]);break;case"ComponentsConfiguration":l[r]=g.Components[l[r][0]]+g.Components[l[r][1]]+g.Components[l[r][2]]+g.Components[l[r][3]]}n[r]=l[r]}if(n.GPSInfoIFDPointer)for(r in b=h(t,d,d+n.GPSInfoIFDPointer,s,i)){switch(r){case"GPSVersionID":b[r]=b[r][0]+"."+b[r][1]+"."+b[r][2]+"."+b[r][3]}n[r]=b[r]}return n.thumbnail=function(t,e,i,n){var r=function(t,e,i){var n=t.getUint16(e,!i);return t.getUint32(e+2+12*n,!i)}(t,e+i,n);if(!r)return{};if(r>t.byteLength)return{};var a=h(t,e,e+r,c,n);if(a.Compression)switch(a.Compression){case 6:a.JpegIFOffset&&a.JpegIFByteCount&&(a.blob=new Blob([new Uint8Array(t.buffer,e+a.JpegIFOffset,a.JpegIFByteCount)],{type:"image/jpeg"}));break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",a.Compression)}else 2==a.PhotometricInterpretation&&console.log("Thumbnail image format is RGB, which is not implemented.");return a}(t,d,u,i),n}function O(t){var e={};if(1==t.nodeType){if(t.attributes.length>0){e["@attributes"]={};for(var i=0;i<t.attributes.length;i++){var n=t.attributes.item(i);e["@attributes"][n.nodeName]=n.nodeValue}}}else if(3==t.nodeType)return t.nodeValue;if(t.hasChildNodes())for(var r=0;r<t.childNodes.length;r++){var a=t.childNodes.item(r),o=a.nodeName;if(null==e[o])e[o]=O(a);else{if(null==e[o].push){var s=e[o];e[o]=[],e[o].push(s)}e[o].push(O(a))}}return e}function v(t){try{var e={};if(t.children.length>0)for(var i=0;i<t.children.length;i++){var n=t.children.item(i),r=n.attributes;for(var a in r){var o=r[a],s=o.nodeName;void 0!==s&&(e[s]=o.nodeValue)}var c=n.nodeName;if(void 0===e[c])e[c]=O(n);else{if(void 0===e[c].push){var g=e[c];e[c]=[],e[c].push(g)}e[c].push(O(n))}}else e=t.textContent;return e}catch(l){console.log(l.message)}}i.enableXmp=function(){i.isXmpEnabled=!0},i.disableXmp=function(){i.isXmpEnabled=!1},i.getData=function(t,e){return!((self.Image&&t instanceof self.Image||self.HTMLImageElement&&t instanceof self.HTMLImageElement)&&!t.complete||(l(t)?e&&e.call(t):function(t,e){function n(n){var r=b(n);t.exifdata=r||{};var a=function(t){var e=new DataView(t);if(255!=e.getUint8(0)||216!=e.getUint8(1))return!1;for(var i=2,n=t.byteLength,r=function(t,e){return 56===t.getUint8(e)&&66===t.getUint8(e+1)&&73===t.getUint8(e+2)&&77===t.getUint8(e+3)&&4===t.getUint8(e+4)&&4===t.getUint8(e+5)};i<n;){if(r(e,i)){var a=e.getUint8(i+7);return a%2!=0&&(a+=1),0===a&&(a=4),u(t,i+8+a,e.getUint16(i+6+a))}i++}}(n);if(t.iptcdata=a||{},i.isXmpEnabled){var o=function(t){if("DOMParser"in self){var e=new DataView(t);if(255!=e.getUint8(0)||216!=e.getUint8(1))return!1;for(var i=2,n=t.byteLength,r=new DOMParser;i<n-4;){if("http"==m(e,i,4)){var a=i-1,o=e.getUint16(i-2)-1,s=m(e,a,o),c=s.indexOf("xmpmeta>")+8,g=(s=s.substring(s.indexOf("<x:xmpmeta"),c)).indexOf("x:xmpmeta")+10;return s=s.slice(0,g)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+s.slice(g),v(r.parseFromString(s,"text/xml"))}i++}}}(n);t.xmpdata=o||{}}e&&e.call(t)}if(t.src)if(/^data\:/i.test(t.src))n(function(t,e){e=e||t.match(/^data\:([^\;]+)\;base64,/im)[1]||"",t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var i=atob(t),n=i.length,r=new ArrayBuffer(n),a=new Uint8Array(r),o=0;o<n;o++)a[o]=i.charCodeAt(o);return r}(t.src));else if(/^blob\:/i.test(t.src))(a=new FileReader).onload=function(t){n(t.target.result)},function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="blob",i.onload=function(t){200!=this.status&&0!==this.status||a.readAsArrayBuffer(this.response)},i.send()}(t.src);else{var r=new XMLHttpRequest;r.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";n(r.response),r=null},r.open("GET",t.src,!0),r.responseType="arraybuffer",r.send(null)}else if(self.FileReader&&(t instanceof self.Blob||t instanceof self.File)){var a;(a=new FileReader).onload=function(t){n(t.target.result)},a.readAsArrayBuffer(t)}}(t,e),0))},i.getTag=function(t,e){if(l(t))return t.exifdata[e]},i.getIptcTag=function(t,e){if(l(t))return t.iptcdata[e]},i.getAllTags=function(t){if(!l(t))return{};var e,i=t.exifdata,n={};for(e in i)i.hasOwnProperty(e)&&(n[e]=i[e]);return n},i.getAllIptcTags=function(t){if(!l(t))return{};var e,i=t.iptcdata,n={};for(e in i)i.hasOwnProperty(e)&&(n[e]=i[e]);return n},i.pretty=function(t){if(!l(t))return"";var e,i=t.exifdata,n="";for(e in i)i.hasOwnProperty(e)&&(n+="object"==typeof i[e]?i[e]instanceof Number?e+" : "+i[e]+" ["+i[e].numerator+"/"+i[e].denominator+"]\r\n":e+" : ["+i[e].length+" values]\r\n":e+" : "+i[e]+"\r\n");return n},i.readFromBinaryFile=function(t){return b(t)},void 0===(r=(function(){return i}).apply(e,[]))||(t.exports=r)}).call(this)},sFyk:function(t,e,i){"use strict";i.r(e),i.d(e,"PagesModule",function(){return tn});var n=i("ofXK"),r=i("d8Z/"),a=i("hTao"),o=i("fXoL"),s=i("tyNb"),c=i("0yvB"),g=i("rmxa"),l=i("aZ8m"),b=i("BAfr"),d=i("+803"),u=i("aF9I");let h=(()=>{class t{constructor(t,e,i){this.route=t,this.navServices=e,this.layout=i,this.route.queryParams.subscribe(t=>{this.layout.config.settings.layout=t.layout?t.layout:this.layout.config.settings.layout})}ngAfterViewInit(){setTimeout(()=>{r.replace()})}getRouterOutletState(t){return t.isActivated?t.activatedRoute:""}get layoutClass(){switch(this.layout.config.settings.layout){case"Dubai":return"compact-wrapper";case"London":return"only-body";case"Seoul":return"compact-wrapper modern-type";case"LosAngeles":return this.navServices.horizontal?"horizontal-wrapper material-type":"compact-wrapper material-type";case"Paris":return"compact-wrapper dark-sidebar";case"Tokyo":return"compact-sidebar";case"Madrid":return"compact-wrapper color-sidebar";case"Moscow":return"compact-sidebar compact-small";case"NewYork":return"compact-wrapper box-layout";case"Singapore":return this.navServices.horizontal?"horizontal-wrapper enterprice-type":"compact-wrapper enterprice-type";case"Rome":return"compact-sidebar compact-small material-icon";case"Barcelona":return this.navServices.horizontal?"horizontal-wrapper enterprice-type advance-layout":"compact-wrapper enterprice-type advance-layout"}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(s.a),o.Jb(c.a),o.Jb(g.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-pages"]],decls:13,vars:8,consts:[[3,"ngClass"],["id","canvas-bookmark",1,"page-wrapper",3,"ngClass"],[1,"page-body-wrapper"],[1,"sidebar-wrapper"],[1,"page-body"],["o","outlet"],[1,"footer"]],template:function(t,e){if(1&t&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Kb(2,"app-header"),o.Ob(3,"div",2),o.Ob(4,"div",3),o.Kb(5,"app-sidebar"),o.Nb(),o.Ob(6,"div",4),o.Ob(7,"main"),o.Kb(8,"app-breadcrumb"),o.Kb(9,"router-outlet",null,5),o.Nb(),o.Nb(),o.Ob(11,"footer",6),o.Kb(12,"app-footer"),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&t){const t=o.ic(10);o.zb(e.layout.config.settings.layout_version),o.cc("ngClass",e.layout.config.settings.layout_type),o.xb(1),o.cc("ngClass",e.layoutClass),o.xb(3),o.Bb("close_icon",e.navServices.collapseSidebar),o.yb("sidebar-layout",e.layout.config.settings.sidebar_type),o.xb(3),o.cc("@fadeInAnimation",e.getRouterOutletState(t))}},directives:[n.k,l.a,b.a,d.a,s.k,u.a],styles:[""],data:{animation:[a.a]}}),t})();var p=i("kIR3"),m=i("itAP"),f=i("lJxs"),O=i("tk/3"),v=i("IYfF"),x=i("Nl8B");let P=(()=>{class t{constructor(t,e,i){this.http=t,this.authService=e,this.paginationService=i,this.photographerData={email:null,id:null},this.imagesEdited=new o.n}getImages(t,e=null){const i=this.getData(t,e);return this.http.post(m.a+"/images/search/admin",i).pipe(Object(f.a)(t=>(this.paginationService.updatePagination(t.total,t.skip),t)))}getImagesClient(t,e=null){const i=this.getData(t,e);return this.http.post(m.a+"/images/search/client",i).pipe(Object(f.a)(t=>(this.paginationService.updatePagination(t.total,t.skip),t)))}getData(t,e){const i={filters:t,pagination:this.paginationService.paginationData};return e&&"ahead"==e&&(i.pagination=Object.assign(Object.assign({},i.pagination),{actualPage:i.pagination.actualPage+1})),e&&"behind"==e&&(i.pagination=Object.assign(Object.assign({},i.pagination),{actualPage:i.pagination.actualPage-1})),i}getImage(t){let e=m.a+"/images/image-detail/"+t;return this.authService.user||(e=m.a+"/images/nologin-image-detail/"+t),this.http.get(e)}saveImage(t){const e={ownerId:this.authService.user.email?this.authService.user.email:this.authService.user.username,creationDate:Object(p.a)(t.exifData.DateTime),fileName:t.fileName,copyFileName:t.copyFileName,exifData:t.exifData,imgSync:t.imgSync,tags:t.tags,photographerId:this.authService.user.email?this.authService.user.email:this.authService.user.username,photographerData:this.photographerData,uploadDate:new Date,wasCloud:t.wasCloud};return"ADMIN_ROLE"==this.authService.user.role&&(e.ownerId=this.photographerData.email,e.photographerId=this.photographerData.email),"PHOTOGRAPHER_ROLE"==this.authService.user.role&&(e.ownerId=this.authService.user.email,e.photographerId=this.authService.user.email,e.photographerData=this.authService.user),this.http.post(m.a+"/images/"+this.authService.user._id,e)}editImageTags(t){return this.http.put(m.a+"/images/edit-tags/"+this.authService.user.email,t)}deleteImage(t){return this.http.delete(m.a+"/images/"+t._id)}recycleImage(t){let e=m.a+"/images/temporarly/"+t.photographerId;return e+="?token="+this.authService.token+"&imageId="+t._id,this.http.delete(e)}restoreImage(t){const e=t.photographerId;return this.http.put(m.a+"/images/restore/"+e,{ownerId:e,imageId:t._id})}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(O.b),o.Sb(v.a),o.Sb(x.a))},t.\u0275prov=o.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var C=i("J2l8"),M=i("Xgv5");let N=(()=>{class t{constructor(t){this.ps=t,this.filters=null,this.images=[],this.imageIndex=null,this.currentPageIndex=null}parseFilters(t){return t.date.to&&(t.date.to=t.date.to.endOf("day")),t}resetData(){this.filters=null,this.images=[],this.imageIndex=null,this.currentPageIndex=null}setData(t,e,i=[],n=[]){this.filters=e,this.images=i,t.forEach(t=>{this.images.includes(t._id)||this.images.push(t._id)}),this.images=[...this.images,...n],localStorage.setItem("images",JSON.stringify(this.images)),localStorage.setItem("filters",JSON.stringify(this.filters))}getDataIfExists(){localStorage.getItem("images")&&(this.images=JSON.parse(localStorage.getItem("images"))),localStorage.getItem("filters")&&(this.filters=JSON.parse(localStorage.getItem("filters")))}setGalleryIndex(t){this.imageIndex=this.images.indexOf(t),null==this.currentPageIndex&&(this.currentPageIndex=this.imageIndex)}setActualPage(t){1==t&&this.currentPageIndex==this.ps.paginationData.perPage&&(this.ps.paginationData.actualPage+=t,this.currentPageIndex=0),-1==t&&this.currentPageIndex<0&&(this.ps.paginationData.actualPage+=t,this.currentPageIndex=this.ps.paginationData.perPage-1)}checkPages(t="ahead"){const e=this.ps.paginationData.pages,i=e.indexOf(this.ps.paginationData.actualPage);return"ahead"===t?i<e.length-1:i>0}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(x.a))},t.\u0275prov=o.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var y=i("dxD2"),_=i("vxdj");let I=(()=>{class t{constructor(t){this.router=t,this.currentUrl=this.router.url,t.events.subscribe(t=>{t instanceof s.e&&(this.previousUrl=this.currentUrl,this.currentUrl=t.url)})}getPreviousUrl(){return this.previousUrl}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(s.f))},t.\u0275prov=o.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var S=i("3Pt+"),w=i("NhFE"),k=i("pqks"),D=i("i2NW"),F=i("IgG/"),T=i("PSD3"),A=i.n(T);function E(t,e){if(1&t){const t=o.Pb();o.Ob(0,"button",9),o.Vb("click",function(){o.kc(t);const i=e.$implicit;return o.Yb(2).removeTag(i)}),o.rc(1),o.Kb(2,"app-feather-icons",10),o.Nb()}if(2&t){const t=e.$implicit;o.xb(1),o.tc(" ",t," ")}}function q(t,e){if(1&t&&(o.Ob(0,"div",7),o.qc(1,E,3,1,"button",8),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngForOf",t.currentTags)}}function Y(t,e){if(1&t){const t=o.Pb();o.Ob(0,"li",13),o.Vb("click",function(){o.kc(t);const i=e.$implicit;return o.Yb(2).addTag(i)}),o.rc(1),o.Nb()}if(2&t){const t=e.$implicit;o.xb(1),o.tc(" ",t.value," ")}}function R(t,e){if(1&t&&(o.Ob(0,"div",11),o.Ob(1,"ul"),o.qc(2,Y,2,1,"li",12),o.Nb(),o.Nb()),2&t){const t=o.Yb();o.xb(2),o.cc("ngForOf",t.tags)}}function j(t,e){if(1&t){const t=o.Pb();o.Ob(0,"li",13),o.Vb("click",function(){o.kc(t);const e=o.Yb(2);return e.createTag(e.searchTerm)}),o.rc(1," No se ha encontrado este tag. Haz click aqu\xed para crearlo "),o.Nb()}}function L(t,e){1&t&&(o.Ob(0,"li"),o.rc(1," No se ha encontrado un tag que coincida. "),o.Nb())}function V(t,e){if(1&t&&(o.Ob(0,"div",14),o.Ob(1,"ul"),o.qc(2,j,2,0,"li",15),o.qc(3,L,2,0,"li",16),o.Nb(),o.Nb()),2&t){const t=o.Yb();o.xb(2),o.cc("ngIf",!t.isHome),o.xb(1),o.cc("ngIf",t.isHome)}}let J=(()=>{class t{constructor(t,e){this.tagsService=t,this.paginationService=e,this.searching=!1,this.tags=[],this.perPage=5,this.tagsSelected=[],this.searchTerm="",this.currentTags=[],this.isHome=!1,this.tagsService.resetTags.subscribe(()=>{this.tagsSelected=[],this.currentTags=[],this.tags=[],this.searchTerm=""}),this.tagsService.tagsSelectedSidebar.subscribe(t=>{this.currentTags.indexOf(t.tag)>=0?this.removeTag(t.tag):this.addTag(t)})}ngOnInit(){}ngOnDestroy(){}searchTags(t){if(this.searching)setTimeout(()=>this.searchTags(t),50);else{if(!t)return this.tags=[],void(this.searching=!1);this.searching=!0,this.tagsService.getTags(t,this.currentTags,this.perPage).subscribe(t=>{this.tags=t.tags,this.searching=!1})}}getCurrentTags(){if(this.tagsSelected.length>0){let t=[];this.tagsSelected.forEach(e=>{t.push(e.tag)}),this.currentTags=t}else this.currentTags=[]}createTag(t){const e=new F.a;e.tag=t,this.tagsService.createTag(e).subscribe(t=>{this.addTag(t.tagSaved)},t=>Object(p.c)(t.error))}addTag(t){this.tagsSelected.push(t),this.getCurrentTags(),this.tagsService.tagsSelected.emit(this.currentTags),this.tags=[],this.searchTerm=""}removeTag(t){A.a.fire({title:"\xbfEst\xe1s seguro?",text:"Estas a punto de remover este tag, \xbfDeseas continuar?",icon:"question",showCancelButton:!0,confirmButtonText:"Remover",cancelButtonText:"Cancelar"}).then(e=>{if(e.isConfirmed){const e=this.currentTags.indexOf(t);this.currentTags.splice(e,1),this.tagsSelected=this.tagsSelected.filter(e=>e.tag!==t),this.tagsService.tagsSelected.emit(this.currentTags)}})}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(C.a),o.Jb(x.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-tags-selector"]],inputs:{isHome:"isHome"},decls:8,vars:5,consts:[[1,"tags"],["class","tags-added mb-4 minify-feather",4,"ngIf"],[1,"form-group"],["for",""],["name","term","type","text","placeholder","Tag's",1,"form-control",3,"ngModel","keyup","ngModelChange"],["class","tag-results",4,"ngIf"],["class","tag-results no-results",4,"ngIf"],[1,"tags-added","mb-4","minify-feather"],["type","button",3,"click",4,"ngFor","ngForOf"],["type","button",3,"click"],["icon","x"],[1,"tag-results"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"tag-results","no-results"],[3,"click",4,"ngIf"],[4,"ngIf"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.qc(1,q,2,1,"div",1),o.Ob(2,"div",2),o.Ob(3,"label",3),o.rc(4),o.Nb(),o.Ob(5,"input",4),o.Vb("keyup",function(){return e.searchTags(e.searchTerm)})("ngModelChange",function(t){return e.searchTerm=t}),o.Nb(),o.qc(6,R,3,1,"div",5),o.qc(7,V,4,2,"div",6),o.Nb(),o.Nb()),2&t&&(o.xb(1),o.cc("ngIf",e.currentTags.length>0),o.xb(3),o.sc(e.isHome?"Buscar por TAG":"A\xf1ade uno o varios tags"),o.xb(1),o.cc("ngModel",e.searchTerm),o.xb(1),o.cc("ngIf",e.tags.length>0),o.xb(1),o.cc("ngIf",e.tags.length<=0&&e.searchTerm&&e.currentTags.indexOf(e.searchTerm)<0))},directives:[n.m,S.a,S.i,S.k,n.l,k.a],styles:[".tags[_ngcontent-%COMP%]{position:relative}.tags-added[_ngcontent-%COMP%]{display:flex;align-items:center}.tags-added[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transition:all .3s ease;font-size:14px;color:#fff;background-color:orange;padding:8px 15px;border-radius:7px;border:1px solid orange;margin-right:10px}.tags-added[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#fff;color:orange}input[_ngcontent-%COMP%]{width:100%!important}.tag-results[_ngcontent-%COMP%]{position:absolute;top:100%;width:100%;z-index:999}.tag-results[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:10px 0;background:#fafafa;border-radius:0 0 7px 7px}.tag-results[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:10px 20px;cursor:pointer}.tag-results[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{transition:all .2s ease;background-color:orange;color:#fff}"]}),t})();class K{constructor(t,e,i,n,r="visible",a,o,s=0,c,g=[],l,b){this._id=t,this.ownerId=e,this.creationDate=i,this.uploadDate=n,this.status=r,this.fileName=a,this.copyFileName=o,this.totalSells=s,this.photographerId=c,this.tags=g,this.exifData=l,this.fullpath=b}}var U=i("Iab2");let B=(()=>{class t{constructor(t,e){this.http=t,this.authService=e}getUserProfile(){return this.http.get(m.a+"/profile/"+this.authService.user._id)}editProfile(t){return this.http.put(m.a+"/profile/"+this.authService.user._id,t)}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(O.b),o.Sb(v.a))},t.\u0275prov=o.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var H=i("iCQh");const $=function(t){return{"img-vertical":t}};function G(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",15),o.Ob(1,"img",16),o.Vb("error",function(e){o.kc(t);const i=o.Yb(2);return i.setDefaultPic(e,i.image)}),o.Nb(),o.Nb()}if(2&t){const t=o.Yb(2);o.cc("ngClass",o.fc(2,$,t.image.exifData&&t.image.exifData.Orientation>=5)),o.xb(1),o.cc("src",t.image.fullpath,o.mc)}}function z(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",17),o.Ob(1,"img",16),o.Vb("error",function(e){o.kc(t);const i=o.Yb(2);return i.setDefaultPic(e,i.image)}),o.Nb(),o.Nb()}if(2&t){const t=o.Yb(2);o.cc("ngClass",o.fc(2,$,t.image.exifData&&t.image.exifData.Orientation>=5)),o.xb(1),o.cc("src",t.image.fullpath,o.mc)}}function Z(t,e){if(1&t&&(o.Ob(0,"span",20),o.rc(1),o.Nb()),2&t){const t=e.$implicit;o.xb(1),o.tc(" ",t," ")}}function X(t,e){if(1&t&&(o.Ob(0,"div",18),o.qc(1,Z,2,1,"span",19),o.Nb()),2&t){const t=o.Yb(2);o.xb(1),o.cc("ngForOf",t.image.tags)}}function W(t,e){1&t&&o.Kb(0,"span",21)}function Q(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",6),o.Vb("click",function(){o.kc(t);const e=o.Yb();return e.goToImage(e.image)}),o.qc(1,G,2,4,"div",7),o.qc(2,z,2,4,"div",8),o.qc(3,X,2,1,"div",9),o.qc(4,W,1,0,"span",10),o.Ob(5,"div",11),o.Ob(6,"div",12),o.Ob(7,"span",13),o.rc(8,"Fecha:"),o.Nb(),o.rc(9),o.Zb(10,"date"),o.Nb(),o.Nb(),o.Ob(11,"div",14),o.Ob(12,"div",12),o.Ob(13,"span",13),o.rc(14,"Fotografo:"),o.Nb(),o.rc(15),o.Nb(),o.Nb(),o.Nb()}if(2&t){const t=o.Yb();o.cc("id","image_"+t.image._id),o.xb(1),o.cc("ngIf",!t.authService.user||t.authService.user.purchases.indexOf(t.image._id)<0),o.xb(1),o.cc("ngIf",t.authService.user&&t.authService.user.purchases.indexOf(t.image._id)>=0),o.xb(1),o.cc("ngIf",t.image.tags.length>0),o.xb(1),o.cc("ngIf",0==t.image.tags.length),o.xb(5),o.tc(" ",o.bc(10,7,t.image.creationDate,"dd/MM/yyyy HH:mm:ss")," "),o.xb(6),o.tc(" ",t.image.photographerData.name+" "+(t.image.photographerData.lastName?t.image.photographerData.lastName:"")," ")}}function tt(t,e){if(1&t){const t=o.Pb();o.Ob(0,"button",25),o.Vb("click",function(){o.kc(t);const e=o.Yb(2);return e.addToCart(e.image._id)}),o.rc(1," A\xf1adir al carrito "),o.Kb(2,"app-feather-icons",26),o.Nb()}if(2&t){const t=o.Yb(2);o.cc("disabled",t.loading),o.xb(2),o.cc("icon","shopping-cart")}}function et(t,e){1&t&&(o.Ob(0,"button",27),o.rc(1," A\xf1adido al carrito "),o.Kb(2,"app-feather-icons",26),o.Nb()),2&t&&(o.xb(2),o.cc("icon","check"))}function it(t,e){if(1&t&&(o.Ob(0,"div",22),o.qc(1,tt,3,2,"button",23),o.qc(2,et,3,1,"button",24),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngIf",t.cart.indexOf(t.image._id)<0),o.xb(1),o.cc("ngIf",t.cart.indexOf(t.image._id)>=0)}}function nt(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",28),o.Ob(1,"button",29),o.Vb("click",function(){o.kc(t);const e=o.Yb();return e.downloadImage(e.image)}),o.rc(2," Descargar imagen "),o.Kb(3,"app-feather-icons",26),o.Nb(),o.Nb()}2&t&&(o.xb(3),o.cc("icon","download"))}function rt(t,e){1&t&&(o.Ob(0,"div",30),o.Kb(1,"i",31),o.Nb())}const at=function(t){return{added:t}};function ot(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",32),o.Vb("click",function(){o.kc(t);const e=o.Yb();return e.markAsFavorite(e.image._id,!0)}),o.Kb(1,"app-feather-icons",33),o.Nb()}if(2&t){const t=o.Yb();o.cc("ngClass",o.fc(1,at,t.authService.user.favorites.indexOf(t.image._id)>=0))}}let st=(()=>{class t{constructor(t,e,i,n,r,a,o){this.cartService=t,this.authService=e,this.profileService=i,this.filesService=n,this.router=r,this.imgFiltersService=a,this.paginationService=o,this.image=new K,this.cart=[],this.loading=!1}ngOnInit(){}setDefaultPic(t,e){}addToCart(t){if(!this.loading){if(!this.authService.user)return this.router.navigate(["/login"]),A.a.fire({title:"Debes iniciar sesi\xf3n para agregar im\xe1genes al carrito",icon:"warning"}),this.imgFiltersService.lastSeenImg=this.image,void(this.imgFiltersService.paginationData=this.paginationService.paginationData);this.loading=!0,this.cartService.addToCart(t).subscribe(e=>{this.cartService.cartUpdated.emit(t),this.loading=!1,this.markAsFavorite(t,!1)})}}goToImage(t){this.imgFiltersService.lastSeenImg=t,this.router.navigate(["/producto",t._id])}getUserProfile(t=!1){this.loading=!0,this.profileService.getUserProfile().subscribe(e=>{if(t){const t=JSON.parse(localStorage.getItem("user"));t.favorites=e.user.favorites,this.authService.saveInStorage(t,this.authService.token,this.authService.tokenExpiration),this.loading=!1}})}markAsFavorite(t,e=!0){this.loading=!0;let i=this.authService.user.favorites;const n=i.indexOf(t);n>=0&&e&&i.splice(n,1),n<0&&i.push(t),this.profileService.editProfile({email:this.authService.user.email,favorites:i}).subscribe(t=>{this.loading=!1,this.getUserProfile(!0)})}downloadImage(t){this.loading=!0,this.filesService.downloadImage(t).then(e=>{Object(U.saveAs)(e,t.fileName),this.loading=!1}).catch(t=>console.error("download error = ",t))}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(M.a),o.Jb(v.a),o.Jb(B),o.Jb(H.a),o.Jb(s.f),o.Jb(_.a),o.Jb(x.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-image-card"]],inputs:{image:"image",cart:"cart"},decls:6,vars:5,consts:[[1,"image-card-container"],["class","image-content",3,"id","click",4,"ngIf"],["class","options",4,"ngIf"],["class","options download-image",4,"ngIf"],["class","loading fixed",4,"ngIf"],["class","favorites-btn",3,"ngClass","click",4,"ngIf"],[1,"image-content",3,"id","click"],["class","thumbnail image-not-purchased",3,"ngClass",4,"ngIf"],["class","thumbnail image-owned",3,"ngClass",4,"ngIf"],["class","tag-list mt-2",4,"ngIf"],["class","no-tags",4,"ngIf"],[1,"image-info","mt-3"],[1,"creation-date"],[1,"bold"],[1,"image-info"],[1,"thumbnail","image-not-purchased",3,"ngClass"],[3,"src","error"],[1,"thumbnail","image-owned",3,"ngClass"],[1,"tag-list","mt-2"],["class","badge badge-pill badge-secondary",4,"ngFor","ngForOf"],[1,"badge","badge-pill","badge-secondary"],[1,"no-tags"],[1,"options"],["class","btn btn-secondary mr-2 minify-feather mb-1",3,"disabled","click",4,"ngIf"],["routerLink","/carrito","class","btn btn-success mr-2 minify-feather mb-1",4,"ngIf"],[1,"btn","btn-secondary","mr-2","minify-feather","mb-1",3,"disabled","click"],[3,"icon"],["routerLink","/carrito",1,"btn","btn-success","mr-2","minify-feather","mb-1"],[1,"options","download-image"],[1,"btn","btn-success","mr-2","minify-feather","mb-1",3,"click"],[1,"loading","fixed"],[1,"fa","fa-spinner","fa-spin"],[1,"favorites-btn",3,"ngClass","click"],["icon","star"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.qc(1,Q,16,10,"div",1),o.qc(2,it,3,2,"div",2),o.qc(3,nt,4,1,"div",3),o.qc(4,rt,2,0,"div",4),o.qc(5,ot,2,3,"div",5),o.Nb()),2&t&&(o.xb(1),o.cc("ngIf",e.image),o.xb(1),o.cc("ngIf",!e.authService.user||e.authService.user.purchases.indexOf(e.image._id)<0),o.xb(1),o.cc("ngIf",e.authService.user&&e.authService.user.purchases.indexOf(e.image._id)>=0),o.xb(1),o.cc("ngIf",e.loading),o.xb(1),o.cc("ngIf",e.authService.user&&e.authService.user._id))},directives:[n.m,n.k,n.l,k.a,s.g],pipes:[n.e],styles:[".image-card-container[_ngcontent-%COMP%]{position:relative}.image-content[_ngcontent-%COMP%]   .no-tags[_ngcontent-%COMP%]{min-height:30px;width:100%;display:block}.options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%!important;margin:0!important}.favorites-btn[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px}"]}),t})();function ct(t,e){if(1&t&&(o.Ob(0,"h5"),o.rc(1),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.tc("Listado de imagenes (",t.paginationService.paginationData.total," encontradas)")}}function gt(t,e){if(1&t&&(o.Ob(0,"h5"),o.rc(1),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.tc(" ",t.isInFavorites?"en favoritos":"compradas"," ")}}function lt(t,e){if(1&t){const t=o.Pb();o.Ob(0,"li",53),o.Vb("click",function(){o.kc(t);const i=e.$implicit;return o.Yb(3).photographerSelected(i)}),o.rc(1),o.Nb()}if(2&t){const t=e.$implicit;o.xb(1),o.tc(" ",t.name+" "+(t.lastName?t.lastName:"")," ")}}function bt(t,e){if(1&t&&(o.Ob(0,"div",51),o.Ob(1,"ul"),o.qc(2,lt,2,1,"li",52),o.Nb(),o.Nb()),2&t){const t=o.Yb(2);o.xb(2),o.cc("ngForOf",t.photographers)}}function dt(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",54),o.Ob(1,"button",55),o.Vb("click",function(){return o.kc(t),o.Yb(2).hidePhotographersList()}),o.Kb(2,"i",56),o.Nb(),o.Nb()}}function ut(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",57),o.Ob(1,"div",58),o.Ob(2,"label",59),o.rc(3," Solo imagenes en favoritos "),o.Nb(),o.Ob(4,"label",60),o.Ob(5,"input",61,62),o.Vb("change",function(){o.kc(t);const e=o.ic(6);return o.Yb(2).showOnlyFavorites(e.checked)}),o.Nb(),o.Kb(7,"span",63),o.Nb(),o.Nb(),o.Nb()}if(2&t){const t=o.Yb(2);o.xb(5),o.cc("checked",t.filters.favorites.active)}}function ht(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",64),o.Ob(1,"div",58),o.Ob(2,"label",65),o.rc(3," Solo imagenes compradas "),o.Nb(),o.Ob(4,"label",60),o.Ob(5,"input",66,67),o.Vb("change",function(){o.kc(t);const e=o.ic(6);return o.Yb(2).showOnlyPurchases(e.checked)}),o.Nb(),o.Kb(7,"span",63),o.Nb(),o.Nb(),o.Nb()}if(2&t){const t=o.Yb(2);o.xb(5),o.cc("checked",t.filters.purchases.active)}}function pt(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",27),o.Ob(1,"div",28),o.Ob(2,"div",29),o.Ob(3,"div",30),o.Ob(4,"div",31),o.Ob(5,"label",32),o.rc(6,"Fot\xf3grafo (nombre/alias)"),o.Nb(),o.Ob(7,"input",33),o.Vb("ngModelChange",function(e){return o.kc(t),o.Yb().photographerTerm=e})("keyup",function(e){return o.kc(t),o.Yb().filterPhotographer(e)})("focus",function(e){return o.kc(t),o.Yb().filterPhotographer(e)}),o.Nb(),o.qc(8,bt,3,1,"div",34),o.qc(9,dt,3,0,"div",35),o.Nb(),o.Nb(),o.Ob(10,"div",30),o.Ob(11,"div",36),o.Ob(12,"label",37),o.Kb(13,"app-feather-icons",38),o.rc(14," Desde: "),o.Nb(),o.Ob(15,"dp-date-picker",39),o.Vb("ngModelChange",function(e){return o.kc(t),o.Yb().filters.date.from=e}),o.Nb(),o.Nb(),o.Ob(16,"div",36),o.Ob(17,"label",37),o.Kb(18,"app-feather-icons",38),o.rc(19," Hasta: "),o.Nb(),o.Ob(20,"dp-date-picker",40),o.Vb("ngModelChange",function(e){return o.kc(t),o.Yb().filters.date.to=e}),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(21,"div",41),o.Ob(22,"button",42),o.Vb("click",function(){return o.kc(t),o.Yb().getImages()}),o.Kb(23,"app-feather-icons",43),o.rc(24," Filtrar "),o.Nb(),o.Ob(25,"button",44),o.Vb("click",function(){return o.kc(t),o.Yb().resetFilters()}),o.Kb(26,"app-feather-icons",45),o.Nb(),o.Nb(),o.Nb(),o.Ob(27,"div",46),o.qc(28,ut,8,1,"div",47),o.qc(29,ht,8,1,"div",48),o.Nb(),o.Ob(30,"div",49),o.Kb(31,"app-tags-selector",50),o.Nb(),o.Kb(32,"hr"),o.Nb()}if(2&t){const t=o.Yb();o.xb(7),o.cc("ngModel",t.photographerTerm),o.xb(1),o.cc("ngIf",t.showPhotographersList),o.xb(1),o.cc("ngIf",t.showPhotographersList),o.xb(6),o.cc("ngModel",t.filters.date.from)("config",t.datePickerConfig),o.xb(5),o.cc("ngModel",t.filters.date.to)("config",t.datePickerConfig),o.xb(8),o.cc("ngIf",t.authService.user),o.xb(1),o.cc("ngIf",t.authService.user),o.xb(2),o.cc("isHome",!0)}}function mt(t,e){if(1&t){const t=o.Pb();o.Ob(0,"i",68),o.Vb("click",function(){return o.kc(t),o.Yb().bigImagesActive=!0}),o.Nb()}}function ft(t,e){if(1&t){const t=o.Pb();o.Ob(0,"i",69),o.Vb("click",function(){return o.kc(t),o.Yb().bigImagesActive=!1}),o.Nb()}}function Ot(t,e){if(1&t&&(o.Ob(0,"div",72),o.Kb(1,"app-image-card",73),o.Nb()),2&t){const t=e.$implicit,i=o.Yb(2);o.xb(1),o.cc("cart",i.itemsInCart)("image",t)}}function vt(t,e){if(1&t&&(o.Ob(0,"div",70),o.qc(1,Ot,2,2,"div",71),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngForOf",t.images)}}function xt(t,e){1&t&&(o.Ob(0,"div",74),o.Kb(1,"i",75),o.Nb())}const Pt=function(t){return{"big-images":t}};let Ct=(()=>{class t{constructor(t,e,i,n,r,a,o,s,c,g,l,b){if(this.imagesService=t,this.authService=e,this.router=i,this.tagsService=n,this.cartService=r,this.route=a,this.galleryService=o,this.paginationService=s,this.usersService=c,this.imgFiltersService=g,this.viewScroller=l,this.previousRouteService=b,this.filters=null,this.photographerTerm="",this.photographers=[],this.showPhotographersList=!1,this.isInFavorites=!1,this.isInPurchasedImgs=!1,this.images=[],this.datePickerConfig={locale:"es"},this.itemsInCart=[],this.bigImagesActive=!1,this.loading=!1,this.filters=this.imgFiltersService.filters,this.imgFiltersService.resetFiltersEmitter.subscribe(()=>{this.filters=this.imgFiltersService.filters,this.getImages()}),this.authService.user&&"CLIENT_ROLE"!==this.authService.user.role){if("ADMIN_ROLE"==this.authService.user.role)return void this.router.navigate(["/admin"]);if("CASHIER_ROLE"==this.authService.user.role)return void this.router.navigate(["/caja"]);this.router.navigate(["/imagenes"])}this.route.url.subscribe(t=>{t.length>0&&"favoritos"==t[0].path?(this.filters.favorites.active=!0,this.filters.purchases.active=!1,this.filters.favorites.images=this.authService.user.favorites,this.filters.date={from:null,to:null},this.isInFavorites=!0):t.length>0&&"mis-imagenes"==t[0].path?(this.filters.favorites.active=!1,this.filters.purchases.active=!0,this.filters.purchases.images=this.authService.user.purchases?this.authService.user.purchases:[],this.filters.date={from:null,to:null},this.isInPurchasedImgs=!0):((this.filters.favorites.active||this.filters.purchases.active)&&(this.imgFiltersService.getData(),this.filters=this.imgFiltersService.filters),this.filters.favorites.active=!1,this.filters.purchases.active=!1),this.getImages(!1,!0)}),this.getItemsInCart(),this.cartService.cartUpdated.subscribe(()=>{this.getItemsInCart()}),this.tagsService.tagsSelected.subscribe(t=>{this.filters.tags=t,this.getImages()}),this.paginationService.pageChanged.subscribe(t=>{this.getImages(!0)})}ngOnInit(){}scrollTo(t=!1){if(t&&setTimeout(()=>{this.viewScroller.scrollToPosition([0,400])},1e3),this.imgFiltersService.lastSeenImg){const t="image_"+this.imgFiltersService.lastSeenImg._id;setTimeout(()=>{const e=document.getElementById(t);e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.closest(".image").classList.add("last-seen")),this.imgFiltersService.lastSeenImg=null},1e3)}}getImages(t=!1,e=!1){this.filters.favorites.active||this.filters.purchases.active||(t||(this.paginationService.resetPagination(),this.imgFiltersService.paginationData&&(this.paginationService.paginationData=this.imgFiltersService.paginationData)),null!=this.previousRouteService.getPreviousUrl()&&e&&0==this.previousRouteService.getPreviousUrl().indexOf("Producto")&&(this.paginationService.resetPagination(),this.filters=this.imgFiltersService.resetFilters()),this.imgFiltersService.setData({paginationData:this.paginationService.paginationData,filters:this.filters})),this.loading=!0;const i=this.galleryService.parseFilters(this.filters);this.imagesService.getImagesClient(i).subscribe(e=>{this.loading=!1,this.images=e.images,this.images.forEach(t=>{t.fullpath=t.copyFileName}),this.galleryService.setData(this.images,this.filters),this.scrollTo(t),this.tagsService.gettingFilterTags.emit(e.tags)}),this.authService.refreshUser()}filterPhotographer(t){this.showPhotographersList=!0,this.usersService.getPhotographers(t.target.value).subscribe(t=>{this.photographers=t.photographers})}hidePhotographersList(){this.showPhotographersList=!1,(this.filters.photographer||this.filters.photographer)&&(this.filters.photographer="",this.photographerTerm="",this.getImages())}photographerSelected(t){const e=t.email?t.email:t.username;this.filters.photographer=e,this.photographerTerm=e,this.getImages(),this.showPhotographersList=!1}resetFilters(){this.filters=this.imgFiltersService.resetFilters(),this.galleryService.filters=this.filters,this.getImages()}getItemsInCart(){this.authService.user&&this.authService.user._id&&"CLIENT_ROLE"===this.authService.user.role&&this.cartService.getCart().subscribe(t=>{this.itemsInCart=[],t.cart.products.forEach(t=>{this.itemsInCart.push(t.imageId._id)})})}showOnlyFavorites(t){this.filters.favorites.active=t,this.filters.favorites.images=[],t&&(this.filters.favorites.images=this.authService.user.favorites),this.getImages()}showOnlyPurchases(t){this.filters.purchases.active=t,this.filters.purchases.images=[],t&&(this.filters.purchases.images=this.authService.user.purchases),this.getImages()}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(P),o.Jb(v.a),o.Jb(s.f),o.Jb(C.a),o.Jb(M.a),o.Jb(s.a),o.Jb(N),o.Jb(x.a),o.Jb(y.a),o.Jb(_.a),o.Jb(n.s),o.Jb(I))},t.\u0275cmp=o.Db({type:t,selectors:[["app-home"]],decls:40,vars:12,consts:[[1,"container-fluid","images-list",3,"ngClass"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[4,"ngIf"],[1,"card-body","custom-datatable"],["class","filters-section",4,"ngIf"],[1,"row","orders"],[1,"col-12","col-sm-6"],[1,"order-by"],["for","order_by"],["name","orderBy","id","order_by",1,"form-control",3,"ngModel","ngModelChange","change"],["value","creationDate"],[1,"order-type"],["for","order_type"],["name","orderType","id","order_type",1,"form-control",3,"ngModel","ngModelChange","change"],["value","-1","selected",""],["value","1"],[1,"row","list-type"],[1,"list-type-container","mt-3"],[1,"buttons"],["class","fa fa-list",3,"click",4,"ngIf"],["class","fa fa-image",3,"click",4,"ngIf"],[1,"row","top-pagination","mb-3"],["class","images",4,"ngIf"],["class","loading",4,"ngIf"],[1,"filters-section"],[1,"filters","pb-3","d-flex","justify-content-between","align-items-center"],[1,"row","filters-options","w-75"],[1,"col-12","col-lg-6"],[1,"form-group","filter-fotografo"],["for","filterEmail"],["name","photographerTerm","autocomplete","off","type","text","id","filterEmail","placeholder","Todos los fot\xf3grafos",1,"form-control","mb-0","w-100",3,"ngModel","ngModelChange","keyup","focus"],["class","options",4,"ngIf"],["class","close-list",4,"ngIf"],[1,"picker","w-100","minify-feather","mb-1"],[2,"margin-right","10px"],["icon","calendar"],["name","dateFrom","placeholder","Fecha desde",3,"ngModel","config","ngModelChange"],["name","dateTo","placeholder","Fecha hasta",3,"ngModel","config","ngModelChange"],[1,"filter-btn","mb-3","w-25","text-right","d-flex","align-items-center"],[1,"btn","btn-secondary","w-100","minify-feather",2,"max-width","200px",3,"click"],["icon","search"],[1,"btn","btn-danger","reset-btn",3,"click"],["icon","x"],[1,"filters","d-flex"],["class","filter-switch",4,"ngIf"],["class","filter-switch ml-3",4,"ngIf"],[1,"filter-tags","mt-2"],[3,"isHome"],[1,"options"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"close-list"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-times"],[1,"filter-switch"],[1,"checkbox-group","switch-sm","mt-2"],["for","filterFavorite",1,"checkbox-label"],[1,"switch"],["id","filterFavorite","type","checkbox",3,"checked","change"],["check",""],[1,"switch-state"],[1,"filter-switch","ml-3"],["for","filterPurchases",1,"checkbox-label"],["id","filterPurchases","type","checkbox",3,"checked","change"],["checkPurchase",""],[1,"fa","fa-list",3,"click"],[1,"fa","fa-image",3,"click"],[1,"images"],["class","image",4,"ngFor","ngForOf"],[1,"image"],[3,"cart","image"],[1,"loading"],[1,"fa","fa-spinner","fa-spin"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"div",3),o.Ob(4,"div",4),o.qc(5,ct,2,1,"h5",5),o.qc(6,gt,2,1,"h5",5),o.Nb(),o.Ob(7,"div",6),o.qc(8,pt,33,10,"div",7),o.Ob(9,"div",8),o.Ob(10,"div",9),o.Ob(11,"div",10),o.Ob(12,"label",11),o.rc(13,"Ordenar por"),o.Nb(),o.Ob(14,"select",12),o.Vb("ngModelChange",function(t){return e.filters.order.by=t})("change",function(){return e.getImages()}),o.Ob(15,"option",13),o.rc(16,"Fecha de creaci\xf3n"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(17,"div",9),o.Ob(18,"div",14),o.Ob(19,"label",15),o.rc(20,"Tipo"),o.Nb(),o.Ob(21,"select",16),o.Vb("ngModelChange",function(t){return e.filters.order.order=t})("change",function(){return e.getImages()}),o.Ob(22,"option",17),o.rc(23,"Descendente"),o.Nb(),o.Ob(24,"option",18),o.rc(25,"Ascendente"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(26,"div",19),o.Ob(27,"div",2),o.Ob(28,"div",20),o.Ob(29,"p"),o.rc(30,"Vista"),o.Nb(),o.Ob(31,"div",21),o.qc(32,mt,1,0,"i",22),o.qc(33,ft,1,0,"i",23),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(34,"div",24),o.Ob(35,"div",2),o.Kb(36,"app-pagination"),o.Nb(),o.Nb(),o.qc(37,vt,2,1,"div",25),o.qc(38,xt,2,0,"div",26),o.Kb(39,"app-pagination"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&t&&(o.cc("ngClass",o.fc(10,Pt,e.bigImagesActive)),o.xb(5),o.cc("ngIf",!e.isInFavorites&&!e.isInPurchasedImgs),o.xb(1),o.cc("ngIf",e.isInFavorites||e.isInPurchasedImgs),o.xb(2),o.cc("ngIf",!e.isInFavorites&&!e.isInPurchasedImgs),o.xb(6),o.cc("ngModel",e.filters.order.by),o.xb(7),o.cc("ngModel",e.filters.order.order),o.xb(11),o.cc("ngIf",!e.bigImagesActive),o.xb(1),o.cc("ngIf",e.bigImagesActive),o.xb(4),o.cc("ngIf",!e.loading),o.xb(1),o.cc("ngIf",e.loading))},directives:[n.k,n.m,S.p,S.i,S.k,S.l,S.r,w.a,S.a,k.a,D.a,J,n.l,st],styles:[".images-list[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%]{align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]{display:flex;align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.checkbox-label[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:0;margin-right:15px}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.switch[_ngcontent-%COMP%]{margin:0}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{display:flex!important;justify-content:flex-end}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]   .reset-btn[_ngcontent-%COMP%]{margin-left:8px;padding:5px 5px 0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;margin-top:40px;margin-bottom:10px;margin-right:0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--theme-secondary);margin-bottom:0;margin-right:10px;font-size:16px}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:var(--theme-secondary);border:1px solid var(--theme-secondary);padding:10px;border-radius:3px;cursor:pointer}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:24%;margin-left:1%;padding:10px;border-radius:5px;background:#ecf3fa;box-shadow:1px 1px 3px grey;cursor:pointer;margin-bottom:15px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:hover{transition:all .2s ease;box-shadow:2px 2px 5px grey}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{width:100%;height:190px;overflow:hidden;display:flex;align-items:center;justify-content:center}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#8f9aa5!important}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;margin-top:10px;padding:10px 0}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .whole[_ngcontent-%COMP%]{width:100%;margin-top:10px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px;width:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image.selected[_ngcontent-%COMP%]{background:#ffcc01;box-shadow:2px 2px 5px grey}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{height:unset!important}.image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto!important;height:100%!important;vertical-align:top}.image[_ngcontent-%COMP%]   .image-owned.img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px!important;width:auto!important}@media screen and (max-width:1600px){.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}}@media screen and (max-width:1500px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:32%!important}}@media screen and (max-width:1200px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}}@media screen and (max-width:992px){.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{flex-direction:column}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:15px}}@media screen and (max-width:768px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center}}@media screen and (max-width:400px){.images-list[_ngcontent-%COMP%]   .picker[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px!important}.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.375rem 0!important;width:48%}}",".filter-btn[_ngcontent-%COMP%]{align-items:stretch!important}.filter-btn[_ngcontent-%COMP%]   .reset-btn[_ngcontent-%COMP%]{margin-left:5px}.filter-fotografo[_ngcontent-%COMP%]{position:relative}.filter-fotografo[_ngcontent-%COMP%]   .close-list[_ngcontent-%COMP%]{position:absolute;top:45%;right:0}.filter-fotografo[_ngcontent-%COMP%]   .close-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:36px;width:40px;padding:0;font-size:18px}.filter-fotografo[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:absolute;background:#fff;width:100%;z-index:999;box-shadow:1px 1px 3px #000;max-height:40vh;overflow-y:scroll}.filter-fotografo[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{cursor:pointer;padding:5px;border-bottom:1px solid var(--theme-secondary)}.filter-fotografo[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{transition:all .3s ease;background:var(--theme-secondary);color:#fff}"]}),t})();var Mt=i("Tj/N"),Nt=i("JuEE");let yt=(()=>{class t{constructor(t,e){this.profileService=t,this.authService=e,this.user=new Mt.a,this.getUserProfile()}ngOnInit(){}getUserProfile(t=!1){this.profileService.getUserProfile().subscribe(e=>{if(this.user=e.user,t){const t=JSON.parse(localStorage.getItem("user"));t.name=e.user.name,t.email=e.user.email,this.authService.saveInStorage(t,this.authService.token,this.authService.tokenExpiration)}})}editProfile(){this.user.password&&this.user.password.length<8?A.a.fire("Error","La contrase\xf1a debe ser de minimo 8 caracteres","error"):this.user.password&&this.user.password!==this.repassword?A.a.fire("Error","Las contrase\xf1as no coinciden","error"):this.profileService.editProfile(this.user).subscribe(t=>{Object(p.c)(t),this.getUserProfile(!0),this.repassword=null},t=>{console.log(t),t.error&&Object(p.c)(t.error)})}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(B),o.Jb(v.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-my-profile"]],decls:43,vars:9,consts:[[1,"container-fluid","users"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-header","d-flex","justify-content-between"],[1,"card-body"],[1,"form-group","row"],["for","inputRole",1,"col-12","col-sm-3","col-form-label"],[1,"col-12","col-sm-9"],["id","inputRole","type","text","disabled","",1,"form-control",3,"value"],["for","inputEmail",1,"col-12","col-sm-3","col-form-label"],["name","email","id","inputEmail","type","email","placeholder","Email",1,"form-control",3,"ngModel","ngModelChange"],["for","inputAlias",1,"col-12","col-sm-3","col-form-label"],["id","inputAlias","type","text","disabled","","placeholder","Alias",1,"form-control",3,"value"],["for","inputName",1,"col-12","col-sm-3","col-form-label"],["name","name","id","inputName","type","text","placeholder","Nombre",1,"form-control",3,"ngModel","ngModelChange"],["for","inputPassword",1,"col-12","col-sm-3","col-form-label"],["name","password","id","inputPassword","type","password","placeholder","Contrase\xf1a",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","row","mb-3"],["for","inputRePassword",1,"col-12","col-sm-3","col-form-label"],["name","repassword","id","inputRePassword","type","password","placeholder","Repetir contrase\xf1a",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","mt-4","d-flex","justify-content-center"],[1,"btn","btn-primary","w-100","mt-4",2,"max-width","800px",3,"click"],[3,"icon"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"div",3),o.Ob(4,"div",4),o.Ob(5,"h5"),o.rc(6,"Mis datos"),o.Nb(),o.Nb(),o.Ob(7,"div",5),o.Ob(8,"div",6),o.Ob(9,"label",7),o.rc(10,"Rol"),o.Nb(),o.Ob(11,"div",8),o.Kb(12,"input",9),o.Zb(13,"role"),o.Nb(),o.Nb(),o.Ob(14,"div",6),o.Ob(15,"label",10),o.rc(16,"Email"),o.Nb(),o.Ob(17,"div",8),o.Ob(18,"input",11),o.Vb("ngModelChange",function(t){return e.user.email=t}),o.Nb(),o.Nb(),o.Nb(),o.Ob(19,"div",6),o.Ob(20,"label",12),o.rc(21,"Alias"),o.Nb(),o.Ob(22,"div",8),o.Kb(23,"input",13),o.Nb(),o.Nb(),o.Ob(24,"div",6),o.Ob(25,"label",14),o.rc(26,"Nombre"),o.Nb(),o.Ob(27,"div",8),o.Ob(28,"input",15),o.Vb("ngModelChange",function(t){return e.user.name=t}),o.Nb(),o.Nb(),o.Nb(),o.Ob(29,"div",6),o.Ob(30,"label",16),o.rc(31,"Contrase\xf1a"),o.Nb(),o.Ob(32,"div",8),o.Ob(33,"input",17),o.Vb("ngModelChange",function(t){return e.user.password=t}),o.Nb(),o.Nb(),o.Nb(),o.Ob(34,"div",18),o.Ob(35,"label",19),o.rc(36,"Repetir contrase\xf1a"),o.Nb(),o.Ob(37,"div",8),o.Ob(38,"input",20),o.Vb("ngModelChange",function(t){return e.repassword=t}),o.Nb(),o.Nb(),o.Nb(),o.Ob(39,"div",21),o.Ob(40,"button",22),o.Vb("click",function(){return e.editProfile()}),o.Kb(41,"app-feather-icons",23),o.rc(42," Guardar mis datos "),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&t&&(o.xb(12),o.cc("value",o.ac(13,7,e.user.role)),o.xb(6),o.cc("ngModel",e.user.email),o.xb(5),o.cc("value",e.user.username),o.xb(5),o.cc("ngModel",e.user.name),o.xb(5),o.cc("ngModel",e.user.password),o.xb(5),o.cc("ngModel",e.repassword),o.xb(3),o.cc("icon","save"))},directives:[S.a,S.i,S.k,k.a],pipes:[Nt.a],styles:[""]}),t})();function _t(t,e){1&t&&o.Kb(0,"div",11)}let It=(()=>{class t{constructor(t,e){this.imagesService=t,this.tagsService=e,this.images=[],this.imagesSelected=[],this.loadingTags=!1,this.creationDate=null,this.tags=[],this.datePickerConfig={locale:"es"},this.tagsService.tagsSelected.subscribe(t=>{this.tags=t})}ngOnInit(){}getImagesToEdit(){let t=[];for(let e=0;e<this.images.length;e++)this.imagesSelected.indexOf(this.images[e]._id)>=0&&t.push(this.images[e]);return t}editImages(t=null,e=0){t||(t=this.getImagesToEdit());const i=this.imagesService.editImageTags({imageId:t[e]._id,creationDate:this.creationDate,tags:this.tags}).subscribe(n=>{if(i.unsubscribe(),++e==t.length)return A.a.fire("Correcto","Imagenes modificadas correctamente","success"),this.imagesService.imagesEdited.emit("edited"),this.tagsService.resetTags.emit("reset"),void(this.tags=[]);this.editImages(t,e)},t=>Object(p.c)(t.error))}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(P),o.Jb(C.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-edit-images"]],inputs:{images:"images",imagesSelected:"imagesSelected"},decls:20,vars:3,consts:[[1,"modal-body"],[1,"creation-date"],[1,"picker","mt-4","w-100"],[2,"margin-right","10px"],["name","creationDate","placeholder","Fecha de creaci\xf3n",3,"ngModel","config","ngModelChange"],[1,"tags-management"],[1,"tags"],["class","loading",4,"ngIf"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary",3,"click"],[1,"loading"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"h4"),o.rc(3,"Fecha de creaci\xf3n de la imagen (Por defecto dato del EXIF)"),o.Nb(),o.Ob(4,"div",2),o.Ob(5,"label",3),o.rc(6,"Fecha de creaci\xf3n:"),o.Nb(),o.Ob(7,"dp-date-picker",4),o.Vb("ngModelChange",function(t){return e.creationDate=t}),o.Nb(),o.Nb(),o.Kb(8,"hr"),o.Nb(),o.Ob(9,"div",5),o.Ob(10,"h4"),o.rc(11,"Modificar tags a las imagenes seleccionadas"),o.Nb(),o.Ob(12,"div",6),o.Kb(13,"app-tags-selector"),o.qc(14,_t,1,0,"div",7),o.Nb(),o.Nb(),o.Nb(),o.Ob(15,"div",8),o.Ob(16,"button",9),o.rc(17,"Cerrar"),o.Nb(),o.Ob(18,"button",10),o.Vb("click",function(){return e.editImages()}),o.rc(19," Guardar cambios "),o.Nb(),o.Nb()),2&t&&(o.xb(7),o.cc("ngModel",e.creationDate)("config",e.datePickerConfig),o.xb(7),o.cc("ngIf",e.loadingTags))},directives:[D.a,S.i,S.k,J,n.m],styles:[""]}),t})();function St(t,e){if(1&t){const t=o.Pb();o.Ob(0,"li",64),o.Vb("click",function(){o.kc(t);const i=e.$implicit;return o.Yb(3).photographerSelected(i)}),o.rc(1),o.Nb()}if(2&t){const t=e.$implicit;o.xb(1),o.tc(" ",t.name+" "+(t.lastName?t.lastName:"")," ")}}function wt(t,e){if(1&t&&(o.Ob(0,"div",62),o.Ob(1,"ul"),o.qc(2,St,2,1,"li",63),o.Nb(),o.Nb()),2&t){const t=o.Yb(2);o.xb(2),o.cc("ngForOf",t.photographers)}}function kt(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",65),o.Ob(1,"button",66),o.Vb("click",function(){return o.kc(t),o.Yb(2).hidePhotographersList()}),o.Kb(2,"i",67),o.Nb(),o.Nb()}}function Dt(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",57),o.Ob(1,"label",58),o.rc(2,"Fotografo"),o.Nb(),o.Ob(3,"input",59),o.Vb("ngModelChange",function(e){return o.kc(t),o.Yb().photographerTerm=e})("keyup",function(e){return o.kc(t),o.Yb().filterPhotographer(e)})("focus",function(e){return o.kc(t),o.Yb().filterPhotographer(e)}),o.Nb(),o.qc(4,wt,3,1,"div",60),o.qc(5,kt,3,0,"div",61),o.Nb()}if(2&t){const t=o.Yb();o.xb(3),o.cc("ngModel",t.photographerTerm),o.xb(1),o.cc("ngIf",t.showPhotographersList),o.xb(1),o.cc("ngIf",t.showPhotographersList)}}function Ft(t,e){if(1&t){const t=o.Pb();o.Ob(0,"i",68),o.Vb("click",function(){return o.kc(t),o.Yb().bigImagesActive=!0}),o.Nb()}}function Tt(t,e){if(1&t){const t=o.Pb();o.Ob(0,"i",69),o.Vb("click",function(){return o.kc(t),o.Yb().bigImagesActive=!1}),o.Nb()}}function At(t,e){if(1&t&&(o.Ob(0,"span",84),o.rc(1),o.Nb()),2&t){const t=e.$implicit;o.xb(1),o.tc(" ",t," ")}}function Et(t,e){if(1&t&&(o.Ob(0,"div",82),o.qc(1,At,2,1,"span",83),o.Nb()),2&t){const t=o.Yb().$implicit;o.xb(1),o.cc("ngForOf",t.tags)}}function qt(t,e){if(1&t){const t=o.Pb();o.Ob(0,"button",85),o.Vb("click",function(){o.kc(t);const e=o.Yb().$implicit;return o.Yb(2).askToDelete(e)}),o.Kb(1,"app-feather-icons",79),o.rc(2," Eliminar "),o.Nb()}2&t&&(o.xb(1),o.cc("icon","trash-2"))}const Yt=function(t){return{whole:t}};function Rt(t,e){if(1&t){const t=o.Pb();o.Ob(0,"button",86),o.Vb("click",function(){o.kc(t);const e=o.Yb().$implicit;return o.Yb(2).askToRestore(e)}),o.Kb(1,"app-feather-icons",79),o.rc(2," Restaurar "),o.Nb()}if(2&t){const t=o.Yb(3);o.cc("ngClass",o.fc(2,Yt,"ADMIN_ROLE"==t.authService.user.role)),o.xb(1),o.cc("icon","refresh-cw")}}const jt=function(t){return{selected:t}},Lt=function(t){return{"img-vertical":t}};function Vt(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",72),o.Ob(1,"div",73),o.Vb("click",function(){o.kc(t);const i=e.$implicit;return o.Yb(2).goToImage(i)}),o.Ob(2,"img",74),o.Vb("error",function(i){o.kc(t);const n=e.$implicit;return o.Yb(2).setDefaultPic(i,n)}),o.Nb(),o.Nb(),o.qc(3,Et,2,1,"div",75),o.Ob(4,"div",76),o.Ob(5,"div",77),o.Ob(6,"span",78),o.rc(7,"Fecha creaci\xf3n:"),o.Nb(),o.rc(8),o.Zb(9,"date"),o.Nb(),o.Ob(10,"div",77),o.Ob(11,"span",78),o.rc(12,"Fecha subida:"),o.Nb(),o.rc(13),o.Zb(14,"date"),o.Nb(),o.Ob(15,"div",77),o.Ob(16,"span",78),o.rc(17,"Fot\xf3grafo:"),o.Nb(),o.rc(18),o.Nb(),o.Nb(),o.Ob(19,"div",62),o.Ob(20,"button",6),o.Vb("click",function(){o.kc(t);const i=e.$implicit;return o.Yb(2).selectImage(i._id)}),o.Kb(21,"app-feather-icons",79),o.rc(22," Seleccionar "),o.Nb(),o.qc(23,qt,3,1,"button",80),o.qc(24,Rt,3,4,"button",81),o.Nb(),o.Nb()}if(2&t){const t=e.$implicit,i=o.Yb(2);o.cc("ngClass",o.fc(17,jt,i.imagesSelected.indexOf(t._id)>=0)),o.xb(1),o.cc("id","image_"+t._id)("ngClass",o.fc(19,Lt,t.exifData&&t.exifData.Orientation>=5)),o.xb(1),o.cc("src",t.fullpath,o.mc),o.xb(1),o.cc("ngIf",t.tags.length>0),o.xb(5),o.tc(" ",o.bc(9,11,t.creationDate,"dd/MM/yyyy HH:mm:ss")," "),o.xb(5),o.tc(" ",o.bc(14,14,t.uploadDate,"dd/MM/yyyy HH:mm:ss")," "),o.xb(5),o.tc(" ",t.photographerData.name+" "+(t.photographerData.lastName?t.photographerData.lastName:"")," "),o.xb(3),o.cc("icon","check-circle"),o.xb(2),o.cc("ngIf","visible"==t.status||"ADMIN_ROLE"==i.authService.user.role),o.xb(1),o.cc("ngIf","deleted"==t.status)}}function Jt(t,e){if(1&t&&(o.Ob(0,"div",70),o.qc(1,Vt,25,21,"div",71),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngForOf",t.images)}}function Kt(t,e){1&t&&(o.Ob(0,"div",87),o.Kb(1,"i",88),o.Nb())}function Ut(t,e){if(1&t&&(o.Ob(0,"div",89),o.Ob(1,"span",90),o.rc(2),o.Nb(),o.rc(3),o.Nb()),2&t){const t=o.Yb();o.xb(2),o.sc(t.imagesSelected.length),o.xb(1),o.uc(" ",t.imagesSelected.length>1?"Imagenes":"Imagen"," ",t.imagesSelected.length>1?"seleccionadas":"seleccionada",". Click para editar\n")}}const Bt=function(t){return{"big-images":t}};let Ht=(()=>{class t{constructor(t,e,i,n,r,a,o,s){this.imagesService=t,this.authService=e,this.galleryService=i,this.paginationService=n,this.usersService=r,this.imgFiltersService=a,this.router=o,this.viewScroller=s,this.filters=null,this.photographerTerm="",this.photographers=[],this.showPhotographersList=!1,this.imagesSelected=[],this.images=[],this.datePickerConfig={locale:"es"},this.loading=!1,this.bigImagesActive=!1,this.authService.user?(this.filters=this.imgFiltersService.adminFilters,this.imgFiltersService.resetFiltersEmitter.subscribe(()=>{this.filters=this.imgFiltersService.adminFilters,this.getImages()}),this.getImages(),this.imagesService.imagesEdited.subscribe(()=>{this.getImages(!0)}),this.paginationService.pageChanged.subscribe(t=>{this.getImages(!0)})):this.router.navigate(["/"])}ngOnInit(){}scrollTo(t=!1){if(t&&setTimeout(()=>{this.viewScroller.scrollToPosition([0,400])},1e3),this.imgFiltersService.lastSeenImg){const t="image_"+this.imgFiltersService.lastSeenImg._id;setTimeout(()=>{const e=document.getElementById(t);e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.closest(".image").classList.add("last-seen")),this.imgFiltersService.lastSeenImg=null},1e3)}}setDefaultPic(t,e){}getImages(t=!1){t||(this.paginationService.resetPagination(),this.imgFiltersService.paginationData&&(this.paginationService.paginationData=this.imgFiltersService.paginationData)),this.imgFiltersService.setData({paginationData:this.paginationService.paginationData,adminFilters:this.filters}),this.paginationService.paginationData.perPage=99,this.loading=!0;const e=this.galleryService.parseFilters(this.filters);this.imagesService.getImages(e).subscribe(e=>{this.images=e.images,this.images.forEach(t=>{t.fullpath=t.copyFileName}),this.galleryService.setData(this.images,this.filters),this.loading=!1,this.scrollTo(t)})}goToImage(t){this.imgFiltersService.lastSeenImg=t,this.router.navigate(["/producto",t._id])}filterPhotographer(t){this.showPhotographersList=!0,this.usersService.getPhotographers(t.target.value).subscribe(t=>{this.photographers=t.photographers})}hidePhotographersList(){this.showPhotographersList=!1,(this.filters.photographer||this.filters.photographer)&&(this.filters.photographer="",this.photographerTerm="",this.getImages())}photographerSelected(t){const e=t.email?t.email:t.username;this.filters.photographer=e,this.photographerTerm=e,this.getImages(),this.showPhotographersList=!1}resetFilters(){this.filters=this.imgFiltersService.resetFilters(!0),this.galleryService.filters=this.filters,this.getImages()}showRecycledChanged(t){this.filters.showRecycled=t,this.getImages()}selectImage(t){if(this.imagesSelected.indexOf(t)>=0){const e=this.imagesSelected.indexOf(t);this.imagesSelected.splice(e,1)}else this.imagesSelected.push(t)}selectAllImages(){this.imagesSelected.length!=this.images.length?(this.imagesSelected=[],this.images.forEach((t,e)=>{this.selectImage(t._id)})):this.imagesSelected=[]}deleteImage(t){this.imagesService.deleteImage(t).subscribe(t=>{Object(p.c)(t),this.getImages()},t=>Object(p.c)(t))}restoreImage(t){this.imagesService.restoreImage(t).subscribe(t=>{Object(p.c)(t),this.getImages()},t=>Object(p.c)(t))}recycleImage(t){this.imagesService.recycleImage(t).subscribe(t=>{Object(p.c)(t),this.getImages()},t=>Object(p.c)(t))}askToDelete(t){A.a.fire({title:"\xbfEst\xe1s seguro?",text:"Haz seleccionado esta imagen para su eliminaci\xf3n, \xbfDeseas continuar?",icon:"question",showCancelButton:!0,confirmButtonText:"Eliminar",confirmButtonColor:"#dc3545",cancelButtonText:"Cancelar",cancelButtonColor:"#cdcdcd"}).then(e=>{e.isConfirmed&&A.a.fire({title:"Confirma nuevamente",text:"Estas a punto de eliminar esta im\xe1gen, \xbfDeseas continuar?",icon:"warning",showCancelButton:!0,confirmButtonText:"Eliminar",confirmButtonColor:"#dc3545",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&("ADMIN_ROLE"==this.authService.user.role?this.deleteImage(t):this.recycleImage(t))})})}askToRestore(t){A.a.fire({title:"\xbfEst\xe1s seguro?",text:"Estas a punto de restaurar esta im\xe1gen, \xbfDeseas continuar?",icon:"question",showCancelButton:!0,confirmButtonText:"Restaurar",confirmButtonColor:"#51bb25",cancelButtonText:"Cancelar",cancelButtonColor:"#cdcdcd"}).then(e=>{e.isConfirmed&&this.restoreImage(t)})}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(P),o.Jb(v.a),o.Jb(N),o.Jb(x.a),o.Jb(y.a),o.Jb(_.a),o.Jb(s.f),o.Jb(n.s))},t.\u0275cmp=o.Db({type:t,selectors:[["app-images-management"]],decls:83,vars:19,consts:[[1,"container-fluid","images-list",3,"ngClass"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"select-all-btn"],[1,"btn","btn-secondary","mr-2","minify-feather",3,"click"],[1,"mr-2",3,"icon"],[1,"card-body","custom-datatable"],[1,"filters","pb-3","d-flex","justify-content-between","align-items-center"],[1,"row","filters-options","w-75"],[1,"col-12","col-lg-6"],["class","form-group filter-fotografo",4,"ngIf"],[1,"checkbox-group","switch-sm"],["for","filterRecycled",1,"checkbox-label"],[1,"switch"],["id","filterRecycled","type","checkbox",3,"change"],["check",""],[1,"switch-state"],[1,"picker","w-100"],[2,"margin-right","10px"],["name","dateFrom","placeholder","Fecha desde",3,"ngModel","config","ngModelChange"],["name","dateTo","placeholder","Fecha hasta",3,"ngModel","config","ngModelChange"],[1,"filter-btn","mb-3","w-25","text-right","d-flex","align-items-center"],[1,"btn","btn-secondary","w-100","minify-feather",2,"max-width","200px",3,"click"],["icon","search"],[1,"btn","btn-danger","reset-btn",3,"click"],["icon","x"],[1,"row","orders"],[1,"col-12","col-sm-6"],[1,"order-by"],["for","order_by"],["name","orderBy","id","order_by",1,"form-control",3,"ngModel","ngModelChange","change"],["value","creationDate"],["value","uploadDate"],[1,"order-type"],["for","order_type"],["name","orderType","id","order_type",1,"form-control",3,"ngModel","ngModelChange","change"],["value","-1","selected",""],["value","1"],[1,"row","list-type"],[1,"list-type-container","mt-3"],[1,"buttons"],["class","fa fa-list",3,"click",4,"ngIf"],["class","fa fa-image",3,"click",4,"ngIf"],[1,"row","top-pagination","mb-3"],["class","images",4,"ngIf"],["class","loading",4,"ngIf"],["class","images-selected-edit","data-toggle","modal","data-target","#editImageModal",4,"ngIf"],["id","editImageModal","tabindex","-1","aria-labelledby","editImageModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","editImageModalLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[3,"images","imagesSelected"],[1,"form-group","filter-fotografo"],["for","filterEmail"],["name","photographerTerm","autocomplete","off","type","text","id","filterEmail","placeholder","Todos los fot\xf3grafos",1,"form-control","mb-0","w-100",3,"ngModel","ngModelChange","keyup","focus"],["class","options",4,"ngIf"],["class","close-list",4,"ngIf"],[1,"options"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"close-list"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-times"],[1,"fa","fa-list",3,"click"],[1,"fa","fa-image",3,"click"],[1,"images"],["class","image",3,"ngClass",4,"ngFor","ngForOf"],[1,"image",3,"ngClass"],[1,"thumbnail","image-owned",3,"id","ngClass","click"],[3,"src","error"],["class","tag-list mt-2",4,"ngIf"],[1,"image-info","mt-3"],[1,"creation-date"],[1,"bold"],[3,"icon"],["class","btn btn-danger minify-feather",3,"click",4,"ngIf"],["class","btn btn-success minify-feather mb-1",3,"ngClass","click",4,"ngIf"],[1,"tag-list","mt-2"],["class","badge badge-pill badge-secondary",4,"ngFor","ngForOf"],[1,"badge","badge-pill","badge-secondary"],[1,"btn","btn-danger","minify-feather",3,"click"],[1,"btn","btn-success","minify-feather","mb-1",3,"ngClass","click"],[1,"loading"],[1,"fa","fa-spinner","fa-spin"],["data-toggle","modal","data-target","#editImageModal",1,"images-selected-edit"],[1,"number"]],template:function(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"div",3),o.Ob(4,"div",4),o.Ob(5,"h5"),o.rc(6),o.Nb(),o.Ob(7,"div",5),o.Ob(8,"button",6),o.Vb("click",function(){return e.selectAllImages()}),o.Kb(9,"app-feather-icons",7),o.rc(10," Seleccionar toda la p\xe1gina "),o.Nb(),o.Nb(),o.Nb(),o.Ob(11,"div",8),o.Ob(12,"div",9),o.Ob(13,"div",10),o.Ob(14,"div",11),o.qc(15,Dt,6,3,"div",12),o.Ob(16,"div",13),o.Ob(17,"label",14),o.rc(18," Solo imagenes en papelera "),o.Nb(),o.Ob(19,"label",15),o.Ob(20,"input",16,17),o.Vb("change",function(){o.kc(t);const i=o.ic(21);return e.showRecycledChanged(i.checked)}),o.Nb(),o.Kb(22,"span",18),o.Nb(),o.Nb(),o.Nb(),o.Ob(23,"div",11),o.Ob(24,"div",19),o.Ob(25,"label",20),o.rc(26,"Desde:"),o.Nb(),o.Ob(27,"dp-date-picker",21),o.Vb("ngModelChange",function(t){return e.filters.date.from=t}),o.Nb(),o.Nb(),o.Ob(28,"div",19),o.Ob(29,"label",20),o.rc(30,"Hasta:"),o.Nb(),o.Ob(31,"dp-date-picker",22),o.Vb("ngModelChange",function(t){return e.filters.date.to=t}),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(32,"div",23),o.Ob(33,"button",24),o.Vb("click",function(){return e.getImages()}),o.Kb(34,"app-feather-icons",25),o.rc(35," Filtrar "),o.Nb(),o.Ob(36,"button",26),o.Vb("click",function(){return e.resetFilters()}),o.Kb(37,"app-feather-icons",27),o.Nb(),o.Nb(),o.Nb(),o.Kb(38,"hr"),o.Ob(39,"div",28),o.Ob(40,"div",29),o.Ob(41,"div",30),o.Ob(42,"label",31),o.rc(43,"Ordenar por"),o.Nb(),o.Ob(44,"select",32),o.Vb("ngModelChange",function(t){return e.filters.order.by=t})("change",function(){return e.getImages()}),o.Ob(45,"option",33),o.rc(46,"Fecha de creaci\xf3n"),o.Nb(),o.Ob(47,"option",34),o.rc(48,"Fecha de subida"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(49,"div",29),o.Ob(50,"div",35),o.Ob(51,"label",36),o.rc(52,"Tipo"),o.Nb(),o.Ob(53,"select",37),o.Vb("ngModelChange",function(t){return e.filters.order.order=t})("change",function(){return e.getImages()}),o.Ob(54,"option",38),o.rc(55,"Descendente"),o.Nb(),o.Ob(56,"option",39),o.rc(57,"Ascendente"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(58,"div",40),o.Ob(59,"div",2),o.Ob(60,"div",41),o.Ob(61,"p"),o.rc(62,"Vista"),o.Nb(),o.Ob(63,"div",42),o.qc(64,Ft,1,0,"i",43),o.qc(65,Tt,1,0,"i",44),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(66,"div",45),o.Ob(67,"div",2),o.Kb(68,"app-pagination"),o.Nb(),o.Nb(),o.qc(69,Jt,2,1,"div",46),o.qc(70,Kt,2,0,"div",47),o.Kb(71,"app-pagination"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.qc(72,Ut,4,3,"div",48),o.Ob(73,"div",49),o.Ob(74,"div",50),o.Ob(75,"div",51),o.Ob(76,"div",52),o.Ob(77,"h5",53),o.rc(78,"Modificar tags"),o.Nb(),o.Ob(79,"button",54),o.Ob(80,"span",55),o.rc(81,"\xd7"),o.Nb(),o.Nb(),o.Nb(),o.Kb(82,"app-edit-images",56),o.Nb(),o.Nb(),o.Nb()}2&t&&(o.cc("ngClass",o.fc(17,Bt,e.bigImagesActive)),o.xb(6),o.tc("Imagenes (",e.paginationService.paginationData.total,")"),o.xb(3),o.cc("icon","check-circle"),o.xb(6),o.cc("ngIf","ADMIN_ROLE"==e.authService.user.role),o.xb(12),o.cc("ngModel",e.filters.date.from)("config",e.datePickerConfig),o.xb(4),o.cc("ngModel",e.filters.date.to)("config",e.datePickerConfig),o.xb(13),o.cc("ngModel",e.filters.order.by),o.xb(9),o.cc("ngModel",e.filters.order.order),o.xb(11),o.cc("ngIf",!e.bigImagesActive),o.xb(1),o.cc("ngIf",e.bigImagesActive),o.xb(4),o.cc("ngIf",!e.loading),o.xb(1),o.cc("ngIf",e.loading),o.xb(2),o.cc("ngIf",e.imagesSelected.length>0),o.xb(10),o.cc("images",e.images)("imagesSelected",e.imagesSelected))},directives:[n.k,k.a,n.m,D.a,S.i,S.k,S.p,S.l,S.r,w.a,It,S.a,n.l],pipes:[n.e],styles:[".images-list[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%]{align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]{display:flex;align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.checkbox-label[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:0;margin-right:15px}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.switch[_ngcontent-%COMP%]{margin:0}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{display:flex!important;justify-content:flex-end}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]   .reset-btn[_ngcontent-%COMP%]{margin-left:8px;padding:5px 5px 0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;margin-top:40px;margin-bottom:10px;margin-right:0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--theme-secondary);margin-bottom:0;margin-right:10px;font-size:16px}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:var(--theme-secondary);border:1px solid var(--theme-secondary);padding:10px;border-radius:3px;cursor:pointer}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:24%;margin-left:1%;padding:10px;border-radius:5px;background:#ecf3fa;box-shadow:1px 1px 3px grey;cursor:pointer;margin-bottom:15px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:hover{transition:all .2s ease;box-shadow:2px 2px 5px grey}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{width:100%;height:190px;overflow:hidden;display:flex;align-items:center;justify-content:center}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#8f9aa5!important}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;margin-top:10px;padding:10px 0}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .whole[_ngcontent-%COMP%]{width:100%;margin-top:10px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px;width:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image.selected[_ngcontent-%COMP%]{background:#ffcc01;box-shadow:2px 2px 5px grey}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{height:unset!important}.image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto!important;height:100%!important;vertical-align:top}.image[_ngcontent-%COMP%]   .image-owned.img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px!important;width:auto!important}@media screen and (max-width:1600px){.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}}@media screen and (max-width:1500px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:32%!important}}@media screen and (max-width:1200px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}}@media screen and (max-width:992px){.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{flex-direction:column}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:15px}}@media screen and (max-width:768px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center}}@media screen and (max-width:400px){.images-list[_ngcontent-%COMP%]   .picker[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px!important}.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.375rem 0!important;width:48%}}",".images-selected-edit[_ngcontent-%COMP%]{position:fixed;bottom:10px;right:10px;background-color:orange;color:#fff;padding:10px 20px;border-radius:5px;font-size:16px;cursor:pointer;border:2px solid orange;z-index:999}.images-selected-edit[_ngcontent-%COMP%]:hover{transition:all .2s ease;background:#fff;color:orange}.images-selected-edit[_ngcontent-%COMP%]   span.number[_ngcontent-%COMP%]{padding:1px 6px;background:green;border-radius:50%;background-color:orange;color:#fff!important}.filter-fotografo[_ngcontent-%COMP%]{position:relative}.filter-fotografo[_ngcontent-%COMP%]   .close-list[_ngcontent-%COMP%]{position:absolute;top:45%;right:0}.filter-fotografo[_ngcontent-%COMP%]   .close-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:36px;width:40px;padding:0;font-size:18px}.filter-fotografo[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:absolute;background:#fff;width:100%;z-index:999;box-shadow:1px 1px 3px #000;max-height:40vh;overflow-y:scroll}.filter-fotografo[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{cursor:pointer;padding:5px;border-bottom:1px solid var(--theme-secondary)}.filter-fotografo[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{transition:all .3s ease;background:var(--theme-secondary);color:#fff}@media screen and (max-width:768px){.modal-dialog[_ngcontent-%COMP%]{margin:10vh 0 0!important}}"]}),t})();var $t=i("mrSG"),Gt=i("b0Xh");function zt(t,e){if(1&t&&(o.Ob(0,"div",7),o.Ob(1,"div",8),o.Ob(2,"p"),o.rc(3),o.Nb(),o.Nb(),o.Nb()),2&t){const t=o.Yb();o.xb(3),o.uc("",t.filesService.uploadIndex," / ",t.files.length,' fotos cargadas. Click en "Subir im\xe1genes" para comenzar la carga')}}function Zt(t,e){1&t&&(o.Ob(0,"div",9),o.Kb(1,"i",10),o.Nb())}let Xt=(()=>{class t{constructor(t){this.filesService=t,this.files=[],this.filesDroppedElem=null,this.loading=!1,this.filesService.filesUploaded.subscribe(t=>{"uploaded"==t&&(this.files=[],this.filesDroppedElem.value="")})}ngOnInit(){}getExifData(t){return new Promise((e,i)=>{const n=new Image;n.onload=()=>{const t={width:n.width,height:n.height};Gt.getData(n,function(){let i=Gt.getAllTags(this);i=Object.assign(Object.assign({},i),{Dimensions:t}),e(i)})},n.onerror=()=>{i(new Error("Failed to load the image."))},n.src=URL.createObjectURL(t)})}filesDropped(t,e){this.filesDroppedElem=e,this.loading=!0;let i=[];const n=this.files.length;for(let r=0;r<t.length;r++)t[r].type.indexOf("image")>=0?this.getExifData(t[r]).then(e=>{if(!e)return i.push({fileName:t[r].name,error:"No se han podido obtener los datos exif"}),this.displayErrors(i),void(this.loading=!1);e={DateTime:e.DateTime?e.DateTime:null,Orientation:e.Orientation?JSON.stringify(e.Orientation):null,Copyright:e.Copyright?JSON.stringify(e.Copyright):null,ExposureTime:e.ExposureTime?JSON.stringify(e.ExposureTime):null,FNumber:e.FNumber?JSON.stringify(e.FNumber):null,Dimensions:e.Dimensions?e.Dimensions:null,ISOSpeedRatings:e.ISOSpeedRatings?JSON.stringify(e.ISOSpeedRatings):null},this.filesService.imagesData[t[r].name]={fileName:t[r].name,format:t[r].type,index:r,progress:{current:0,total:0,percentage:0},exifData:e},this.files.push(t[r]),this.emitFiles(),this.files.length==n+t.length&&(this.loading=!1)}):i.push({fileName:t[r].name,error:`La extensi\xf3n .${Object(p.b)(t[r].name)} no es v\xe1lida`});this.displayErrors(i)}displayErrors(t){if(t.length>0){let e="";t.forEach(t=>{e+=`${t.fileName}: ${t.error}. \n\r`}),A.a.fire("Error",e,"error")}}removeFile(t){this.files.splice(t,1),this.emitFiles()}emitFiles(){this.filesService.filesUpdated.emit(this.files)}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(H.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-upload-images"]],decls:17,vars:2,consts:[[1,"dropzone","dropzone-primary"],[1,"dz-message","needsclick"],[1,"icon-cloud-up"],["enctype","multipart/form-data","accept","image/*","type","file","id","fileDropRef","multiple","",3,"change"],["fileDropRef",""],["class","files-list mt-1",4,"ngIf"],["class","loading-bar",4,"ngIf"],[1,"files-list","mt-1"],[1,"row","upload-status"],[1,"loading-bar"],[1,"fa","fa-spinner","fa-spin"]],template:function(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",0),o.Ob(1,"div",1),o.Kb(2,"i",2),o.Ob(3,"h6"),o.rc(4,"Arrastra las im\xe1genes aqu\xed o hac\xe9 click para seleccionarlas."),o.Nb(),o.Ob(5,"span"),o.rc(6,"(Los formatos "),o.Ob(7,"strong"),o.rc(8,"deben ser"),o.Nb(),o.rc(9," de tipo "),o.Ob(10,"strong"),o.rc(11,"imagen"),o.Nb(),o.rc(12,")"),o.Nb(),o.Nb(),o.Ob(13,"input",3,4),o.Vb("change",function(i){o.kc(t);const n=o.ic(14);return e.filesDropped(i.target.files,n)}),o.Nb(),o.Nb(),o.qc(15,zt,4,2,"div",5),o.qc(16,Zt,2,0,"div",6)}2&t&&(o.xb(15),o.cc("ngIf",e.files),o.xb(1),o.cc("ngIf",e.loading))},directives:[n.m],styles:["#swal2-content{white-space:break-spaces}.dropzone{position:relative}.dropzone:hover{transition:all .3s ease;background-color:azure}.dropzone input{opacity:0;position:absolute;width:100%;height:100%;top:0;left:0;cursor:pointer}.dark-only .dropzone:hover{color:#000!important}.files-list .file-item-wrapper{padding:0 5px!important;flex:0 0 33.3333%;max-width:33.3333%}.upload-status p{width:100%;text-align:center;margin-bottom:10px!important}.file-item{display:flex;justify-content:space-between;align-items:center;background:hsla(0,0%,94.5%,.6705882352941176);padding:10px;border-radius:5px;border:1px solid #d6d6d6;margin-bottom:5px}.file-item .img-custom{padding:5px;background:#fff;border-radius:5px;max-height:50px;width:auto}.file-item .right-side{flex-direction:column;align-items:center}.file-item .right-side,.file-item .right-side .content{width:100%;display:flex}.file-item .right-side .content p{font-size:12px!important}.file-item p{margin-bottom:0}.file-item .btn{padding:5px 7px}.file-item .btn svg{margin-bottom:-5px;height:17px;width:17px}.status{margin:0 20px;display:flex;align-items:center}.status,.status .progress{width:100%}@media screen and (max-width:1700px){.files-list .file-item-wrapper{flex:0 0 50%;max-width:50%}}@media screen and (max-width:1400px){.files-list .file-item-wrapper{flex:0 0 100%;max-width:100%}}"],encapsulation:2}),t})();function Wt(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",8),o.Ob(1,"button",9),o.Vb("click",function(){return o.kc(t),o.Yb(2).removePhotographer()}),o.rc(2),o.Kb(3,"app-feather-icons",10),o.Nb(),o.Nb()}if(2&t){const t=o.Yb(2);o.xb(2),o.tc(" ",t.photographerSelected.name," ")}}function Qt(t,e){1&t&&(o.Ob(0,"li"),o.rc(1," No se ha encontrado fot\xf3grafos con este t\xe9rmino. "),o.Nb())}function te(t,e){1&t&&(o.Ob(0,"li"),o.rc(1," Buscando fot\xf3grafos... "),o.Nb())}function ee(t,e){if(1&t&&(o.Ob(0,"div",11),o.Ob(1,"ul"),o.qc(2,Qt,2,0,"li",12),o.qc(3,te,2,0,"li",12),o.Nb(),o.Nb()),2&t){const t=o.Yb(2);o.xb(2),o.cc("ngIf",t.photographerTerm.length>=3&&!t.loading),o.xb(1),o.cc("ngIf",t.loading)}}function ie(t,e){if(1&t){const t=o.Pb();o.Ob(0,"li",15),o.Vb("click",function(){o.kc(t);const i=e.$implicit;return o.Yb(3).selectPhotographer(i)}),o.rc(1),o.Nb()}if(2&t){const t=e.$implicit;o.xb(1),o.tc(" ",t.email," ")}}function ne(t,e){if(1&t&&(o.Ob(0,"div",13),o.Ob(1,"ul"),o.qc(2,ie,2,1,"li",14),o.Nb(),o.Nb()),2&t){const t=o.Yb(2);o.xb(2),o.cc("ngForOf",t.photographersResults)}}function re(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",1),o.qc(1,Wt,4,1,"div",2),o.Ob(2,"div",3),o.Ob(3,"label",4),o.rc(4,"Fot\xf3grafo"),o.Nb(),o.Ob(5,"input",5),o.Vb("ngModelChange",function(e){return o.kc(t),o.Yb().photographerTerm=e})("keyup",function(){return o.kc(t),o.Yb().searchPhotographers()}),o.Nb(),o.Nb(),o.qc(6,ee,4,2,"div",6),o.qc(7,ne,3,1,"div",7),o.Nb()}if(2&t){const t=o.Yb();o.xb(1),o.cc("ngIf",t.photographerSelected),o.xb(4),o.cc("ngModel",t.photographerTerm)("disabled",t.photographerSelected),o.xb(1),o.cc("ngIf",t.photographersResults.length<=0&&t.photographerTerm),o.xb(1),o.cc("ngIf",t.photographersResults.length>0&&!t.loading)}}let ae=(()=>{class t{constructor(t,e,i){this.authService=t,this.imagesService=e,this.usersService=i,this.loading=!1,this.photographerTerm=null,this.photographersResults=[],this.photographerSelected=null}ngOnInit(){}searchPhotographers(){this.photographerTerm&&(this.photographerTerm.length<3?console.log("Escribe al menos 3 letras"):(this.loading=!0,this.usersService.getUsers({email:this.photographerTerm,role:"PHOTOGRAPHER_ROLE"}).subscribe(t=>{this.photographersResults=t.users,this.loading=!1})))}selectPhotographer(t){this.imagesService.photographerData=Object.assign({id:t._id},t),this.photographerSelected=t,this.photographerTerm=null,this.photographersResults=[]}removePhotographer(){A.a.fire({title:"\xbfEst\xe1s seguro/a?",text:"Estas a punto de remover este fot\xf3grafo, \xbfDeseas continuar?",icon:"question",showCancelButton:!0,confirmButtonText:"Remover",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&(this.photographerSelected=null)})}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(v.a),o.Jb(P),o.Jb(y.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-select-photographer"]],decls:1,vars:1,consts:[["class","photographer",4,"ngIf"],[1,"photographer"],["class","photographer-added mb-4 minify-feather",4,"ngIf"],[1,"form-group"],["for","photographer_term"],["name","photographerTerm","id","photographer_term","type","text","placeholder","Busqueda por email o nombre",1,"form-control",3,"ngModel","disabled","ngModelChange","keyup"],["class","photographer-results no-results",4,"ngIf"],["class","photographer-results",4,"ngIf"],[1,"photographer-added","mb-4","minify-feather"],["type","button",3,"click"],["icon","x"],[1,"photographer-results","no-results"],[4,"ngIf"],[1,"photographer-results"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(t,e){1&t&&o.qc(0,re,8,5,"div",0),2&t&&o.cc("ngIf","ADMIN_ROLE"==e.authService.user.role)},directives:[n.m,S.a,S.i,S.k,k.a,n.l],styles:[".photographer-added[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transition:all .3s ease;font-size:14px;color:#fff;background-color:orange;padding:8px 15px;border-radius:7px;border:1px solid orange;margin-right:10px}.photographer-results[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:-18px;background:#cdcdcd}.photographer-results[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:10px;cursor:pointer;border-radius:0 3pxv}.photographer-results[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:var(--orange);color:#fff}"]}),t})();function oe(t,e){if(1&t&&(o.Ob(0,"div",13),o.Kb(1,"i",14),o.Ob(2,"div",15),o.Ob(3,"p"),o.rc(4,"Subiendo im\xe1genes... Estado: "),o.Ob(5,"strong"),o.rc(6),o.Nb(),o.rc(7),o.Nb(),o.Nb(),o.Nb()),2&t){const t=o.Yb();o.xb(6),o.tc("",t.uploadProgress,"%"),o.xb(1),o.tc(" ",100==t.uploadProgress?"Procesando im\xe1genes... A\xfan restan algunos unos minutos":""," ")}}function se(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",16),o.Ob(1,"div",17),o.Ob(2,"label"),o.rc(3,"Tipo de carga"),o.Nb(),o.Ob(4,"div",18),o.Ob(5,"div",17),o.Ob(6,"input",19),o.Vb("ngModelChange",function(e){return o.kc(t),o.Yb().uploadType=e}),o.Nb(),o.Ob(7,"label",20),o.rc(8,"Carga local"),o.Nb(),o.Nb(),o.Ob(9,"div",21),o.Ob(10,"input",22),o.Vb("ngModelChange",function(e){return o.kc(t),o.Yb().uploadType=e}),o.Nb(),o.Ob(11,"label",23),o.rc(12,"Carga cloud"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(13,"small"),o.rc(14,"La carga cloud sincroniza al instante con el servidor en la nube, por lo cual tomar\xe1 mucho m\xe1s tiempo en procesar cada imagen. La carga local tendra una sincronizaci\xf3n cloud posterior en segundo plano. "),o.Nb(),o.Nb()}if(2&t){const t=o.Yb();o.xb(6),o.cc("ngModel",t.uploadType),o.xb(4),o.cc("ngModel",t.uploadType)}}let ce=(()=>{class t{constructor(t,e,i,n){this.filesService=t,this.imagesService=e,this.tagsService=i,this.authService=n,this.images=[],this.tags=[],this.loading=!1,this.uploadType=m.c?"cloud_upload":"local_upload",this.uploadProgress=0,this.isCloud=m.c,this.filesService.filesUpdated.subscribe(t=>{this.images=t}),this.tagsService.tagsSelected.subscribe(t=>{this.tags=t}),this.filesService.uploadProgress.subscribe(t=>{this.uploadProgress=t})}ngOnInit(){}uploadImages(){return Object($t.a)(this,void 0,void 0,function*(){this.imagesService.photographerData.id||"ADMIN_ROLE"!=this.authService.user.role?(this.loading=!0,"local_upload"===this.uploadType?this.filesService.uploadImages(this.images).subscribe(t=>{var e;(null==t?void 0:t.body)&&(null===(e=t.body)||void 0===e?void 0:e.imagesSaved)&&this.saveImagesData(t.body.imagesSaved)},t=>{this.loading=!1,A.a.fire("Error","Ha ocurrido un error al cargar las imagenes","error"),console.log(t)}):this.cloudUpload()):A.a.fire("Error","Debes seleccionar un fot\xf3grafo","error")})}cloudUpload(){this.filesService.cloudUpload(this.images).subscribe(t=>{var e;(null==t?void 0:t.body)&&(null===(e=t.body)||void 0===e?void 0:e.imagesSaved)&&this.saveImagesData(t.body.imagesSaved,!0)},t=>{this.loading=!1,A.a.fire("Error","Ha ocurrido un error al cargar las imagenes","error"),console.log(t)})}updateTags(t){return new Promise((e,i)=>{const n=this.tagsService.updateTags(this.tags,t).subscribe(t=>{n.unsubscribe(),e(t)},t=>{console.log(t),e(t)})})}uploadFinished(t,e){A.a.fire("Correcto",this.filesService.uploadIndex+" Imagenes subidas correctamente","success"),this.images=[],this.filesService.filesUploaded.emit("uploaded"),this.filesService.uploadIndex=0,this.loading=!1,this.tags=[],this.tagsService.resetTags.emit(!0),t&&A.a.fire("Errores registrados:",t,"error")}saveImagesData(t,e=!1){return Object($t.a)(this,void 0,void 0,function*(){let i=[];for(let n=0;n<Object.keys(t).length;n++){const r=Object.keys(t)[n],a=this.filesService.imagesData[r];a.fileName=t[r],a.copyFileName="copy-"+t[r],a.tags=this.tags,a.imgSync=!1,a.wasCloud=e,i.push(this.saveImage(a)),n%100==0&&(yield Promise.all(i),i=[])}console.log("processing last images, length: ",i.length),yield Promise.all(i),this.uploadFinished(null,t)})}saveImage(t){return new Promise((e,i)=>Object($t.a)(this,void 0,void 0,function*(){try{yield this.imagesService.saveImage(t).toPromise(),this.filesService.uploadIndex++,e(t)}catch(n){console.log(n),i(n)}}))}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(H.a),o.Jb(P),o.Jb(C.a),o.Jb(v.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-add-images"]],decls:19,vars:3,consts:[[1,"container-fluid"],[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"photographer"],[1,"tags"],["class","loading-bar",4,"ngIf"],["class","upload-options",4,"ngIf"],[1,"upload-images-btn","mt-4"],[1,"btn","btn-secondary","upload-icon",3,"disabled","click"],["icon","upload"],[1,"loading-bar"],[1,"fa","fa-spinner","fa-spin"],[1,"row","upload-status","mt-2"],[1,"upload-options"],[1,"form-group","mb-0"],[1,"d-flex"],["type","radio","name","uploadType","id","local_upload","value","local_upload",3,"ngModel","ngModelChange"],["for","local_upload",1,"ml-1"],[1,"form-group","mb-0","ml-3"],["type","radio","name","uploadType","id","cloud_upload","value","cloud_upload",3,"ngModel","ngModelChange"],["for","cloud_upload",1,"ml-1"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"div",3),o.Ob(4,"div",4),o.Ob(5,"h5"),o.rc(6,"Cargar im\xe1genes"),o.Nb(),o.Nb(),o.Ob(7,"div",5),o.Kb(8,"app-upload-images"),o.Ob(9,"div",6),o.Kb(10,"app-select-photographer"),o.Nb(),o.Ob(11,"div",7),o.Kb(12,"app-tags-selector"),o.qc(13,oe,8,2,"div",8),o.Nb(),o.qc(14,se,15,2,"div",9),o.Ob(15,"div",10),o.Ob(16,"button",11),o.Vb("click",function(){return e.uploadImages()}),o.rc(17," Subir im\xe1genes "),o.Kb(18,"app-feather-icons",12),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&t&&(o.xb(13),o.cc("ngIf",e.loading),o.xb(1),o.cc("ngIf",!e.isCloud),o.xb(2),o.cc("disabled",0==e.images.length))},directives:[Xt,ae,J,n.m,k.a,S.m,S.a,S.i,S.k],styles:[".upload-images-btn[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:40px}.upload-images-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;max-width:200px}.loading-bar[_ngcontent-%COMP%]{position:fixed;background-color:#fff;flex-direction:column}"]}),t})();var ge=i("Gkrs"),le=i("qv1T");let be=(()=>{class t{constructor(t,e){this.cartService=t,this.parametersService=e,this.cartItems=[],this.total=0,this.getCart(),this.cartService.cartUpdated.subscribe(()=>{this.getCart()})}ngOnInit(){}getCart(){this.cartService.getCart().subscribe(t=>{this.cartItems=t.cart.products,this.getTotal()})}getParameters(){return new Promise((t,e)=>{this.parametersService.getParameters().subscribe(e=>{this.parameters=e.parameters,t(e.parameters)})})}getTotal(){this.total=0,this.getParameters().then(()=>{this.cartItems.forEach(t=>{this.total+=this.parameters.unityPrice*t.quantity})})}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(M.a),o.Jb(ge.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-cart-detail"]],decls:1,vars:1,consts:[[3,"isHeader"]],template:function(t,e){1&t&&o.Kb(0,"app-cart",0),2&t&&o.cc("isHeader",!1)},directives:[le.a],styles:[""]}),t})(),de=(()=>{class t{constructor(){this.backTo="/imagenes"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),ue=(()=>{class t{constructor(t){this.authService=t}transform(t){let e=t.copyFileName;if(m.c&&"ADMIN_ROLE"===this.authService.user.role)return`${m.b}/${e}`;e=t.fileName;let i=m.a+"/images/image/"+e;return i+="&ownerId="+t.photographerId,i+="&imageId="+t._id,i}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(v.a))},t.\u0275pipe=o.Ib({name:"images",type:t,pure:!0}),t})();function he(t,e){if(1&t&&o.Kb(0,"img",21),2&t){const t=o.Yb(2);o.cc("src",t.image.fullpath,o.mc)}}function pe(t,e){if(1&t&&(o.Kb(0,"img",21),o.Zb(1,"images")),2&t){const t=o.Yb(2);o.cc("src",o.ac(1,1,t.image),o.mc)}}const me=function(t){return{"img-vertical":t}};function fe(t,e){if(1&t&&(o.Ob(0,"div",8),o.Ob(1,"div",19),o.qc(2,he,1,1,"img",20),o.qc(3,pe,2,3,"img",20),o.Nb(),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngClass",o.fc(3,me,(null==t.image||null==t.image.exifData?null:t.image.exifData.Orientation)&&t.image.exifData.Orientation>=5)),o.xb(1),o.cc("ngIf",!t.authService.user||(null==t.authService||null==t.authService.user?null:t.authService.user.purchases.indexOf(t.image._id))<0),o.xb(1),o.cc("ngIf",t.authService.user&&(null==t.authService||null==t.authService.user?null:t.authService.user.purchases.indexOf(t.image._id))>=0)}}function Oe(t,e){if(1&t&&(o.Ob(0,"div",22),o.rc(1),o.Zb(2,"number"),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.tc(" $",o.bc(2,1,t.parameters&&t.parameters.unityPrice?t.parameters.unityPrice:0,"1.2-2")," ")}}function ve(t,e){if(1&t&&(o.Ob(0,"span",25),o.rc(1),o.Nb()),2&t){const t=e.$implicit;o.xb(1),o.tc(" ",t," ")}}function xe(t,e){if(1&t&&(o.Ob(0,"div",23),o.qc(1,ve,2,1,"span",24),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngForOf",t.image.tags)}}function Pe(t,e){if(1&t){const t=o.Pb();o.Ob(0,"button",33),o.Vb("click",function(){o.kc(t);const e=o.Yb(2);return e.addToCart(e.image._id)}),o.Kb(1,"i",34),o.rc(2," A\xf1adir al carrito "),o.Nb()}if(2&t){const t=o.Yb(2);o.cc("disabled",t.loading)}}function Ce(t,e){1&t&&(o.Ob(0,"button",35),o.rc(1," A\xf1adido al carrito "),o.Kb(2,"app-feather-icons",36),o.Nb()),2&t&&(o.xb(2),o.cc("icon","check"))}function Me(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",26),o.qc(1,Pe,3,1,"button",27),o.qc(2,Ce,3,1,"button",28),o.Ob(3,"button",29),o.Vb("click",function(){o.kc(t);const e=o.Yb();return e.addToCart(e.image._id,!0)}),o.Kb(4,"i",30),o.rc(5," Comprar ahora "),o.Nb(),o.Ob(6,"a",31),o.Vb("click",function(){o.kc(t);const e=o.Yb();return e.markAsFavorite(e.image._id,!0)}),o.Kb(7,"i",32),o.rc(8),o.Nb(),o.Nb()}if(2&t){const t=o.Yb();o.xb(1),o.cc("ngIf",t.cart.indexOf(t.image._id)<0),o.xb(1),o.cc("ngIf",t.cart.indexOf(t.image._id)>=0),o.xb(6),o.tc(" ",t.authService.user&&t.authService.user.favorites.indexOf(t.image._id)>=0?"En favoritas":"Agregar a favoritas"," ")}}function Ne(t,e){if(1&t){const t=o.Pb();o.Ob(0,"button",37),o.Vb("click",function(){return o.kc(t),o.Yb().goTo(-1)}),o.Kb(1,"i",38),o.rc(2," Anterior "),o.Nb()}}function ye(t,e){if(1&t){const t=o.Pb();o.Ob(0,"button",39),o.Vb("click",function(){return o.kc(t),o.Yb().goTo(1)}),o.rc(1," Siguiente "),o.Kb(2,"i",40),o.Nb()}}let _e=(()=>{class t{constructor(t,e,i,n,r,a,o,s,c,g,l){var b,d;this.imagesService=t,this.parametersService=e,this.cartService=i,this.route=n,this.router=r,this.profileService=a,this.authService=o,this.gs=s,this.ps=c,this.imgFiltersService=g,this.backToService=l,this.image=new K,this.loading=!1,this.cart=null,this.backUrl="/",this.gs.resetData(),this.authService.user&&"CLIENT_ROLE"!==this.authService.user.role?this.backUrl=this.backToService.backTo:(this.imgFiltersService.filters.favorites.active&&(this.backUrl="/favoritos"),(null===(d=null===(b=this.imgFiltersService.filters)||void 0===b?void 0:b.purchases)||void 0===d?void 0:d.active)&&(this.backUrl="/mis-imagenes")),this.route.params.subscribe(t=>{this.productId=t.productId,null==this.imgFiltersService.lastSeenImg||null==this.imgFiltersService.lastSeenImg?this.getImage():this.image=this.imgFiltersService.lastSeenImg,this.getParameters(),this.authService.user&&"CLIENT_ROLE"===this.authService.user.role&&this.getCart()})}getImage(){this.imagesService.getImage(this.productId).subscribe(t=>{this.image=t.image,this.image.fullpath="https://fotiar-imgs-bucket-copies.s3.sa-east-1.amazonaws.com/"+this.image.copyFileName,this.refreshData()},t=>this.router.navigate(["/"]))}goBack(){this.imgFiltersService.lastSeenImg=this.image,this.router.navigate([this.backUrl])}refreshData(){this.gs.images.length||this.gs.getDataIfExists(),this.gs.setGalleryIndex(this.productId)}getParameters(){this.parametersService.getParameters().subscribe(t=>{this.parameters=t.parameters})}getCart(){this.cart=[],this.cartService.getCart().subscribe(t=>{t.cart.products.forEach(t=>{this.cart.push(t.imageId._id)})})}addToCart(t,e=!1){if(!this.loading){if(!this.authService.user)return A.a.fire({title:"Debes iniciar sesi\xf3n para poder agregar al carrito",icon:"warning"}),void this.router.navigate(["/login"]);this.loading=!0,this.cartService.addToCart(t).subscribe(i=>{this.cartService.cartUpdated.emit(t),this.loading=!1,this.markAsFavorite(t,!1),e?this.router.navigate(["/checkout"]):this.getCart()},t=>this.loading=!1)}}getUserProfile(t=!1){this.profileService.getUserProfile().subscribe(e=>{if(t){const t=JSON.parse(localStorage.getItem("user"));t.favorites=e.user.favorites,this.authService.saveInStorage(t,this.authService.token,this.authService.tokenExpiration)}})}markAsFavorite(t,e=!0){if(!this.authService.user)return A.a.fire({title:"Debes iniciar sesi\xf3n para poder marcar como favorito",icon:"warning"}),void this.router.navigate(["/login"]);let i=this.authService.user.favorites;const n=i.indexOf(t);n>=0&&e&&i.splice(n,1),n<0&&i.push(t),this.profileService.editProfile({email:this.authService.user.email,favorites:i}).subscribe(t=>{this.getUserProfile(!0)})}goTo(t){return Object($t.a)(this,void 0,void 0,function*(){const e=this.isLastOrFist(t);this.gs.currentPageIndex+=t,e&&("last"==e?yield this.refreshPaginationData(this.gs.images,[],"ahead"):yield this.refreshPaginationData([],this.gs.images,"behind"));const i=this.gs.images.indexOf(this.productId);this.gs.setGalleryIndex(this.gs.images[i+t]);const n=this.gs.images[this.gs.imageIndex];this.productId=n,this.gs.setActualPage(t),this.router.navigate(["producto",n])})}isLastOrFist(t){return this.gs.imageIndex==this.gs.images.length-1&&this.gs.checkPages("ahead")&&1==t?"last":!(0!=this.gs.imageIndex||!this.gs.checkPages("behind")||-1!=t)&&"first"}refreshPaginationData(t=[],e=[],i=null){return new Promise((n,r)=>Object($t.a)(this,void 0,void 0,function*(){let r;r=this.authService.user&&"CLIENT_ROLE"==this.authService.user.role?yield this.imagesService.getImagesClient(this.gs.filters,i).toPromise():yield this.imagesService.getImages(this.gs.filters,i).toPromise(),this.ps.paginationData.total=r.total,this.gs.setData(r.images,this.gs.filters,t,e),n(r.images)}))}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(P),o.Jb(ge.a),o.Jb(M.a),o.Jb(s.a),o.Jb(s.f),o.Jb(B),o.Jb(v.a),o.Jb(N),o.Jb(x.a),o.Jb(_.a),o.Jb(de))},t.\u0275cmp=o.Db({type:t,selectors:[["app-product-detail"]],decls:44,vars:11,consts:[[1,"container-fluid"],[1,"card"],[1,"card-body"],[1,"go-back"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-arrow-left"],[1,"row","product-page-main"],["class","col-xl-6",4,"ngIf"],[1,"col-xl-6"],[1,"product-page-details"],["class","product-price f-28",4,"ngIf"],[1,"product-page-width"],[1,"txt-success","pl-1"],["class","tag-list mt-2",4,"ngIf"],["class","m-t-15 final-btns",4,"ngIf"],[1,"col-xl-12"],[1,"gallery-btns","m-t-25"],["class","btn btn-primary prev",3,"click",4,"ngIf"],["class","btn btn-primary next",3,"click",4,"ngIf"],[1,"product-img","d-flex","justify-content-center",3,"ngClass"],["style","max-width: 100%;",3,"src",4,"ngIf"],[2,"max-width","100%",3,"src"],[1,"product-price","f-28"],[1,"tag-list","mt-2"],["class","badge badge-pill badge-secondary",4,"ngFor","ngForOf"],[1,"badge","badge-pill","badge-secondary"],[1,"m-t-15","final-btns"],["class","btn btn-primary m-r-10","type","button","title","",3,"disabled","click",4,"ngIf"],["routerLink","/carrito","class","btn btn-success mr-2 minify-feather mb-1",4,"ngIf"],["type","button","title","",1,"btn","btn-primary","m-r-10",3,"click"],[1,"fa","fa-shopping-cart","mr-1"],[1,"btn","btn-secondary","add-to-favorites",3,"click"],[1,"fa","fa-star","mr-1"],["type","button","title","",1,"btn","btn-primary","m-r-10",3,"disabled","click"],[1,"fa","fa-shopping-basket","mr-1"],["routerLink","/carrito",1,"btn","btn-success","mr-2","minify-feather","mb-1"],[3,"icon"],[1,"btn","btn-primary","prev",3,"click"],[1,"fa","fa-chevron-left","pr-1"],[1,"btn","btn-primary","next",3,"click"],[1,"fa","fa-chevron-right","pl-1"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.Ob(1,"div"),o.Ob(2,"div",1),o.Ob(3,"div",2),o.Ob(4,"div",3),o.Ob(5,"a",4),o.Vb("click",function(){return e.goBack()}),o.Kb(6,"i",5),o.rc(7," Volver "),o.Nb(),o.Nb(),o.Ob(8,"div",6),o.qc(9,fe,4,5,"div",7),o.Ob(10,"div",8),o.Ob(11,"div",9),o.Ob(12,"h3"),o.rc(13,"Imagen listado"),o.Nb(),o.Nb(),o.qc(14,Oe,3,4,"div",10),o.Kb(15,"hr"),o.Ob(16,"div"),o.Ob(17,"table",11),o.Ob(18,"tbody"),o.Ob(19,"tr"),o.Ob(20,"td"),o.Ob(21,"b"),o.rc(22,"Fecha:"),o.Nb(),o.Nb(),o.Ob(23,"td"),o.rc(24),o.Zb(25,"date"),o.Nb(),o.Nb(),o.Ob(26,"tr"),o.Ob(27,"td"),o.Ob(28,"b"),o.rc(29,"Fotografo:"),o.Nb(),o.Nb(),o.Ob(30,"td",12),o.rc(31),o.Nb(),o.Nb(),o.Ob(32,"tr"),o.Ob(33,"td"),o.Ob(34,"b"),o.rc(35,"Tags:"),o.Nb(),o.Nb(),o.Ob(36,"td"),o.qc(37,xe,2,1,"div",13),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Kb(38,"hr"),o.qc(39,Me,9,3,"div",14),o.Nb(),o.Ob(40,"div",15),o.Ob(41,"div",16),o.qc(42,Ne,3,0,"button",17),o.qc(43,ye,3,0,"button",18),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&t&&(o.xb(9),o.cc("ngIf",e.image),o.xb(5),o.cc("ngIf",!e.authService.user||"CLIENT_ROLE"==e.authService.user.role),o.xb(10),o.sc(o.bc(25,8,e.image.creationDate,"dd/MM/yyyy HH:mm:ss")),o.xb(7),o.sc(e.image.photographerId),o.xb(6),o.cc("ngIf",e.image.tags.length>0),o.xb(2),o.cc("ngIf",e.cart),o.xb(3),o.cc("ngIf",e.ps.paginationData.actualPage>1||e.gs.imageIndex>0),o.xb(1),o.cc("ngIf",e.ps.paginationData.actualPage<e.ps.paginationData.pages.length||e.gs.imageIndex<e.gs.images.length-1))},directives:[n.m,n.k,n.l,s.g,k.a],pipes:[n.e,ue,n.f],styles:[".card[_ngcontent-%COMP%]{min-height:70vh!important}.product-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{box-shadow:1px 1px 3px #000;padding:5px;border-radius:5px}.img-vertical[_ngcontent-%COMP%]{margin-top:50px}.img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:500px!important}.gallery-btns[_ngcontent-%COMP%]{position:relative}.gallery-btns[_ngcontent-%COMP%]   button.prev[_ngcontent-%COMP%]{position:absolute;left:0}.gallery-btns[_ngcontent-%COMP%]   button.next[_ngcontent-%COMP%]{position:absolute;right:0}@media screen and (max-width:1785px){.final-btns[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-top:12px}}@media screen and (max-width:1500px){.img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:400px!important}}@media screen and (max-width:1200px){.img-vertical[_ngcontent-%COMP%]{margin:60px 0}}@media screen and (max-width:500px){.final-btns[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.final-btns[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:block;width:100%}}"]}),t})();var Ie=i("SqMf"),Se=i("24vF"),we=i("uQub");let ke=(()=>{class t{constructor(t,e){this.http=t,this.authService=e,this.refreshMpButton=new o.n}placerOrder(t){let e=m.a+"/checkout/mercadopago/qr/";return e+=this.authService.user._id,e+="?token="+this.authService.token,this.http.post(e,t)}generatePreference(t){let e=m.a+"/checkout/mercadopago/preference/";return e+=this.authService.user._id,e+="?token="+this.authService.token,this.http.post(e,t)}parseProducts(t){let e=[],i=[];t.products.forEach(n=>{e.push({title:"Imagen fotiar",description:"Imagen fotiar",unit_price:t.unityPrice,quantity:n.quantity,unit_measure:"unit",total_amount:t.total}),i.push(n.imageId._id)});const n=this.addDiscounts(t);return{items:[...e,...n],imageIds:i}}addDiscounts(t){return t.discounts.map(t=>({title:t.title,unit_price:-1*t.discountAmount,unit_measure:"unit",quantity:1}))}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(O.b),o.Sb(v.a))},t.\u0275prov=o.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function De(t,e){if(1&t&&(o.Ob(0,"a",2),o.rc(1," Ir a MercadoPago "),o.Nb()),2&t){const t=o.Yb();o.dc("href",t.initPoint,o.mc)}}let Fe=(()=>{class t{constructor(t){this.mercadopagoService=t,this.loading=!1,this.qrSelected=null,this.mp=null,this.initPoint=null,this.mercadopagoService.refreshMpButton.subscribe(()=>{this.initPoint=null,this.initMPButton()})}ngOnInit(){this.loading=!0,this.mp=new MercadoPago(m.d,{locale:"es-AR"}),this.initMPButton()}initMPButton(){this.loading=!0,this.generatePreference().then(t=>{this.loading=!1,this.initPoint=t}).catch(t=>{console.log(t),A.a.fire("Error","Ha ocurrido un error con el servicio de MercadoPago","error")})}placeOrderQR(){this.qrSelected="qr",this.loading=!0;const{items:t,imageIds:e}=this.mercadopagoService.parseProducts(this.data),i=Object.assign(Object.assign({},this.data),{amount:this.data.total,items:t,imageIds:e});this.mercadopagoService.placerOrder(i).subscribe(t=>{this.qrData=t.qrData,this.loading=!1},t=>A.a.fire("error","Ha ocurrido un error al generar la orden"))}generatePreference(){return new Promise((t,e)=>{const{items:i,imageIds:n}=this.mercadopagoService.parseProducts(this.data),r=Object.assign(Object.assign({},this.data),{amount:this.data.total,items:i,imageIds:n});this.mercadopagoService.generatePreference(r).subscribe(e=>{t(e.initPoint)},t=>{e(t)})})}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(ke))},t.\u0275cmp=o.Db({type:t,selectors:[["app-mercadopago"]],inputs:{data:"data"},decls:2,vars:1,consts:[[1,"mp-options"],["class","btn btn-primary mercadopago-button",3,"href",4,"ngIf"],[1,"btn","btn-primary","mercadopago-button",3,"href"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.qc(1,De,2,1,"a",1),o.Nb()),2&t&&(o.xb(1),o.cc("ngIf",e.initPoint&&!e.qrSelected))},directives:[n.m],styles:["button.qr-button[_ngcontent-%COMP%]{padding:20px;font-size:18px}.loading[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:10vh;color:var(--theme-deafult)}.qr-code[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{text-align:center;margin-bottom:25px}.qr-code[_ngcontent-%COMP%]   .qr-code-container[_ngcontent-%COMP%]{display:flex;justify-content:center}"]}),t})();function Te(t,e){if(1&t&&(o.Ob(0,"li"),o.rc(1),o.Ob(2,"span"),o.rc(3),o.Zb(4,"number"),o.Nb(),o.Nb()),2&t){const t=e.$implicit,i=o.Yb();o.xb(1),o.tc(" Imagen listado \xd7 ",t.quantity," "),o.xb(2),o.tc("$",o.bc(4,2,i.data.unityPrice,"1.2-2"),"")}}function Ae(t,e){if(1&t&&(o.Ob(0,"li"),o.rc(1),o.Ob(2,"span",13),o.rc(3),o.Zb(4,"number"),o.Nb(),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.tc(" ",t.comboDiscount.title," "),o.xb(2),o.tc("- $",o.bc(4,2,t.comboDiscount.discountAmount,"1.2-2"),"")}}function Ee(t,e){if(1&t&&(o.Ob(0,"li"),o.rc(1),o.Ob(2,"span",13),o.rc(3),o.Zb(4,"number"),o.Nb(),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.uc(" ",t.couponApplied.title," - ",t.couponApplied.percentage,"%OFF "),o.xb(2),o.tc("- $",o.bc(4,3,t.couponApplied.discountAmount,"1.2-2"),"")}}function qe(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",30),o.Ob(1,"button",26),o.Vb("click",function(){return o.kc(t),o.Yb().placeOrder()}),o.rc(2," Realizar compra "),o.Nb(),o.Nb()}if(2&t){const t=o.Yb();o.xb(1),o.cc("disabled",t.loading)}}function Ye(t,e){if(1&t&&(o.Ob(0,"div",31),o.Kb(1,"app-mercadopago",32),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("data",t.data)}}let Re=(()=>{class t{constructor(t,e,i,n,r,a,o,s){this.cartService=t,this.parametersService=e,this.authService=i,this.checkoutService=n,this.comboDiscountsService=r,this.couponsService=a,this.mercadopagoService=o,this.router=s,this.data={products:[],discounts:[],paymentOption:null,subtotal:0,total:0,email:this.authService.user.email,unityPrice:0},this.couponCode=null,this.activeCoupon=null,this.comboDiscount=null,this.couponApplied=null,this.cardNotValid=!1,this.loading=!1,this.getCart()}ngOnInit(){A.a.fire({title:"\xbfComo deseas pagar?",text:"Puedes elegir entre el pago en caja o mediante MercadoPago",icon:"question",showCancelButton:!0,confirmButtonText:"MercadoPago",cancelButtonText:"En caja"}).then(t=>{this.data.paymentOption=t.isConfirmed?"mercadopago":"cashier"})}getCart(){this.cartService.getCart().subscribe(t=>{this.data.products=t.cart.products,0==this.data.products.length&&(A.a.fire("Error","Tu carrito se encuentra vac\xedo","error"),this.router.navigate(["/"])),this.getParameters()})}getParameters(){this.parametersService.getParameters().subscribe(t=>{this.data.unityPrice=t.parameters.unityPrice,this.getTotals()})}getTotals(){return Object($t.a)(this,void 0,void 0,function*(){this.data.subtotal=0,this.data.products.forEach(t=>{this.data.subtotal+=this.data.unityPrice*t.quantity}),yield this.checkComboDiscounts()})}checkComboDiscounts(){return Object($t.a)(this,void 0,void 0,function*(){const t=this.checkoutService.getImagesAmount(this.data),{discountApplies:e,discountAmount:i}=yield this.comboDiscountsService.checkIfDiscountApplies(t);if(e){const{total:e}=this.checkoutService.applyDiscount(this.data.subtotal,i);this.data.total=e;const n={type:"imagesAmount",title:`Descuento por ${t} im\xe1genes`,discountAmount:i};this.data.discounts.push(n),this.comboDiscount=n}else this.data.total=this.data.subtotal})}applyCoupon(){this.couponCode&&!this.activeCoupon&&this.couponsService.getCouponByCode(this.couponCode).subscribe(t=>{if(!t.coupon)return void A.a.fire("Error","No existe un cup\xf3n con ese c\xf3digo","error");this.activeCoupon=t.coupon;const{total:e,discountAmount:i}=this.checkoutService.applyCoupon(this.data.total,this.activeCoupon.discountPercentage);this.data.total=e;const n={type:"coupon",title:this.activeCoupon.title,percentage:this.activeCoupon.discountPercentage,discountAmount:i};this.data.discounts.push(n),this.couponApplied=n,this.reloadMpPreference()})}reloadMpPreference(){"mercadopago"==this.data.paymentOption&&this.mercadopagoService.refreshMpButton.emit("refresh")}placeOrder(){if(this.loading)return;if(this.data.products.length<=0)return void A.a.fire("Error","Debes agregar por lo menos un producto","error");const t=Object.assign(Object.assign({},this.data),{imageIds:this.checkoutService.getImagesId(this.data.products)});this.checkoutService.placeCashierOrder(t).subscribe(t=>{this.orderPlaced()},t=>{this.loading=!1,A.a.fire("Error","Ha ocurrido un error en la transacci\xf3n","error")})}orderPlaced(){this.loading=!1,this.cartService.cartUpdated.emit("cart updated"),A.a.fire("Correcto","Orden creada correctamente, acercate a la caja para concretarla","success"),this.router.navigate(["/"])}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(M.a),o.Jb(ge.a),o.Jb(v.a),o.Jb(Ie.a),o.Jb(Se.a),o.Jb(we.a),o.Jb(ke),o.Jb(s.f))},t.\u0275cmp=o.Db({type:t,selectors:[["app-checkout"]],decls:51,vars:18,consts:[[1,"container-fluid"],[1,"card"],[1,"card-header"],[1,"card-body","checkout"],[1,"row"],[1,"col-lg-6","col-lg-12"],[1,"checkout-details"],[1,"order-box"],[1,"title-box"],[1,"checkbox-title"],[1,"qty"],[4,"ngFor","ngForOf"],[1,"sub-total"],[1,"count"],[1,"discounts","sub-total"],[4,"ngIf"],[1,"sub-total","total"],[1,"animate-chk"],[1,"col"],["for","payment-cashier",1,"d-block"],["value","cashier","id","payment-cashier","type","radio","name","payment",1,"radio_animated",3,"ngModel","ngModelChange"],["for","payment-mercadopago",1,"d-block"],["name","payment","value","mercadopago","id","payment-mercadopago","type","radio",1,"radio_animated",3,"ngModel","ngModelChange"],["src","assets/images/checkout/paypal.png","alt","",1,"img-paypal"],[1,"coupon-section"],["name","couponCode","type","text","placeholder","Ingresar c\xf3digo",1,"form-control",3,"ngModel","disabled","keyup.enter","ngModelChange"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fa","fa-angle-right"],["class","text-right",4,"ngIf"],["class","mercadopago-checkout text-right",4,"ngIf"],[1,"text-right"],[1,"mercadopago-checkout","text-right"],[3,"data"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"h5"),o.rc(4,"Detalles de facturaci\xf3n"),o.Nb(),o.Nb(),o.Ob(5,"div",3),o.Ob(6,"div",4),o.Ob(7,"div",5),o.Ob(8,"div",6),o.Ob(9,"div",7),o.Ob(10,"div",8),o.Ob(11,"div",9),o.Ob(12,"h4"),o.rc(13,"Productos "),o.Nb(),o.Ob(14,"span"),o.rc(15,"Total"),o.Nb(),o.Nb(),o.Nb(),o.Ob(16,"ul",10),o.qc(17,Te,5,5,"li",11),o.Nb(),o.Ob(18,"ul",12),o.Ob(19,"li"),o.rc(20,"Subtotal "),o.Ob(21,"span",13),o.rc(22),o.Zb(23,"number"),o.Nb(),o.Nb(),o.Nb(),o.Ob(24,"ul",14),o.qc(25,Ae,5,5,"li",15),o.qc(26,Ee,5,6,"li",15),o.Nb(),o.Ob(27,"ul",16),o.Ob(28,"li"),o.rc(29,"Total "),o.Ob(30,"span",13),o.rc(31),o.Zb(32,"number"),o.Nb(),o.Nb(),o.Nb(),o.Ob(33,"div",17),o.Ob(34,"div",4),o.Ob(35,"div",18),o.Ob(36,"label",19),o.Ob(37,"input",20),o.Vb("ngModelChange",function(t){return e.data.paymentOption=t}),o.Nb(),o.rc(38," Pago en caja "),o.Nb(),o.Ob(39,"label",21),o.Ob(40,"input",22),o.Vb("ngModelChange",function(t){return e.data.paymentOption=t}),o.Nb(),o.rc(41," MercadoPago "),o.Kb(42,"img",23),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(43,"div",24),o.Ob(44,"h6"),o.rc(45,"Aplicar cup\xf3n"),o.Nb(),o.Ob(46,"input",25),o.Vb("keyup.enter",function(){return e.applyCoupon()})("ngModelChange",function(t){return e.couponCode=t}),o.Nb(),o.Ob(47,"button",26),o.Vb("click",function(){return e.applyCoupon()}),o.Kb(48,"i",27),o.Nb(),o.Nb(),o.qc(49,qe,3,1,"div",28),o.qc(50,Ye,2,1,"div",29),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&t&&(o.xb(17),o.cc("ngForOf",e.data.products),o.xb(5),o.tc("$",o.bc(23,12,e.data.subtotal,"1.2-2"),""),o.xb(3),o.cc("ngIf",e.comboDiscount),o.xb(1),o.cc("ngIf",e.couponApplied),o.xb(5),o.tc("$",o.bc(32,15,e.data.total,"1.2-2"),""),o.xb(6),o.cc("ngModel",e.data.paymentOption),o.xb(3),o.cc("ngModel",e.data.paymentOption),o.xb(6),o.cc("ngModel",e.couponCode)("disabled",e.activeCoupon),o.xb(1),o.cc("disabled",e.activeCoupon),o.xb(2),o.cc("ngIf","mercadopago"!==e.data.paymentOption),o.xb(1),o.cc("ngIf","mercadopago"==e.data.paymentOption))},directives:[n.l,n.m,S.m,S.a,S.i,S.k,Fe],pipes:[n.f],styles:[".discounts[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-weight:300!important}.discounts[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{left:-1rem}.input-error[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-color:red!important}.input-error[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:red!important;margin-top:5px;margin-left:2px}.coupon-section[_ngcontent-%COMP%]{margin:20px 0;display:flex;align-items:center;flex-wrap:wrap}.coupon-section[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{white-space:nowrap;margin-right:15px;margin-bottom:0}.coupon-section[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:180px;border-radius:4px 0 0 4px}.coupon-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0 4px 4px 0;height:calc(1.5em + .75rem + 5px)}.coupon-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:23px}"]}),t})(),je=(()=>{class t{constructor(t,e,i){this.http=t,this.authService=e,this.paginationService=i}getOrders(t){return this.http.post(m.a+"/cashier/get-orders",{filters:t,pagination:this.paginationService.paginationData}).pipe(Object(f.a)(t=>(this.paginationService.updatePagination(t.total,t.skip),t)))}markAsPayed(t){return this.http.post(m.a+"/cashier/mark-as-payed/"+t,{orderId:t})}deleteOrder(t){return this.http.delete(m.a+"/cashier/delete-order/"+t)}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(O.b),o.Sb(v.a),o.Sb(x.a))},t.\u0275prov=o.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Le(t,e){1&t&&o.Kb(0,"app-feather-icons",24)}function Ve(t,e){1&t&&o.Kb(0,"app-feather-icons",25)}function Je(t,e){if(1&t&&(o.Ob(0,"div",21),o.qc(1,Le,1,0,"app-feather-icons",22),o.qc(2,Ve,1,0,"app-feather-icons",23),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngIf",-1==t.filters.order.order),o.xb(1),o.cc("ngIf",1==t.filters.order.order)}}function Ke(t,e){1&t&&o.Kb(0,"app-feather-icons",24)}function Ue(t,e){1&t&&o.Kb(0,"app-feather-icons",25)}function Be(t,e){if(1&t&&(o.Ob(0,"div",21),o.qc(1,Ke,1,0,"app-feather-icons",22),o.qc(2,Ue,1,0,"app-feather-icons",23),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngIf",-1==t.filters.order.order),o.xb(1),o.cc("ngIf",1==t.filters.order.order)}}function He(t,e){1&t&&o.Kb(0,"app-feather-icons",24)}function $e(t,e){1&t&&o.Kb(0,"app-feather-icons",25)}function Ge(t,e){if(1&t&&(o.Ob(0,"div",21),o.qc(1,He,1,0,"app-feather-icons",22),o.qc(2,$e,1,0,"app-feather-icons",23),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngIf",-1==t.filters.order.order),o.xb(1),o.cc("ngIf",1==t.filters.order.order)}}const ze=function(t){return["/caja",t]};function Ze(t,e){if(1&t){const t=o.Pb();o.Ob(0,"tr"),o.Ob(1,"td"),o.rc(2),o.Nb(),o.Ob(3,"td"),o.rc(4),o.Zb(5,"date"),o.Nb(),o.Ob(6,"td"),o.rc(7),o.Zb(8,"number"),o.Nb(),o.Ob(9,"td",19),o.Ob(10,"div",26),o.Ob(11,"button",27),o.Vb("click",function(){o.kc(t);const i=e.$implicit;return o.Yb().markAsPayed(i)}),o.Kb(12,"app-feather-icons",28),o.rc(13," Marcar como pago "),o.Nb(),o.Ob(14,"button",29),o.Kb(15,"app-feather-icons",28),o.rc(16," Editar "),o.Nb(),o.Ob(17,"button",30),o.Vb("click",function(){o.kc(t);const i=e.$implicit;return o.Yb().deleteOrder(i)}),o.Kb(18,"app-feather-icons",28),o.rc(19," Eliminar "),o.Nb(),o.Nb(),o.Nb(),o.Nb()}if(2&t){const t=e.$implicit;o.xb(2),o.sc(t.userEmail),o.xb(2),o.sc(o.bc(5,7,t.orderDate,"dd/MM/y HH:mm:ss")),o.xb(3),o.tc("$",o.bc(8,10,t.totalAmount,"1.2-2"),""),o.xb(5),o.cc("icon","sliders"),o.xb(2),o.cc("routerLink",o.fc(13,ze,t._id)),o.xb(1),o.cc("icon","sliders"),o.xb(3),o.cc("icon","trash")}}let Xe=(()=>{class t{constructor(t,e,i){this.cashierService=t,this.router=e,this.paginationService=i,this.filters={email:"",order:{by:"",order:1}},this.orders=[],this.paginationService.pageChanged.subscribe(t=>{this.getOrders()}),this.getOrders()}ngOnInit(){}getOrders(){this.cashierService.getOrders(this.filters).subscribe(t=>{this.orders=t.orders})}orderBy(t){this.filters.order.by==t&&(this.filters.order.order=1==this.filters.order.order?-1:1),this.filters.order.by=t,this.getOrders()}markAsPayed(t){A.a.fire({title:"\xbfEst\xe1s seguro/a?",text:"Estas a punto de marcar este pedido como pago, \xbfDeseas continuar?",icon:"question",showCancelButton:!0,confirmButtonText:"Marcar como pago",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&this.cashierService.markAsPayed(t._id).subscribe(t=>{Object(p.c)(t),this.getOrders()},t=>{console.log(t)})})}EditOrder(t){this.router.navigate(["/caja/"+t._id])}deleteOrder(t){A.a.fire({title:"\xbfEst\xe1s seguro/a?",text:"Estas a punto de eliminar este pedido, \xbfDeseas continuar?",icon:"question",showCancelButton:!0,confirmButtonText:"Eliminar pedido",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&this.cashierService.deleteOrder(t._id).subscribe(t=>{Object(p.c)(t),this.getOrders()},t=>{console.log(t)})})}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(je),o.Jb(s.f),o.Jb(x.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-pending-orders"]],decls:37,vars:6,consts:[[1,"container-fluid","users"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"card-body","custom-datatable"],[1,"filters","d-flex","justify-content-between","align-items-center"],[1,"row","filters-options","w-75"],[1,"col-12","col-sm-6"],[1,"form-group"],["for","filterEmail"],["name","emailFilter","type","text","id","filterEmail","placeholder","Filtrar por email",1,"form-control","w-100",3,"ngModel","ngModelChange","keyup.enter"],[1,"filter-btn","mb-3","w-25","text-right"],[1,"btn","btn-secondary","w-100","minify-feather",2,"max-width","200px",3,"click"],["icon","search"],[1,"table-responsive"],[1,"table","table-striped"],["scope","col",1,"sort",3,"click"],["class","normal-sort",4,"ngIf"],[1,"text-center"],[4,"ngFor","ngForOf"],[1,"normal-sort"],["icon","chevron-up",4,"ngIf"],["icon","chevron-down",4,"ngIf"],["icon","chevron-up"],["icon","chevron-down"],[1,"buttons","d-flex","justify-content-center","flex-wrap-no","minify-feather"],[1,"btn","btn-success","mr-2",3,"click"],[3,"icon"],[1,"btn","btn-primary","mr-2",3,"routerLink"],[1,"btn","btn-danger","mr-2",3,"click"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"div",3),o.Ob(4,"div",4),o.Ob(5,"h5"),o.rc(6),o.Nb(),o.Nb(),o.Ob(7,"div",5),o.Ob(8,"div",6),o.Ob(9,"div",7),o.Ob(10,"div",8),o.Ob(11,"div",9),o.Ob(12,"label",10),o.rc(13,"Identificador cliente"),o.Nb(),o.Ob(14,"input",11),o.Vb("ngModelChange",function(t){return e.filters.email=t})("keyup.enter",function(){return e.getOrders()}),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(15,"div",12),o.Ob(16,"button",13),o.Vb("click",function(){return e.getOrders()}),o.Kb(17,"app-feather-icons",14),o.rc(18," Filtrar "),o.Nb(),o.Nb(),o.Nb(),o.Ob(19,"div",15),o.Ob(20,"table",16),o.Ob(21,"thead"),o.Ob(22,"tr"),o.Ob(23,"th",17),o.Vb("click",function(){return e.orderBy("userEmail")}),o.rc(24," Usuario "),o.qc(25,Je,3,2,"div",18),o.Nb(),o.Ob(26,"th",17),o.Vb("click",function(){return e.orderBy("orderDate")}),o.rc(27," Fecha "),o.qc(28,Be,3,2,"div",18),o.Nb(),o.Ob(29,"td",17),o.Vb("click",function(){return e.orderBy("totalAmount")}),o.rc(30," Monto "),o.qc(31,Ge,3,2,"div",18),o.Nb(),o.Ob(32,"th",19),o.rc(33," Acci\xf3n "),o.Nb(),o.Nb(),o.Nb(),o.Ob(34,"tbody"),o.qc(35,Ze,20,15,"tr",20),o.Nb(),o.Nb(),o.Nb(),o.Kb(36,"app-pagination"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&t&&(o.xb(6),o.tc("Ordenes pendientes ( ",e.paginationService.paginationData.total," )"),o.xb(8),o.cc("ngModel",e.filters.email),o.xb(11),o.cc("ngIf","userEmail"==e.filters.order.by),o.xb(3),o.cc("ngIf","orderDate"==e.filters.order.by),o.xb(3),o.cc("ngIf","totalAmount"==e.filters.order.by),o.xb(4),o.cc("ngForOf",e.orders))},directives:[S.a,S.i,S.k,k.a,n.m,n.l,w.a,s.g],pipes:[n.e,n.f],styles:[""]}),t})();var We=i("JIr8");let Qe=(()=>{class t{constructor(t,e,i){this.http=t,this.authService=e,this.paginationService=i}getOrders(t){const e={filters:Object.assign(Object.assign({},t),{date:{from:t.date.from?new Date(t.date.from).getTime():null,to:t.date.to?new Date(t.date.to).getTime():null}}),pagination:this.paginationService.paginationData};return this.http.post(m.a+"/orders/search",e).pipe(Object(f.a)(t=>(this.paginationService.updatePagination(t.total,t.skip),t)))}getOrder(t){return this.http.get(m.a+"/orders/"+t)}updateOrder(t){return this.http.post(m.a+"/orders/update/"+t._id,{order:t})}resetpagination(){this.paginationService.resetPagination()}getOrderCaja(t){let e=(new O.e).set("Content-Type","application/json");return this.http.get(m.a+"/orders/"+t,{headers:e}).pipe(Object(f.a)(t=>t),Object(We.a)(t=>Object($t.a)(this,void 0,void 0,function*(){return console.log(t)})))}getClientOrder(t){return this.http.post(m.a+"/orders/client/order/"+this.authService.user._id,{orderId:t})}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(O.b),o.Sb(v.a),o.Sb(x.a))},t.\u0275prov=o.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),ti=(()=>{class t{transform(t){return"cashier"==t?"En caja":"MercadoPago"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Ib({name:"paymentMethod",type:t,pure:!0}),t})();function ei(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",8),o.Ob(1,"div",27),o.Ob(2,"label",28),o.rc(3,"Estado"),o.Nb(),o.Ob(4,"select",29),o.Vb("ngModelChange",function(e){return o.kc(t),o.Yb().filters.status=e}),o.Ob(5,"option",30),o.rc(6,"Todos"),o.Nb(),o.Ob(7,"option",31),o.rc(8,"Pendiente"),o.Nb(),o.Ob(9,"option",32),o.rc(10,"Completada"),o.Nb(),o.Nb(),o.Nb(),o.Nb()}if(2&t){const t=o.Yb();o.xb(4),o.cc("ngModel",t.filters.status)}}function ii(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",33),o.Ob(1,"label",34),o.rc(2,"Usuario (Email o username)"),o.Nb(),o.Ob(3,"input",35),o.Vb("ngModelChange",function(e){return o.kc(t),o.Yb().filters.email=e})("keyup.enter",function(){return o.kc(t),o.Yb().getOrders()}),o.Nb(),o.Nb()}if(2&t){const t=o.Yb();o.xb(3),o.cc("ngModel",t.filters.email)}}function ni(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",33),o.Ob(1,"label",36),o.rc(2,"N\xb0 Pedido"),o.Nb(),o.Ob(3,"input",37),o.Vb("ngModelChange",function(e){return o.kc(t),o.Yb().filters.orderId=e})("keyup.enter",function(){return o.kc(t),o.Yb().getOrders()}),o.Nb(),o.Nb()}if(2&t){const t=o.Yb();o.xb(3),o.cc("ngModel",t.filters.orderId)}}function ri(t,e){1&t&&o.Kb(0,"app-feather-icons",41)}function ai(t,e){1&t&&o.Kb(0,"app-feather-icons",42)}function oi(t,e){if(1&t&&(o.Ob(0,"div",38),o.qc(1,ri,1,0,"app-feather-icons",39),o.qc(2,ai,1,0,"app-feather-icons",40),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngIf",-1==t.filters.order.order),o.xb(1),o.cc("ngIf",1==t.filters.order.order)}}function si(t,e){1&t&&o.Kb(0,"app-feather-icons",41)}function ci(t,e){1&t&&o.Kb(0,"app-feather-icons",42)}function gi(t,e){if(1&t&&(o.Ob(0,"div",38),o.qc(1,si,1,0,"app-feather-icons",39),o.qc(2,ci,1,0,"app-feather-icons",40),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngIf",-1==t.filters.order.order),o.xb(1),o.cc("ngIf",1==t.filters.order.order)}}function li(t,e){1&t&&o.Kb(0,"app-feather-icons",41)}function bi(t,e){1&t&&o.Kb(0,"app-feather-icons",42)}function di(t,e){if(1&t&&(o.Ob(0,"div",38),o.qc(1,li,1,0,"app-feather-icons",39),o.qc(2,bi,1,0,"app-feather-icons",40),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngIf",-1==t.filters.order.order),o.xb(1),o.cc("ngIf",1==t.filters.order.order)}}function ui(t,e){1&t&&o.Kb(0,"app-feather-icons",41)}function hi(t,e){1&t&&o.Kb(0,"app-feather-icons",42)}function pi(t,e){if(1&t&&(o.Ob(0,"div",38),o.qc(1,ui,1,0,"app-feather-icons",39),o.qc(2,hi,1,0,"app-feather-icons",40),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngIf",-1==t.filters.order.order),o.xb(1),o.cc("ngIf",1==t.filters.order.order)}}function mi(t,e){1&t&&o.Kb(0,"app-feather-icons",41)}function fi(t,e){1&t&&o.Kb(0,"app-feather-icons",42)}function Oi(t,e){if(1&t&&(o.Ob(0,"div",38),o.qc(1,mi,1,0,"app-feather-icons",39),o.qc(2,fi,1,0,"app-feather-icons",40),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngIf",-1==t.filters.order.order),o.xb(1),o.cc("ngIf",1==t.filters.order.order)}}function vi(t,e){1&t&&o.Kb(0,"app-feather-icons",41)}function xi(t,e){1&t&&o.Kb(0,"app-feather-icons",42)}function Pi(t,e){if(1&t&&(o.Ob(0,"div",38),o.qc(1,vi,1,0,"app-feather-icons",39),o.qc(2,xi,1,0,"app-feather-icons",40),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngIf",-1==t.filters.order.order),o.xb(1),o.cc("ngIf",1==t.filters.order.order)}}const Ci=function(t){return["/venta",t]},Mi=function(t,e){return{"badge-warning":t,"badge-success":e}};function Ni(t,e){if(1&t&&(o.Ob(0,"tr"),o.Ob(1,"td"),o.Ob(2,"a",43),o.rc(3),o.Nb(),o.Nb(),o.Ob(4,"td"),o.rc(5),o.Zb(6,"date"),o.Nb(),o.Ob(7,"td"),o.rc(8),o.Zb(9,"number"),o.Nb(),o.Ob(10,"td"),o.rc(11),o.Nb(),o.Ob(12,"td"),o.rc(13),o.Zb(14,"paymentMethod"),o.Nb(),o.Ob(15,"td"),o.Ob(16,"span",44),o.rc(17),o.Nb(),o.Nb(),o.Nb()),2&t){const t=e.$implicit;o.xb(2),o.cc("routerLink",o.fc(16,Ci,t._id)),o.xb(1),o.sc(t.orderId),o.xb(2),o.sc(o.bc(6,8,t.paymentDate,"dd/MM/y")),o.xb(3),o.tc("$",o.bc(9,11,t.totalAmount,"1.2-2"),""),o.xb(3),o.sc(t.userData?t.userData.username:t.userEmail),o.xb(2),o.sc(o.ac(14,14,t.paymentMethod)),o.xb(3),o.cc("ngClass",o.gc(18,Mi,"pending"==t.status,"completed"==t.status)),o.xb(1),o.tc(" ","pending"==t.status?"Pendiente":"Completada"," ")}}function yi(t,e){if(1&t&&(o.Ob(0,"div",22),o.Ob(1,"div",23),o.Ob(2,"div",24),o.Ob(3,"h3"),o.rc(4,"Informaci\xf3n usuario"),o.Nb(),o.Nb(),o.Ob(5,"div",25),o.Ob(6,"div",26),o.Ob(7,"p"),o.Ob(8,"span",27),o.rc(9,"Nombre:"),o.Nb(),o.rc(10),o.Nb(),o.Ob(11,"p"),o.Ob(12,"span",27),o.rc(13,"Nombre usuario:"),o.Nb(),o.rc(14),o.Nb(),o.Ob(15,"p"),o.Ob(16,"span",27),o.rc(17,"Email:"),o.Nb(),o.rc(18),o.Nb(),o.Ob(19,"p"),o.Ob(20,"span",27),o.rc(21,"Observaciones:"),o.Nb(),o.rc(22),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&t){const t=o.Yb(2);o.xb(10),o.tc(" ",t.order.userData.name,""),o.xb(4),o.tc(" ",t.order.userData.username,""),o.xb(4),o.tc(" ",t.order.userData.email,""),o.xb(4),o.tc(" ",t.order.userData.observation?t.order.userData.observation:"Ninguna","")}}function _i(t,e){if(1&t){const t=o.Pb();o.Ob(0,"button",28),o.Vb("click",function(){return o.kc(t),o.Yb(2).updateOrder()}),o.Kb(1,"app-feather-icons",29),o.rc(2," Devolver a Caja "),o.Nb()}2&t&&(o.xb(1),o.cc("icon","refresh-cw"))}function Ii(t,e){if(1&t&&(o.Ob(0,"tr"),o.Ob(1,"td"),o.rc(2),o.Nb(),o.Ob(3,"td"),o.rc(4),o.Nb(),o.Ob(5,"td"),o.rc(6),o.Nb(),o.Ob(7,"td"),o.rc(8),o.Nb(),o.Nb()),2&t){const t=o.Yb(2);o.xb(2),o.tc("$",t.originalImgsPrice,""),o.xb(2),o.sc(t.couponDiscount.percentage>0?"$"+t.couponDiscount.discountAmount/t.originalImgsAmount:"N/A"),o.xb(2),o.sc(t.imagesAmountDiscountPerImage>0?"$"+t.imagesAmountDiscountPerImage:"N/A"),o.xb(2),o.tc("$",t.totalPerImage,"")}}function Si(t,e){if(1&t&&(o.Ob(0,"tr"),o.Ob(1,"td",15),o.Ob(2,"strong"),o.rc(3,"Descuento por cantidad"),o.Nb(),o.Nb(),o.Ob(4,"td",30),o.rc(5),o.Nb(),o.Nb()),2&t){const t=o.Yb(2);o.xb(5),o.tc(" -$",t.imagesAmountDiscountPerImage*t.order.images.length," ")}}function wi(t,e){if(1&t&&(o.Ob(0,"tr"),o.Ob(1,"td",15),o.Ob(2,"strong"),o.rc(3,"Descuento por cup\xf3n"),o.Nb(),o.Nb(),o.Ob(4,"td",30),o.rc(5),o.Nb(),o.Nb()),2&t){const t=o.Yb(2);o.xb(5),o.tc(" -$",t.couponDiscount.discountAmount," ")}}function ki(t,e){if(1&t&&(o.Ob(0,"span",40),o.rc(1),o.Nb()),2&t){const t=e.$implicit;o.xb(1),o.tc(" ",t," ")}}function Di(t,e){if(1&t&&(o.Ob(0,"div",38),o.qc(1,ki,2,1,"span",39),o.Nb()),2&t){const t=o.Yb().$implicit;o.xb(1),o.cc("ngForOf",t.tags)}}function Fi(t,e){if(1&t&&(o.Ob(0,"div",37),o.Ob(1,"span",27),o.rc(2,"Fot\xf3grafo:"),o.Nb(),o.rc(3),o.Nb()),2&t){const t=o.Yb().$implicit;o.xb(3),o.tc(" ",t.photographerId," ")}}const Ti=function(t){return{"img-vertical":t}};function Ai(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",31),o.Vb("click",function(){o.kc(t);const i=e.$implicit;return o.Yb(2).goToImage(i._id)}),o.Ob(1,"div",32),o.Kb(2,"img",33),o.Nb(),o.qc(3,Di,2,1,"div",34),o.Ob(4,"div",35),o.qc(5,Fi,4,1,"div",36),o.Ob(6,"div",37),o.Ob(7,"span",27),o.rc(8,"Fecha creaci\xf3n:"),o.Nb(),o.rc(9),o.Zb(10,"date"),o.Nb(),o.Ob(11,"div",37),o.Ob(12,"span",27),o.rc(13,"Fecha subida:"),o.Nb(),o.rc(14),o.Zb(15,"date"),o.Nb(),o.Nb(),o.Nb()}if(2&t){const t=e.$implicit,i=o.Yb(2);o.xb(1),o.cc("ngClass",o.fc(12,Ti,t.exifData.Orientation>=5)),o.xb(1),o.cc("src",t.fullpath,o.mc),o.xb(1),o.cc("ngIf",t.tags.length>0),o.xb(2),o.cc("ngIf","ADMIN_ROLE"==i.authService.user.role),o.xb(4),o.tc(" ",o.bc(10,6,t.creationDate,"dd/MM/yyyy HH:mm:ss")," "),o.xb(5),o.tc(" ",o.bc(15,9,t.uploadDate,"dd/MM/yyyy HH:mm:ss")," ")}}function Ei(t,e){if(1&t&&(o.Ob(0,"div",4),o.Ob(1,"div",5),o.Ob(2,"div",6),o.Ob(3,"h2"),o.rc(4),o.Nb(),o.Kb(5,"hr"),o.Nb(),o.Nb(),o.qc(6,yi,23,4,"div",7),o.Ob(7,"div",8),o.qc(8,_i,3,1,"button",9),o.Kb(9,"br"),o.Nb(),o.Ob(10,"div",10),o.Ob(11,"div",11),o.Ob(12,"h3"),o.rc(13,"Desglose del pedido"),o.Nb(),o.Nb(),o.Ob(14,"table",12),o.Ob(15,"thead"),o.Ob(16,"tr"),o.Ob(17,"th"),o.rc(18,"Subtotal (precio imagen)"),o.Nb(),o.Ob(19,"th"),o.rc(20,"Desc. por cup\xf3n"),o.Nb(),o.Ob(21,"th"),o.rc(22,"Desc. por cantidad"),o.Nb(),o.Ob(23,"th"),o.rc(24,"Total x img."),o.Nb(),o.Nb(),o.Nb(),o.Ob(25,"tbody"),o.qc(26,Ii,9,4,"tr",13),o.Ob(27,"tr",14),o.Ob(28,"td",15),o.Ob(29,"strong"),o.rc(30,"Subtotal"),o.Nb(),o.Nb(),o.Ob(31,"td"),o.rc(32),o.Nb(),o.Nb(),o.qc(33,Si,6,1,"tr",16),o.qc(34,wi,6,1,"tr",16),o.Ob(35,"tr",17),o.Ob(36,"td",15),o.Ob(37,"strong"),o.rc(38,"Total"),o.Nb(),o.Nb(),o.Ob(39,"td"),o.Ob(40,"strong"),o.rc(41),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(42,"div",18),o.Ob(43,"div",19),o.Ob(44,"h3"),o.rc(45,"Imagenes adquiridas"),o.Nb(),o.Nb(),o.Ob(46,"div",20),o.qc(47,Ai,16,14,"div",21),o.Nb(),o.Nb(),o.Nb()),2&t){const t=o.Yb();o.xb(4),o.tc("Pedido N\xb0 ",t.order.orderId,""),o.xb(2),o.cc("ngIf","ADMIN_ROLE"==t.authService.user.role),o.xb(2),o.cc("ngIf",t.devolvercaja),o.xb(18),o.cc("ngForOf",t.order.images),o.xb(6),o.tc("$",t.subtotal,""),o.xb(1),o.cc("ngIf",(null==t.imagesAmountDiscount?null:t.imagesAmountDiscount.discountAmount)&&t.imagesAmountDiscount.discountAmount>0),o.xb(1),o.cc("ngIf",(null==t.couponDiscount?null:t.couponDiscount.discountAmount)&&t.couponDiscount.discountAmount>0),o.xb(7),o.tc("$",t.total,""),o.xb(6),o.cc("ngForOf",t.order.images)}}function qi(t,e){if(1&t){const t=o.Pb();o.Ob(0,"tr"),o.Ob(1,"td"),o.rc(2),o.Nb(),o.Ob(3,"td"),o.rc(4),o.Nb(),o.Ob(5,"button",28),o.Vb("click",function(){o.kc(t);const i=e.$implicit;return o.Yb(2).RemoveItemDetail(i)}),o.Kb(6,"app-feather-icons",18),o.rc(7," Eliminar "),o.Nb(),o.Nb()}if(2&t){const t=o.Yb(2);o.xb(2),o.tc("$",t.originalImgsPrice,""),o.xb(2),o.tc("$",t.totalPerImage,""),o.xb(2),o.cc("icon","trash")}}function Yi(t,e){if(1&t&&(o.Ob(0,"tr"),o.Ob(1,"td",22),o.Ob(2,"strong"),o.rc(3,"Descuento por cantidad"),o.Nb(),o.Nb(),o.Ob(4,"td",29),o.rc(5),o.Nb(),o.Nb()),2&t){const t=o.Yb(2);o.xb(5),o.tc(" -$",t.imagesAmountDiscountPerImage*t.order.images.length," ")}}function Ri(t,e){if(1&t&&(o.Ob(0,"tr"),o.Ob(1,"td",22),o.Ob(2,"strong"),o.rc(3,"Descuento por cup\xf3n"),o.Nb(),o.Nb(),o.Ob(4,"td",29),o.rc(5),o.Nb(),o.Nb()),2&t){const t=o.Yb(2);o.xb(5),o.tc(" -%",t.couponDiscount.discountAmount," ")}}function ji(t,e){if(1&t&&(o.Ob(0,"span",39),o.rc(1),o.Nb()),2&t){const t=e.$implicit;o.xb(1),o.tc(" ",t," ")}}function Li(t,e){if(1&t&&(o.Ob(0,"div",37),o.qc(1,ji,2,1,"span",38),o.Nb()),2&t){const t=o.Yb().$implicit;o.xb(1),o.cc("ngForOf",t.tags)}}function Vi(t,e){if(1&t&&(o.Ob(0,"div",36),o.Ob(1,"span",12),o.rc(2,"Fot\xf3grafo:"),o.Nb(),o.rc(3),o.Nb()),2&t){const t=o.Yb().$implicit;o.xb(3),o.tc(" ",t.photographerId," ")}}const Ji=function(t){return{"img-vertical":t}};function Ki(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",30),o.Vb("click",function(){o.kc(t);const i=e.$implicit;return o.Yb(2).goToImage(i._id)}),o.Ob(1,"div",31),o.Kb(2,"img",32),o.Nb(),o.qc(3,Li,2,1,"div",33),o.Ob(4,"div",34),o.qc(5,Vi,4,1,"div",35),o.Ob(6,"div",36),o.Ob(7,"span",12),o.rc(8,"Fecha creaci\xf3n:"),o.Nb(),o.rc(9),o.Zb(10,"date"),o.Nb(),o.Ob(11,"div",36),o.Ob(12,"span",12),o.rc(13,"Fecha subida:"),o.Nb(),o.rc(14),o.Zb(15,"date"),o.Nb(),o.Nb(),o.Nb()}if(2&t){const t=e.$implicit,i=o.Yb(2);o.xb(1),o.cc("ngClass",o.fc(12,Ji,t.exifData.Orientation>=5)),o.xb(1),o.cc("src",t.fullpath,o.mc),o.xb(1),o.cc("ngIf",t.tags.length>0),o.xb(2),o.cc("ngIf","ADMIN_ROLE"==i.authService.user.role),o.xb(4),o.tc(" ",o.bc(10,6,t.creationDate,"dd/MM/yyyy HH:mm:ss")," "),o.xb(5),o.tc(" ",o.bc(15,9,t.uploadDate,"dd/MM/yyyy HH:mm:ss")," ")}}function Ui(t,e){if(1&t){const t=o.Pb();o.Ob(0,"div",4),o.Ob(1,"div",5),o.Ob(2,"div",6),o.Ob(3,"h2"),o.rc(4),o.Nb(),o.Kb(5,"hr"),o.Nb(),o.Nb(),o.Ob(6,"div",7),o.Ob(7,"div",8),o.Ob(8,"div",9),o.Ob(9,"h3"),o.rc(10,"Informaci\xf3n usuario"),o.Nb(),o.Nb(),o.Ob(11,"div",10),o.Ob(12,"div",11),o.Ob(13,"p"),o.Ob(14,"span",12),o.rc(15,"Nombre:"),o.Nb(),o.rc(16),o.Nb(),o.Ob(17,"p"),o.Ob(18,"span",12),o.rc(19,"Nombre usuario:"),o.Nb(),o.rc(20),o.Nb(),o.Ob(21,"p"),o.Ob(22,"span",12),o.rc(23,"Email:"),o.Nb(),o.rc(24),o.Nb(),o.Ob(25,"p"),o.Ob(26,"span",12),o.rc(27,"Observaciones:"),o.Nb(),o.rc(28),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(29,"div",13),o.Ob(30,"h3"),o.rc(31,"Desglose del pedido"),o.Nb(),o.Ob(32,"table"),o.Ob(33,"tr"),o.Ob(34,"th"),o.Ob(35,"label"),o.rc(36,"Descuento Total"),o.Nb(),o.Nb(),o.Nb(),o.Ob(37,"tr"),o.Ob(38,"td"),o.Ob(39,"input",14),o.Vb("ngModelChange",function(e){return o.kc(t),o.Yb().discuountotal=e}),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(40,"div",15),o.Ob(41,"div",16),o.Ob(42,"button",17),o.Vb("click",function(){return o.kc(t),o.Yb().Recalculate()}),o.Kb(43,"app-feather-icons",18),o.rc(44," Recalcular "),o.Nb(),o.Nb(),o.Nb(),o.Ob(45,"table",19),o.Ob(46,"thead"),o.Ob(47,"tr"),o.Ob(48,"th"),o.rc(49,"Subtotal (precio imagen)"),o.Nb(),o.Ob(50,"th"),o.rc(51,"Total x img."),o.Nb(),o.Ob(52,"th"),o.rc(53,"Eliminar?"),o.Nb(),o.Nb(),o.Nb(),o.Ob(54,"tbody"),o.qc(55,qi,8,3,"tr",20),o.Ob(56,"tr",21),o.Ob(57,"td",22),o.Ob(58,"strong"),o.rc(59,"Subtotal"),o.Nb(),o.Nb(),o.Ob(60,"td"),o.rc(61),o.Nb(),o.Nb(),o.qc(62,Yi,6,1,"tr",23),o.qc(63,Ri,6,1,"tr",23),o.Ob(64,"tr",24),o.Ob(65,"td",22),o.Ob(66,"strong"),o.rc(67,"Total"),o.Nb(),o.Nb(),o.Ob(68,"td"),o.Ob(69,"strong"),o.rc(70),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(71,"div",15),o.Ob(72,"div",16),o.Ob(73,"h3"),o.rc(74,"Imagenes adquiridas"),o.Nb(),o.Nb(),o.Ob(75,"div",25),o.qc(76,Ki,16,14,"div",26),o.Nb(),o.Nb(),o.Ob(77,"div",15),o.Ob(78,"div",16),o.Ob(79,"button",17),o.Vb("click",function(){return o.kc(t),o.Yb().updateOrder()}),o.Kb(80,"app-feather-icons",18),o.rc(81," Guardar Cambios "),o.Nb(),o.Kb(82,"br"),o.Kb(83,"br"),o.Ob(84,"button",27),o.Vb("click",function(){return o.kc(t),o.Yb().volver()}),o.rc(85," Volver "),o.Nb(),o.Nb(),o.Nb(),o.Nb()}if(2&t){const t=o.Yb();o.xb(4),o.tc("Pedido N\xb0 ",t.order.orderId,""),o.xb(12),o.tc(" ",t.order.userData.name,""),o.xb(4),o.tc(" ",t.order.userData.username,""),o.xb(4),o.tc(" ",t.order.userData.email,""),o.xb(4),o.tc(" ",t.order.userData.observation?t.order.userData.observation:"Ninguna",""),o.xb(11),o.cc("ngModel",t.discuountotal),o.xb(4),o.cc("icon","refresh-cw"),o.xb(12),o.cc("ngForOf",t.order.images),o.xb(6),o.tc("$",t.subtotal,""),o.xb(1),o.cc("ngIf",(null==t.imagesAmountDiscount?null:t.imagesAmountDiscount.discountAmount)&&t.imagesAmountDiscount.discountAmount>0),o.xb(1),o.cc("ngIf",(null==t.couponDiscount?null:t.couponDiscount.discountAmount)&&t.couponDiscount.discountAmount>0),o.xb(7),o.tc("$",t.total,""),o.xb(6),o.cc("ngForOf",t.order.images),o.xb(4),o.cc("icon","save")}}function Bi(t,e){1&t&&(o.Ob(0,"div",7),o.Ob(1,"div",8),o.Kb(2,"i",9),o.Nb(),o.Ob(3,"h2"),o.rc(4,'El pago se encuentra en estado "pendiente", el tiempo de acreditaci\xf3n podr\xeda variar seg\xfan el m\xe9todo elegido'),o.Nb(),o.Nb())}function Hi(t,e){1&t&&(o.Ob(0,"div",10),o.Ob(1,"div",8),o.Kb(2,"i",11),o.Nb(),o.Ob(3,"h2"),o.rc(4,"El pago ha sido rechazado"),o.Nb(),o.Nb())}function $i(t,e){1&t&&(o.Ob(0,"div",7),o.Ob(1,"div",8),o.Kb(2,"i",12),o.Nb(),o.Ob(3,"h2"),o.rc(4,"Compra realizada con \xe9xito!"),o.Nb(),o.Nb())}function Gi(t,e){if(1&t&&(o.Ob(0,"div",2),o.qc(1,Bi,5,0,"div",3),o.qc(2,Hi,5,0,"div",4),o.qc(3,$i,5,0,"div",3),o.Ob(4,"div",5),o.Ob(5,"a",6),o.rc(6," Volver al inicio "),o.Nb(),o.Nb(),o.Nb()),2&t){const t=o.Yb();o.xb(1),o.cc("ngIf","pending"==t.status),o.xb(1),o.cc("ngIf","failure"==t.status||"rejected"==t.status),o.xb(1),o.cc("ngIf","success"==t.status)}}function zi(t,e){1&t&&(o.Ob(0,"div",13),o.Kb(1,"i",14),o.Nb())}const Zi=[{path:"",component:h,children:[{path:"",component:Ct},{path:"favoritos",component:Ct},{path:"mis-imagenes",component:Ct},{path:"mis-datos",component:yt},{path:"imagenes",component:Ht},{path:"imagenes/new",component:ce},{path:"producto/:productId",component:_e},{path:"carrito",component:be},{path:"caja",component:Xe},{path:"checkout",component:Re},{path:"ventas",component:(()=>{class t{constructor(t,e,i,n){this.authService=t,this.router=e,this.ordersService=i,this.paginationService=n,this.isPhotographer=!1,this.filters={date:{from:null,to:null},orderId:"",status:"completed",email:"",order:{by:"",order:1}},this.datePickerConfig={locale:"es"},this.orders=[],"ADMIN_ROLE"!==this.authService.user.role&&"PHOTOGRAPHER_ROLE"!==this.authService.user.role&&this.router.navigate(["/"]),"PHOTOGRAPHER_ROLE"==this.authService.user.role&&(this.isPhotographer=!0),this.paginationService.pageChanged.subscribe(t=>{this.getOrders(!0)}),this.getOrders()}ngOnInit(){}getOrders(t=!1){t||this.paginationService.resetPagination();const e=this.filters;this.filters.date.from&&e.date.from.startOf("day").toDate(),this.filters.date.to&&e.date.to.endOf("day").toDate(),this.ordersService.getOrders(e).subscribe(t=>{this.orders=t.orders,this.scrollToTop(),this.calculateTotals()})}orderBy(t){this.filters.order.by==t&&(this.filters.order.order=1==this.filters.order.order?-1:1),this.filters.order.by=t,this.getOrders()}calculateTotals(){this.orders.forEach(t=>{const e=t.images.length;t.images=this.getOwnedImages(t),t.totalAmount=t.subtotal/e*t.images.length,t.discounts.forEach(i=>{"imagesAmount"==i.type?t.totalAmount-=i.discountAmount/e*t.images.length:t.totalAmount=t.totalAmount*(1-i.percentage/100)})})}getOwnedImages(t){const e=this.authService.user,i=[],n=t.images;for(let r=0;r<n.length;r++){const t=n[r];t.photographerId!=e.email&&t.photographerId!=e.username&&"ADMIN_ROLE"!=e.role||i.push(t)}return i}scrollToTop(){window.scrollTo(0,0)}resetFilters(){this.filters={date:{from:null,to:null},status:"",email:"",orderId:"",order:{by:"",order:1}},this.getOrders()}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(v.a),o.Jb(s.f),o.Jb(Qe),o.Jb(x.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-orders"]],decls:58,vars:14,consts:[[1,"container-fluid","orders-list"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"card-body","custom-datatable"],[1,"filters","pb-3"],[1,"row","filters-options"],[1,"col-12","col-lg-6"],[1,"picker","w-100"],[2,"margin-right","10px"],["name","dateFrom","placeholder","Fecha desde",3,"ngModel","config","ngModelChange"],["name","dateTo","placeholder","Fecha hasta",3,"ngModel","config","ngModelChange"],["class","col-12 col-lg-6",4,"ngIf"],[1,"col-12","col-sm-6"],["class","form-group mt-2",4,"ngIf"],[1,"filter-btn","mb-3","d-flex","justify-content-end"],[1,"btn","btn-secondary","w-100","mr-2","minify-feather",2,"max-width","200px",3,"click"],["icon","search"],[1,"btn","btn-danger","reset-btn",3,"click"],["icon","x"],[1,"orders"],[1,"table-responsive"],[1,"table","table-striped"],["scope","col",1,"sort",3,"click"],["class","normal-sort",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"form-group"],["for","filterStatus"],["name","statusFilter","type","text","id","filterStatus",1,"form-control","mb-0","w-100",3,"ngModel","ngModelChange"],["value",""],["value","pending"],["value","completed"],[1,"form-group","mt-2"],["for","filterEmail"],["name","emailFilter","type","text","id","filterEmail","placeholder","Filtrar por usuario",1,"form-control","mb-0","w-100",3,"ngModel","ngModelChange","keyup.enter"],["for","filterOrderId"],["name","orderIdFilter","type","text","id","filterOrderId","placeholder","Filtrar por pedido",1,"form-control","mb-0","w-100",3,"ngModel","ngModelChange","keyup.enter"],[1,"normal-sort"],["icon","chevron-up",4,"ngIf"],["icon","chevron-down",4,"ngIf"],["icon","chevron-up"],["icon","chevron-down"],[3,"routerLink"],[1,"badge","badge-pill",3,"ngClass"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"div",3),o.Ob(4,"div",4),o.Ob(5,"h5"),o.rc(6,"Imagenes cargadas"),o.Nb(),o.Nb(),o.Ob(7,"div",5),o.Ob(8,"div",6),o.Ob(9,"div",7),o.Ob(10,"div",8),o.Ob(11,"div",9),o.Ob(12,"label",10),o.rc(13,"Desde:"),o.Nb(),o.Ob(14,"dp-date-picker",11),o.Vb("ngModelChange",function(t){return e.filters.date.from=t}),o.Nb(),o.Nb(),o.Ob(15,"div",9),o.Ob(16,"label",10),o.rc(17,"Hasta:"),o.Nb(),o.Ob(18,"dp-date-picker",12),o.Vb("ngModelChange",function(t){return e.filters.date.to=t}),o.Nb(),o.Nb(),o.Nb(),o.qc(19,ei,11,1,"div",13),o.Nb(),o.Ob(20,"div",1),o.Ob(21,"div",14),o.qc(22,ii,4,1,"div",15),o.Nb(),o.Ob(23,"div",14),o.qc(24,ni,4,1,"div",15),o.Nb(),o.Nb(),o.Ob(25,"div",16),o.Ob(26,"button",17),o.Vb("click",function(){return e.getOrders()}),o.Kb(27,"app-feather-icons",18),o.rc(28," Filtrar "),o.Nb(),o.Ob(29,"button",19),o.Vb("click",function(){return e.resetFilters()}),o.Kb(30,"app-feather-icons",20),o.Nb(),o.Nb(),o.Nb(),o.Kb(31,"hr"),o.Ob(32,"div",21),o.Ob(33,"div",22),o.Ob(34,"table",23),o.Ob(35,"thead"),o.Ob(36,"tr"),o.Ob(37,"th",24),o.Vb("click",function(){return e.orderBy("orderId")}),o.rc(38," N\xb0 Pedido "),o.qc(39,oi,3,2,"div",25),o.Nb(),o.Ob(40,"th",24),o.Vb("click",function(){return e.orderBy("orderDate")}),o.rc(41," Fecha creaci\xf3n "),o.qc(42,gi,3,2,"div",25),o.Nb(),o.Ob(43,"th",24),o.Vb("click",function(){return e.orderBy("totalAmount")}),o.rc(44," Importe "),o.qc(45,di,3,2,"div",25),o.Nb(),o.Ob(46,"th",24),o.Vb("click",function(){return e.orderBy("userData.username")}),o.rc(47," Usuario "),o.qc(48,pi,3,2,"div",25),o.Nb(),o.Ob(49,"th",24),o.Vb("click",function(){return e.orderBy("paymentMethod")}),o.rc(50," M\xe9todo de pago "),o.qc(51,Oi,3,2,"div",25),o.Nb(),o.Ob(52,"th",24),o.Vb("click",function(){return e.orderBy("status")}),o.rc(53," Estado "),o.qc(54,Pi,3,2,"div",25),o.Nb(),o.Nb(),o.Nb(),o.Ob(55,"tbody"),o.qc(56,Ni,18,21,"tr",26),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Kb(57,"app-pagination"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&t&&(o.xb(14),o.cc("ngModel",e.filters.date.from)("config",e.datePickerConfig),o.xb(4),o.cc("ngModel",e.filters.date.to)("config",e.datePickerConfig),o.xb(1),o.cc("ngIf","ADMIN_ROLE"==e.authService.user.role),o.xb(3),o.cc("ngIf","ADMIN_ROLE"==e.authService.user.role),o.xb(2),o.cc("ngIf","ADMIN_ROLE"==e.authService.user.role),o.xb(15),o.cc("ngIf","orderId"==e.filters.order.by),o.xb(3),o.cc("ngIf","paymentDate"==e.filters.order.by),o.xb(3),o.cc("ngIf","totalAmount"==e.filters.order.by),o.xb(3),o.cc("ngIf","userData.username"==e.filters.order.by),o.xb(3),o.cc("ngIf","paymentMethod"==e.filters.order.by),o.xb(3),o.cc("ngIf","status"==e.filters.order.by),o.xb(2),o.cc("ngForOf",e.orders))},directives:[D.a,S.i,S.k,n.m,k.a,n.l,w.a,S.p,S.l,S.r,S.a,s.i,n.k],pipes:[n.e,n.f,ti],styles:[""]}),t})()},{path:"venta/:orderId",component:(()=>{class t{constructor(t,e,i,n,r){this.ordersService=t,this.route=e,this.router=i,this.authService=n,this.backToService=r,this.devolvercaja=!1,this.imagesAmountDiscount=null,this.imagesAmountDiscountPerImage=0,this.couponDiscount={percentage:0},this.originalImgsPrice=null,this.originalImgsAmount=0,this.totalPerImage=null,this.subtotal=0,this.total=0,this.backToService.backTo="/imagenes",this.route.params.subscribe(t=>{t.orderId||this.router.navigate(["/"]),this.orderId=t.orderId}),this.getOrder()}ngOnInit(){}calculateDiff(t){let e=new Date(t),i=new Date;return Math.floor((Date.UTC(i.getFullYear(),i.getMonth(),i.getDate())-Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))/864e5)}updateOrder(){this.order.status="pending",this.ordersService.updateOrder(this.order).subscribe(t=>{this.router.navigate(["/ventas"])})}getOrder(){this.ordersService.getOrder(this.orderId).subscribe(t=>{this.order=t.order,this.originalImgsAmount=t.originalImgsAmount,this.originalImgsPrice=this.order.subtotal/t.originalImgsAmount,this.totalPerImage=this.originalImgsPrice,this.calculateTotal(),this.order.images.forEach(t=>{t.fullpath=t.copyFileName}),this.devolvercaja=this.calculateDiff(this.order.orderDate)<=7})}goToImage(t){this.backToService.backTo=this.router.url,this.router.navigate(["/producto",t])}calculateTotal(){this.subtotal=this.originalImgsPrice*this.order.images.length,this.total=this.originalImgsPrice*this.order.images.length,this.order.discounts.forEach(t=>{const e=t.discountAmount/this.originalImgsAmount;"imagesAmount"==t.type?(this.imagesAmountDiscount=t,this.imagesAmountDiscountPerImage=e.toFixed(2),this.totalPerImage-=e,this.total-=e*this.order.images.length):(this.couponDiscount=t,this.totalPerImage-=e,this.total=this.total*(1-t.percentage/100))})}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(Qe),o.Jb(s.a),o.Jb(s.f),o.Jb(v.a),o.Jb(de))},t.\u0275cmp=o.Db({type:t,selectors:[["app-order-detail"]],decls:4,vars:1,consts:[[1,"container-fluid"],[1,"card"],[1,"card-body"],["class","row product-page-main",4,"ngIf"],[1,"row","product-page-main"],[1,"col-12"],[1,"title","mb-4","text-center"],["class","col-12 mt-4",4,"ngIf"],[1,"col-12",2,"margin-bottom","20px"],["class","btn btn-success minify-feather mb-1",3,"click",4,"ngIf"],[1,"col-12","desglose"],[1,"sub-title"],[1,"table"],[4,"ngFor","ngForOf"],[1,"subtotal"],["colspan","3",2,"text-align","right"],[4,"ngIf"],[1,"total"],[1,"col-12","mt-4","images-list"],[1,"sub-title","mt-4","mb-4"],[1,"images","mt-4"],["class","image",3,"click",4,"ngFor","ngForOf"],[1,"col-12","mt-4"],[1,"user-info","mt-4","mb-4"],[1,"sub-title","mb-4"],[1,"info"],[1,"info-row"],[1,"bold"],[1,"btn","btn-success","minify-feather","mb-1",3,"click"],[3,"icon"],[2,"position","relative","left","-5px"],[1,"image",3,"click"],[1,"thumbnail","image-owned",3,"ngClass"],["alt","",3,"src"],["class","tag-list mt-2",4,"ngIf"],[1,"image-info","mt-3"],["class","creation-date",4,"ngIf"],[1,"creation-date"],[1,"tag-list","mt-2"],["class","badge badge-pill badge-secondary",4,"ngFor","ngForOf"],[1,"badge","badge-pill","badge-secondary"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.qc(3,Ei,48,9,"div",3),o.Nb(),o.Nb(),o.Nb()),2&t&&(o.xb(3),o.cc("ngIf",e.order))},directives:[n.m,n.l,k.a,n.k],pipes:[n.e],styles:[".images-list[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%]{align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]{display:flex;align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.checkbox-label[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:0;margin-right:15px}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.switch[_ngcontent-%COMP%]{margin:0}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{display:flex!important;justify-content:flex-end}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]   .reset-btn[_ngcontent-%COMP%]{margin-left:8px;padding:5px 5px 0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;margin-top:40px;margin-bottom:10px;margin-right:0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--theme-secondary);margin-bottom:0;margin-right:10px;font-size:16px}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:var(--theme-secondary);border:1px solid var(--theme-secondary);padding:10px;border-radius:3px;cursor:pointer}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:24%;margin-left:1%;padding:10px;border-radius:5px;background:#ecf3fa;box-shadow:1px 1px 3px grey;cursor:pointer;margin-bottom:15px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:hover{transition:all .2s ease;box-shadow:2px 2px 5px grey}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{width:100%;height:190px;overflow:hidden;display:flex;align-items:center;justify-content:center}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#8f9aa5!important}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;margin-top:10px;padding:10px 0}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .whole[_ngcontent-%COMP%]{width:100%;margin-top:10px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px;width:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image.selected[_ngcontent-%COMP%]{background:#ffcc01;box-shadow:2px 2px 5px grey}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{height:unset!important}.image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto!important;height:100%!important;vertical-align:top}.image[_ngcontent-%COMP%]   .image-owned.img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px!important;width:auto!important}@media screen and (max-width:1600px){.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}}@media screen and (max-width:1500px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:32%!important}}@media screen and (max-width:1200px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}}@media screen and (max-width:992px){.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{flex-direction:column}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:15px}}@media screen and (max-width:768px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center}}@media screen and (max-width:400px){.images-list[_ngcontent-%COMP%]   .picker[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px!important}.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.375rem 0!important;width:48%}}",""]}),t})()},{path:"caja/:orderId",component:(()=>{class t{constructor(t,e,i,n,r){this.ordersService=t,this.route=e,this.router=i,this.authService=n,this.backToService=r,this.discuountotal=0,this.imagesAmountDiscountPerImagePercentaje=0,this.imagesAmountDiscount=null,this.imagesAmountDiscountPerImage=0,this.couponDiscount={percentage:0},this.originalImgsPrice=null,this.originalImgsAmount=0,this.totalPerImage=null,this.subtotal=0,this.total=0,this.backToService.backTo="/imagenes",this.route.params.subscribe(t=>{t.orderId||this.router.navigate(["/"]),this.orderId=t.orderId}),this.getOrder()}ngOnInit(){}getOrder(){this.ordersService.getOrderCaja(this.orderId).subscribe(t=>{this.order=t.order,this.originalImgsAmount=t.originalImgsAmount,this.originalImgsPrice=this.order.subtotal/t.originalImgsAmount,this.totalPerImage=this.originalImgsPrice,this.calculateTotal(),this.order.images.forEach(t=>{t.fullpath=t.copyFileName})})}goToImage(t){this.backToService.backTo=this.router.url,this.router.navigate(["/producto",t])}RemoveItemDetail(t){this.order.images=this.order.images.filter(e=>e._id!==t._id),this.calculateTotal()}Recalculate(){this.order.discounts=[],this.order.discounts.push({discountAmount:this.discuountotal,title:"Descuento por im\xe1genes",type:"imagesAmount"}),this.RecalculateTotal()}updateOrder(){this.ordersService.updateOrder(this.order).subscribe(t=>{this.router.navigate(["/caja"])})}volver(){this.router.navigate(["/caja"])}calculateTotal(){this.subtotal=this.originalImgsPrice*this.order.images.length,this.total=this.originalImgsPrice*this.order.images.length,this.order.discounts.forEach(t=>{const e=t.discountAmount/this.originalImgsAmount;"imagesAmount"==t.type?(this.imagesAmountDiscount=t,this.imagesAmountDiscountPerImage=e.toFixed(2),this.totalPerImage-=e,this.total-=e*this.order.images.length):(this.couponDiscount=t,this.totalPerImage-=e,this.total=this.total*(1-t.percentage/100))})}RecalculateTotal(){this.couponDiscount={percentage:0},this.subtotal=this.originalImgsPrice*this.order.images.length,this.total=this.originalImgsPrice*this.order.images.length,this.order.discounts.forEach(t=>{"imagesAmount"==t.type&&(this.imagesAmountDiscount=t,this.imagesAmountDiscountPerImage=(this.discuountotal/this.order.images.length).toFixed(2),this.totalPerImage-=this.imagesAmountDiscountPerImage,this.total-=this.discuountotal)})}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(Qe),o.Jb(s.a),o.Jb(s.f),o.Jb(v.a),o.Jb(de))},t.\u0275cmp=o.Db({type:t,selectors:[["app-order-caja-detail"]],decls:4,vars:1,consts:[[1,"container-fluid"],[1,"card"],[1,"card-body"],["class","row product-page-main",4,"ngIf"],[1,"row","product-page-main"],[1,"col-12"],[1,"title","mb-4","text-center"],[1,"col-12","mt-4"],[1,"user-info","mt-4","mb-4"],[1,"sub-title","mb-4"],[1,"info"],[1,"info-row"],[1,"bold"],[1,"col-12","desglose"],["type","text","placeholder","Ejemplo: 500",1,"form-control",2,"max-width","180px",3,"ngModel","ngModelChange"],[1,"col-12","mt-4","images-list"],[1,"sub-title","mt-4","mb-4"],[1,"btn","btn-success","lg-col",3,"click"],[3,"icon"],[1,"table"],[4,"ngFor","ngForOf"],[1,"subtotal"],["colspan","2",2,"text-align","right"],[4,"ngIf"],[1,"total"],[1,"images","mt-4"],["class","image",3,"click",4,"ngFor","ngForOf"],[1,"btn","btn-secondary","lg-col",3,"click"],[1,"btn","btn-danger","mr-2",3,"click"],[2,"position","relative","left","-5px"],[1,"image",3,"click"],[1,"thumbnail","image-owned",3,"ngClass"],["alt","",3,"src"],["class","tag-list mt-2",4,"ngIf"],[1,"image-info","mt-3"],["class","creation-date",4,"ngIf"],[1,"creation-date"],[1,"tag-list","mt-2"],["class","badge badge-pill badge-secondary",4,"ngFor","ngForOf"],[1,"badge","badge-pill","badge-secondary"]],template:function(t,e){1&t&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.qc(3,Ui,86,14,"div",3),o.Nb(),o.Nb(),o.Nb()),2&t&&(o.xb(3),o.cc("ngIf",e.order))},directives:[n.m,S.a,S.i,S.k,k.a,n.l,n.k],pipes:[n.e],styles:[".images-list[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%]{align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]{display:flex;align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.checkbox-label[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:0;margin-right:15px}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.switch[_ngcontent-%COMP%]{margin:0}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{display:flex!important;justify-content:flex-end}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]   .reset-btn[_ngcontent-%COMP%]{margin-left:8px;padding:5px 5px 0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;margin-top:40px;margin-bottom:10px;margin-right:0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--theme-secondary);margin-bottom:0;margin-right:10px;font-size:16px}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:var(--theme-secondary);border:1px solid var(--theme-secondary);padding:10px;border-radius:3px;cursor:pointer}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:24%;margin-left:1%;padding:10px;border-radius:5px;background:#ecf3fa;box-shadow:1px 1px 3px grey;cursor:pointer;margin-bottom:15px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:hover{transition:all .2s ease;box-shadow:2px 2px 5px grey}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{width:100%;height:190px;overflow:hidden;display:flex;align-items:center;justify-content:center}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#8f9aa5!important}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;margin-top:10px;padding:10px 0}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .whole[_ngcontent-%COMP%]{width:100%;margin-top:10px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px;width:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image.selected[_ngcontent-%COMP%]{background:#ffcc01;box-shadow:2px 2px 5px grey}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{height:unset!important}.image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto!important;height:100%!important;vertical-align:top}.image[_ngcontent-%COMP%]   .image-owned.img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px!important;width:auto!important}@media screen and (max-width:1600px){.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}}@media screen and (max-width:1500px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:32%!important}}@media screen and (max-width:1200px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}}@media screen and (max-width:992px){.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{flex-direction:column}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:15px}}@media screen and (max-width:768px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center}}@media screen and (max-width:400px){.images-list[_ngcontent-%COMP%]   .picker[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px!important}.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.375rem 0!important;width:48%}}",""]}),t})()},{path:"mercadopago/payment/:status",component:(()=>{class t{constructor(t,e,i,n,r){this.route=t,this.router=e,this.cartService=i,this.ordersService=n,this.authService=r,this.ALLOWED_STATUS=["success","pending","failure","rejected"],this.status=null,this.loading=!1}ngOnInit(){this.loading=!0,this.getStatus()}getStatus(){this.route.params.subscribe(t=>{this.ALLOWED_STATUS.indexOf(t.status)<0?this.router.navigate(["/"]):(this.status=t.status,this.getQueryParams())})}getQueryParams(){this.route.queryParams.subscribe(t=>{"approved"==t.status?this.cartService.cleanCart().subscribe(e=>{this.cartService.cartUpdated.emit("updated"),this.setUserPurchases(t.external_reference)}):this.loading=!1})}setUserPurchases(t){this.ordersService.getClientOrder(t).subscribe(t=>{t.order.images.forEach(t=>{const e=this.authService.user;e.purchases.indexOf(t)<0&&e.purchases.push(t),this.authService.user=e,this.authService.refreshUser(),this.loading=!1})})}}return t.\u0275fac=function(e){return new(e||t)(o.Jb(s.a),o.Jb(s.f),o.Jb(M.a),o.Jb(Qe),o.Jb(v.a))},t.\u0275cmp=o.Db({type:t,selectors:[["app-payment-status"]],decls:2,vars:2,consts:[["class","payment-status",4,"ngIf"],["class","loading",4,"ngIf"],[1,"payment-status"],["class","success info-container",4,"ngIf"],["class","error info-container",4,"ngIf"],[1,"button-container","text-center"],["routerLink","/",1,"btn","btn-primary"],[1,"success","info-container"],[1,"icon-container"],[1,"fa","fa-exclamation",2,"color","orange"],[1,"error","info-container"],[1,"fa","fa-times",2,"color","red"],[1,"fa","fa-check",2,"color","green"],[1,"loading"],[1,"fa","fa-spinner","fa-spin"]],template:function(t,e){1&t&&(o.qc(0,Gi,7,3,"div",0),o.qc(1,zi,2,0,"div",1)),2&t&&(o.cc("ngIf",!e.loading),o.xb(1),o.cc("ngIf",e.loading))},directives:[n.m,s.i],styles:[".loading[_ngcontent-%COMP%]{width:100%;height:70vh;display:flex;justify-content:center;align-items:center}.loading[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--theme-deafult);font-size:10vh}.payment-status[_ngcontent-%COMP%] > div.info-container[_ngcontent-%COMP%]{width:100%;margin-top:20vh;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-bottom:4vh}.payment-status[_ngcontent-%COMP%] > div.info-container[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:10vh;margin-bottom:2vh}.payment-status[_ngcontent-%COMP%] > div.info-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center}"]}),t})()}]}];let Xi=(()=>{class t{}return t.\u0275mod=o.Hb({type:t}),t.\u0275inj=o.Gb({factory:function(e){return new(e||t)},imports:[[s.j.forChild(Zi)],s.j]}),t})();var Wi=i("PCNd"),Qi=i("O0x4");let tn=(()=>{class t{}return t.\u0275mod=o.Hb({type:t}),t.\u0275inj=o.Gb({factory:function(e){return new(e||t)},providers:[{provide:"Window",useValue:window}],imports:[[n.c,Xi,Wi.a,Qi.a]]}),t})()}}]);