(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{b0Xh:function(e,t,i){var a;(function(){var i=function(e){return e instanceof i?e:this instanceof i?void(this.EXIFwrapped=e):new i(e)};e.exports&&(t=e.exports=i),t.EXIF=i;var r=i.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},o=i.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},s=i.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},c=i.IFD1Tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},g=i.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function l(e){return!!e.exifdata}function b(e){var t=new DataView(e);if(255!=t.getUint8(0)||216!=t.getUint8(1))return!1;for(var i=2,n=e.byteLength;i<n;){if(255!=t.getUint8(i))return!1;if(225==t.getUint8(i+1))return f(t,i+4,t.getUint16(i+2));i+=2+t.getUint16(i+2)}}var d={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function h(e,t,i){for(var n,a,r,o,s=new DataView(e),c={},g=t;g<t+i;)28===s.getUint8(g)&&2===s.getUint8(g+1)&&(o=s.getUint8(g+2))in d&&(r=s.getInt16(g+3),a=d[o],n=p(s,g+5,r),c.hasOwnProperty(a)?c[a]instanceof Array?c[a].push(n):c[a]=[c[a],n]:c[a]=n),g++;return c}function u(e,t,i,n,a){var r,o,s=e.getUint16(i,!a),c={};for(o=0;o<s;o++)c[n[e.getUint16(r=i+12*o+2,!a)]]=m(e,r,t,0,a);return c}function m(e,t,i,n,a){var r,o,s,c,g,l,b=e.getUint16(t+2,!a),d=e.getUint32(t+4,!a),h=e.getUint32(t+8,!a)+i;switch(b){case 1:case 7:if(1==d)return e.getUint8(t+8,!a);for(r=d>4?h:t+8,o=[],c=0;c<d;c++)o[c]=e.getUint8(r+c);return o;case 2:return p(e,r=d>4?h:t+8,d-1);case 3:if(1==d)return e.getUint16(t+8,!a);for(r=d>2?h:t+8,o=[],c=0;c<d;c++)o[c]=e.getUint16(r+2*c,!a);return o;case 4:if(1==d)return e.getUint32(t+8,!a);for(o=[],c=0;c<d;c++)o[c]=e.getUint32(h+4*c,!a);return o;case 5:if(1==d)return g=e.getUint32(h,!a),l=e.getUint32(h+4,!a),(s=new Number(g/l)).numerator=g,s.denominator=l,s;for(o=[],c=0;c<d;c++)g=e.getUint32(h+8*c,!a),l=e.getUint32(h+4+8*c,!a),o[c]=new Number(g/l),o[c].numerator=g,o[c].denominator=l;return o;case 9:if(1==d)return e.getInt32(t+8,!a);for(o=[],c=0;c<d;c++)o[c]=e.getInt32(h+4*c,!a);return o;case 10:if(1==d)return e.getInt32(h,!a)/e.getInt32(h+4,!a);for(o=[],c=0;c<d;c++)o[c]=e.getInt32(h+8*c,!a)/e.getInt32(h+4+8*c,!a);return o}}function p(e,t,i){var a="";for(n=t;n<t+i;n++)a+=String.fromCharCode(e.getUint8(n));return a}function f(e,t){if("Exif"!=p(e,t,4))return!1;var i,n,a,l,b,d=t+6;if(18761==e.getUint16(d))i=!1;else{if(19789!=e.getUint16(d))return!1;i=!0}if(42!=e.getUint16(d+2,!i))return!1;var h=e.getUint32(d+4,!i);if(h<8)return!1;if((n=u(e,d,d+h,o,i)).ExifIFDPointer)for(a in l=u(e,d,d+n.ExifIFDPointer,r,i)){switch(a){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":l[a]=g[a][l[a]];break;case"ExifVersion":case"FlashpixVersion":l[a]=String.fromCharCode(l[a][0],l[a][1],l[a][2],l[a][3]);break;case"ComponentsConfiguration":l[a]=g.Components[l[a][0]]+g.Components[l[a][1]]+g.Components[l[a][2]]+g.Components[l[a][3]]}n[a]=l[a]}if(n.GPSInfoIFDPointer)for(a in b=u(e,d,d+n.GPSInfoIFDPointer,s,i)){switch(a){case"GPSVersionID":b[a]=b[a][0]+"."+b[a][1]+"."+b[a][2]+"."+b[a][3]}n[a]=b[a]}return n.thumbnail=function(e,t,i,n){var a=function(e,t,i){var n=e.getUint16(t,!i);return e.getUint32(t+2+12*n,!i)}(e,t+i,n);if(!a)return{};if(a>e.byteLength)return{};var r=u(e,t,t+a,c,n);if(r.Compression)switch(r.Compression){case 6:r.JpegIFOffset&&r.JpegIFByteCount&&(r.blob=new Blob([new Uint8Array(e.buffer,t+r.JpegIFOffset,r.JpegIFByteCount)],{type:"image/jpeg"}));break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",r.Compression)}else 2==r.PhotometricInterpretation&&console.log("Thumbnail image format is RGB, which is not implemented.");return r}(e,d,h,i),n}function O(e){var t={};if(1==e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var i=0;i<e.attributes.length;i++){var n=e.attributes.item(i);t["@attributes"][n.nodeName]=n.nodeValue}}}else if(3==e.nodeType)return e.nodeValue;if(e.hasChildNodes())for(var a=0;a<e.childNodes.length;a++){var r=e.childNodes.item(a),o=r.nodeName;if(null==t[o])t[o]=O(r);else{if(null==t[o].push){var s=t[o];t[o]=[],t[o].push(s)}t[o].push(O(r))}}return t}function v(e){try{var t={};if(e.children.length>0)for(var i=0;i<e.children.length;i++){var n=e.children.item(i),a=n.attributes;for(var r in a){var o=a[r],s=o.nodeName;void 0!==s&&(t[s]=o.nodeValue)}var c=n.nodeName;if(void 0===t[c])t[c]=O(n);else{if(void 0===t[c].push){var g=t[c];t[c]=[],t[c].push(g)}t[c].push(O(n))}}else t=e.textContent;return t}catch(l){console.log(l.message)}}i.enableXmp=function(){i.isXmpEnabled=!0},i.disableXmp=function(){i.isXmpEnabled=!1},i.getData=function(e,t){return!((self.Image&&e instanceof self.Image||self.HTMLImageElement&&e instanceof self.HTMLImageElement)&&!e.complete||(l(e)?t&&t.call(e):function(e,t){function n(n){var a=b(n);e.exifdata=a||{};var r=function(e){var t=new DataView(e);if(255!=t.getUint8(0)||216!=t.getUint8(1))return!1;for(var i=2,n=e.byteLength,a=function(e,t){return 56===e.getUint8(t)&&66===e.getUint8(t+1)&&73===e.getUint8(t+2)&&77===e.getUint8(t+3)&&4===e.getUint8(t+4)&&4===e.getUint8(t+5)};i<n;){if(a(t,i)){var r=t.getUint8(i+7);return r%2!=0&&(r+=1),0===r&&(r=4),h(e,i+8+r,t.getUint16(i+6+r))}i++}}(n);if(e.iptcdata=r||{},i.isXmpEnabled){var o=function(e){if("DOMParser"in self){var t=new DataView(e);if(255!=t.getUint8(0)||216!=t.getUint8(1))return!1;for(var i=2,n=e.byteLength,a=new DOMParser;i<n-4;){if("http"==p(t,i,4)){var r=i-1,o=t.getUint16(i-2)-1,s=p(t,r,o),c=s.indexOf("xmpmeta>")+8,g=(s=s.substring(s.indexOf("<x:xmpmeta"),c)).indexOf("x:xmpmeta")+10;return s=s.slice(0,g)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+s.slice(g),v(a.parseFromString(s,"text/xml"))}i++}}}(n);e.xmpdata=o||{}}t&&t.call(e)}if(e.src)if(/^data\:/i.test(e.src))n(function(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var i=atob(e),n=i.length,a=new ArrayBuffer(n),r=new Uint8Array(a),o=0;o<n;o++)r[o]=i.charCodeAt(o);return a}(e.src));else if(/^blob\:/i.test(e.src))(r=new FileReader).onload=function(e){n(e.target.result)},function(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(e){200!=this.status&&0!==this.status||r.readAsArrayBuffer(this.response)},i.send()}(e.src);else{var a=new XMLHttpRequest;a.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";n(a.response),a=null},a.open("GET",e.src,!0),a.responseType="arraybuffer",a.send(null)}else if(self.FileReader&&(e instanceof self.Blob||e instanceof self.File)){var r;(r=new FileReader).onload=function(e){n(e.target.result)},r.readAsArrayBuffer(e)}}(e,t),0))},i.getTag=function(e,t){if(l(e))return e.exifdata[t]},i.getIptcTag=function(e,t){if(l(e))return e.iptcdata[t]},i.getAllTags=function(e){if(!l(e))return{};var t,i=e.exifdata,n={};for(t in i)i.hasOwnProperty(t)&&(n[t]=i[t]);return n},i.getAllIptcTags=function(e){if(!l(e))return{};var t,i=e.iptcdata,n={};for(t in i)i.hasOwnProperty(t)&&(n[t]=i[t]);return n},i.pretty=function(e){if(!l(e))return"";var t,i=e.exifdata,n="";for(t in i)i.hasOwnProperty(t)&&(n+="object"==typeof i[t]?i[t]instanceof Number?t+" : "+i[t]+" ["+i[t].numerator+"/"+i[t].denominator+"]\r\n":t+" : ["+i[t].length+" values]\r\n":t+" : "+i[t]+"\r\n");return n},i.readFromBinaryFile=function(e){return b(e)},void 0===(a=(function(){return i}).apply(t,[]))||(e.exports=a)}).call(this)},sFyk:function(e,t,i){"use strict";i.r(t),i.d(t,"PagesModule",function(){return $i});var n=i("ofXK"),a=i("d8Z/"),r=i("hTao"),o=i("fXoL"),s=i("tyNb"),c=i("0yvB"),g=i("rmxa"),l=i("aZ8m"),b=i("BAfr"),d=i("+803"),h=i("aF9I");let u=(()=>{class e{constructor(e,t,i){this.route=e,this.navServices=t,this.layout=i,this.route.queryParams.subscribe(e=>{this.layout.config.settings.layout=e.layout?e.layout:this.layout.config.settings.layout})}ngAfterViewInit(){setTimeout(()=>{a.replace()})}getRouterOutletState(e){return e.isActivated?e.activatedRoute:""}get layoutClass(){switch(this.layout.config.settings.layout){case"Dubai":return"compact-wrapper";case"London":return"only-body";case"Seoul":return"compact-wrapper modern-type";case"LosAngeles":return this.navServices.horizontal?"horizontal-wrapper material-type":"compact-wrapper material-type";case"Paris":return"compact-wrapper dark-sidebar";case"Tokyo":return"compact-sidebar";case"Madrid":return"compact-wrapper color-sidebar";case"Moscow":return"compact-sidebar compact-small";case"NewYork":return"compact-wrapper box-layout";case"Singapore":return this.navServices.horizontal?"horizontal-wrapper enterprice-type":"compact-wrapper enterprice-type";case"Rome":return"compact-sidebar compact-small material-icon";case"Barcelona":return this.navServices.horizontal?"horizontal-wrapper enterprice-type advance-layout":"compact-wrapper enterprice-type advance-layout"}}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(s.a),o.Jb(c.a),o.Jb(g.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-pages"]],decls:13,vars:8,consts:[[3,"ngClass"],["id","canvas-bookmark",1,"page-wrapper",3,"ngClass"],[1,"page-body-wrapper"],[1,"sidebar-wrapper"],[1,"page-body"],["o","outlet"],[1,"footer"]],template:function(e,t){if(1&e&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Kb(2,"app-header"),o.Ob(3,"div",2),o.Ob(4,"div",3),o.Kb(5,"app-sidebar"),o.Nb(),o.Ob(6,"div",4),o.Ob(7,"main"),o.Kb(8,"app-breadcrumb"),o.Kb(9,"router-outlet",null,5),o.Nb(),o.Nb(),o.Ob(11,"footer",6),o.Kb(12,"app-footer"),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&e){const e=o.ic(10);o.zb(t.layout.config.settings.layout_version),o.cc("ngClass",t.layout.config.settings.layout_type),o.xb(1),o.cc("ngClass",t.layoutClass),o.xb(3),o.Bb("close_icon",t.navServices.collapseSidebar),o.yb("sidebar-layout",t.layout.config.settings.sidebar_type),o.xb(3),o.cc("@fadeInAnimation",t.getRouterOutletState(e))}},directives:[n.k,l.a,b.a,d.a,s.k,h.a],styles:[""],data:{animation:[r.a]}}),e})();var m=function(e){return e[e.gallery=0]="gallery",e[e.car=1]="car",e[e.favorites=2]="favorites",e[e.myfotos=3]="myfotos",e}({}),p=i("kIR3"),f=i("itAP"),O=i("lJxs"),v=i("tk/3"),x=i("IYfF"),P=i("Nl8B");let C=(()=>{class e{constructor(e,t,i){this.http=e,this.authService=t,this.paginationService=i,this.photographerData={email:null,id:null},this.imagesEdited=new o.n}getImages(e,t=null){const i=this.getData(e,t);return this.http.post(f.a+"/images/search/admin",i).pipe(Object(O.a)(e=>(this.paginationService.updatePagination(e.total,e.skip),e)))}getImagesClient(e,t=null){const i=this.getData(e,t);return this.http.post(f.a+"/images/search/client",i).pipe(Object(O.a)(e=>(this.paginationService.updatePagination(e.total,e.skip),e)))}getImagesClientWhitOutCalculatePagination(e,t=null,i=0){const n=this.getData(e,t);return this.http.post(f.a+"/images/search/client",n).pipe(Object(O.a)(e=>(this.paginationService.updatePaginationwithpage(e.total,e.skip,i),e)))}getFavorites(e,t=null,i=0){const n=this.getData(e,t);return this.http.post(f.a+"/images/search/favorites",n).pipe(Object(O.a)(e=>(this.paginationService.updatePaginationwithpage(e.total,e.skip,i),e)))}getImagePurchased(e){return this.http.post(f.a+"/images/search/user",e).pipe(Object(O.a)(e=>e))}getData(e,t){const i={filters:e,pagination:this.paginationService.paginationData};return t&&"ahead"==t&&(i.pagination=Object.assign(Object.assign({},i.pagination),{actualPage:i.pagination.actualPage+1})),t&&"behind"==t&&(i.pagination=Object.assign(Object.assign({},i.pagination),{actualPage:i.pagination.actualPage-1})),i}saveImage(e){const t={ownerId:this.authService.user.email?this.authService.user.email:this.authService.user.username,creationDate:Object(p.a)(e.exifData.DateTime),fileName:e.fileName,copyFileName:e.copyFileName,exifData:e.exifData,imgSync:e.imgSync,tags:e.tags,photographerId:this.authService.user.email?this.authService.user.email:this.authService.user.username,photographerData:this.photographerData,uploadDate:new Date,wasCloud:e.wasCloud};return"ADMIN_ROLE"==this.authService.user.role&&(t.ownerId=this.photographerData.email,t.photographerId=this.photographerData.email),"PHOTOGRAPHER_ROLE"==this.authService.user.role&&(t.ownerId=this.authService.user.email,t.photographerId=this.authService.user.email,t.photographerData=this.authService.user),this.http.post(f.a+"/images/"+this.authService.user._id,t)}editImageTags(e){return this.http.put(f.a+"/images/edit-tags/"+this.authService.user.email,e)}deleteImage(e){return this.http.delete(f.a+"/images/"+e._id)}recycleImage(e){let t=f.a+"/images/temporarly/"+e.photographerId;return t+="?token="+this.authService.token+"&imageId="+e._id,this.http.delete(t)}restoreImage(e){const t=e.photographerId;return this.http.put(f.a+"/images/restore/"+t,{ownerId:t,imageId:e._id})}}return e.\u0275fac=function(t){return new(t||e)(o.Sb(v.b),o.Sb(x.a),o.Sb(P.a))},e.\u0275prov=o.Fb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var N=i("J2l8"),M=i("Xgv5");let y=(()=>{class e{constructor(e){this.ps=e,this.filters=null,this.images=[],this.imagesId=[],this.imageIndex=0}parseFilters(e){return e.date.to&&(e.date.to=e.date.to.endOf("day")),e}resetData(){this.filters=null,this.imagesId=[],this.imageIndex=0}setData(e,t,i=[],n=[]){this.filters=t,this.images=e,this.imagesId=i,e.forEach(e=>{this.imagesId.includes(e._id)||this.imagesId.push(e._id)}),this.imagesId=[...this.imagesId,...n],localStorage.setItem("images",JSON.stringify(this.imagesId)),localStorage.setItem("filters",JSON.stringify(this.filters))}getDataIfExists(){localStorage.getItem("images")&&(this.imagesId=JSON.parse(localStorage.getItem("images"))),localStorage.getItem("filters")&&(this.filters=JSON.parse(localStorage.getItem("filters")))}setGalleryIndex(e){this.imageIndex=this.imagesId.indexOf(e)}setActualPage(e){this.ps.paginationData.actualPage=e}checkPages(e="ahead"){const t=this.ps.paginationData.pages,i=t.indexOf(this.ps.paginationData.actualPage);return"ahead"===e?i<t.length-1:i>0}}return e.\u0275fac=function(t){return new(t||e)(o.Sb(P.a))},e.\u0275prov=o.Fb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var I=i("dxD2"),_=i("vxdj");let S=(()=>{class e{constructor(e){this.router=e,this.currentUrl=this.router.url,e.events.subscribe(e=>{e instanceof s.e&&(this.previousUrl=this.currentUrl,this.currentUrl=e.url)})}getPreviousUrl(){return this.previousUrl}}return e.\u0275fac=function(t){return new(t||e)(o.Sb(s.f))},e.\u0275prov=o.Fb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),w=(()=>{class e{constructor(){this.backTo="/imagenes"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=o.Fb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var k=i("3Pt+"),D=i("NhFE"),F=i("pqks"),T=i("i2NW"),A=i("IgG/"),E=i("PSD3"),q=i.n(E);function Y(e,t){if(1&e){const e=o.Pb();o.Ob(0,"button",9),o.Vb("click",function(){o.kc(e);const i=t.$implicit;return o.Yb(2).removeTag(i)}),o.rc(1),o.Kb(2,"app-feather-icons",10),o.Nb()}if(2&e){const e=t.$implicit;o.xb(1),o.tc(" ",e," ")}}function V(e,t){if(1&e&&(o.Ob(0,"div",7),o.qc(1,Y,3,1,"button",8),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngForOf",e.currentTags)}}function R(e,t){if(1&e){const e=o.Pb();o.Ob(0,"li",13),o.Vb("click",function(){o.kc(e);const i=t.$implicit;return o.Yb(2).addTag(i)}),o.rc(1),o.Nb()}if(2&e){const e=t.$implicit;o.xb(1),o.tc(" ",e.value," ")}}function j(e,t){if(1&e&&(o.Ob(0,"div",11),o.Ob(1,"ul"),o.qc(2,R,2,1,"li",12),o.Nb(),o.Nb()),2&e){const e=o.Yb();o.xb(2),o.cc("ngForOf",e.tags)}}function J(e,t){if(1&e){const e=o.Pb();o.Ob(0,"li",13),o.Vb("click",function(){o.kc(e);const t=o.Yb(2);return t.createTag(t.searchTerm)}),o.rc(1," No se ha encontrado este tag. Haz click aqu\xed para crearlo "),o.Nb()}}function K(e,t){1&e&&(o.Ob(0,"li"),o.rc(1," No se ha encontrado un tag que coincida. "),o.Nb())}function L(e,t){if(1&e&&(o.Ob(0,"div",14),o.Ob(1,"ul"),o.qc(2,J,2,0,"li",15),o.qc(3,K,2,0,"li",16),o.Nb(),o.Nb()),2&e){const e=o.Yb();o.xb(2),o.cc("ngIf",!e.isHome),o.xb(1),o.cc("ngIf",e.isHome)}}let U=(()=>{class e{constructor(e,t){this.tagsService=e,this.paginationService=t,this.searching=!1,this.tags=[],this.perPage=5,this.tagsSelected=[],this.searchTerm="",this.currentTags=[],this.isHome=!1,this.tagsService.resetTags.subscribe(()=>{this.tagsSelected=[],this.currentTags=[],this.tags=[],this.searchTerm=""}),this.tagsService.tagsSelectedSidebar.subscribe(e=>{this.currentTags.indexOf(e.tag)>=0?this.removeTag(e.tag):this.addTag(e)})}ngOnInit(){}ngOnDestroy(){}searchTags(e){if(this.searching)setTimeout(()=>this.searchTags(e),50);else{if(!e)return this.tags=[],void(this.searching=!1);this.searching=!0,this.tagsService.getTags(e,this.currentTags,this.perPage).subscribe(e=>{this.tags=e.tags,this.searching=!1})}}getCurrentTags(){if(this.tagsSelected.length>0){let e=[];this.tagsSelected.forEach(t=>{e.push(t.tag)}),this.currentTags=e}else this.currentTags=[]}createTag(e){const t=new A.a;t.tag=e,this.tagsService.createTag(t).subscribe(e=>{this.addTag(e.tagSaved)},e=>Object(p.c)(e.error))}addTag(e){this.tagsSelected.push(e),this.getCurrentTags(),this.tagsService.tagsSelected.emit(this.currentTags),this.tags=[],this.searchTerm=""}removeTag(e){q.a.fire({title:"\xbfEst\xe1s seguro?",text:"Estas a punto de remover este tag, \xbfDeseas continuar?",icon:"question",showCancelButton:!0,confirmButtonText:"Remover",cancelButtonText:"Cancelar"}).then(t=>{if(t.isConfirmed){const t=this.currentTags.indexOf(e);this.currentTags.splice(t,1),this.tagsSelected=this.tagsSelected.filter(t=>t.tag!==e),this.tagsService.tagsSelected.emit(this.currentTags)}})}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(N.a),o.Jb(P.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-tags-selector"]],inputs:{isHome:"isHome"},decls:8,vars:5,consts:[[1,"tags"],["class","tags-added mb-4 minify-feather",4,"ngIf"],[1,"form-group"],["for",""],["name","term","type","text","placeholder","Tag's",1,"form-control",3,"ngModel","keyup","ngModelChange"],["class","tag-results",4,"ngIf"],["class","tag-results no-results",4,"ngIf"],[1,"tags-added","mb-4","minify-feather"],["type","button",3,"click",4,"ngFor","ngForOf"],["type","button",3,"click"],["icon","x"],[1,"tag-results"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"tag-results","no-results"],[3,"click",4,"ngIf"],[4,"ngIf"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.qc(1,V,2,1,"div",1),o.Ob(2,"div",2),o.Ob(3,"label",3),o.rc(4),o.Nb(),o.Ob(5,"input",4),o.Vb("keyup",function(){return t.searchTags(t.searchTerm)})("ngModelChange",function(e){return t.searchTerm=e}),o.Nb(),o.qc(6,j,3,1,"div",5),o.qc(7,L,4,2,"div",6),o.Nb(),o.Nb()),2&e&&(o.xb(1),o.cc("ngIf",t.currentTags.length>0),o.xb(3),o.sc(t.isHome?"Buscar por TAG":"Agregar uno o varios tags"),o.xb(1),o.cc("ngModel",t.searchTerm),o.xb(1),o.cc("ngIf",t.tags.length>0),o.xb(1),o.cc("ngIf",t.tags.length<=0&&t.searchTerm&&t.currentTags.indexOf(t.searchTerm)<0))},directives:[n.m,k.a,k.i,k.k,n.l,F.a],styles:[""]}),e})();class B{constructor(e,t,i,n,a="visible",r,o,s=0,c,g=[],l,b){this._id=e,this.ownerId=t,this.creationDate=i,this.uploadDate=n,this.status=a,this.fileName=r,this.copyFileName=o,this.totalSells=s,this.photographerId=c,this.tags=g,this.exifData=l,this.fullpath=b}}let G=(()=>{class e{constructor(e,t){this.http=e,this.authService=t}getUserProfile(){return this.http.get(f.a+"/profile/"+this.authService.user._id)}editProfile(e){return this.http.put(f.a+"/profile/"+this.authService.user._id,e)}}return e.\u0275fac=function(t){return new(t||e)(o.Sb(v.b),o.Sb(x.a))},e.\u0275prov=o.Fb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function $(e,t){if(1&e&&(o.Ob(0,"span",17),o.rc(1),o.Nb()),2&e){const e=t.$implicit;o.xb(1),o.tc(" ",e," ")}}function H(e,t){if(1&e&&(o.Ob(0,"div",15),o.qc(1,$,2,1,"span",16),o.Nb()),2&e){const e=o.Yb(2);o.xb(1),o.cc("ngForOf",e.image.tags)}}function z(e,t){1&e&&o.Kb(0,"span",18)}const Z=function(e){return{"img-vertical":e}};function W(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",6),o.Vb("click",function(){o.kc(e);const t=o.Yb();return t.goToImage(t.image)}),o.Ob(1,"div",7),o.Ob(2,"img",8),o.Vb("error",function(t){o.kc(e);const i=o.Yb();return i.setDefaultPic(t,i.image)}),o.Nb(),o.Nb(),o.qc(3,H,2,1,"div",9),o.qc(4,z,1,0,"span",10),o.Ob(5,"div",11),o.Ob(6,"div",12),o.Ob(7,"span",13),o.rc(8,"Fecha:"),o.Nb(),o.rc(9),o.Zb(10,"date"),o.Nb(),o.Nb(),o.Ob(11,"div",14),o.Ob(12,"div",12),o.Ob(13,"span",13),o.rc(14,"Fotografo:"),o.Nb(),o.rc(15),o.Nb(),o.Nb(),o.Nb()}if(2&e){const e=o.Yb();o.cc("id","image_"+e.image._id),o.xb(1),o.cc("ngClass",o.fc(11,Z,e.image.exifData.Orientation>=5)),o.xb(1),o.cc("src",e.image.fullpath,o.mc)("ngClass",3==e.image.exifData.Orientation?"rotate-180":6==e.image.exifData.Orientation?"rotate-90":8==e.image.exifData.Orientation?"rotate-270":2==e.image.exifData.Orientation||4==e.image.exifData.Orientation?"flip-180":"noclass"),o.xb(1),o.cc("ngIf",e.image.tags.length>0),o.xb(1),o.cc("ngIf",0==e.image.tags.length),o.xb(5),o.tc(" ",o.bc(10,8,e.image.creationDate,"dd/MM/yyyy HH:mm:ss")," "),o.xb(6),o.tc(" ",e.image.photographerData.name+" "+(e.image.photographerData.lastName?e.image.photographerData.lastName:"")," ")}}function X(e,t){if(1&e){const e=o.Pb();o.Ob(0,"button",22),o.Vb("click",function(){o.kc(e);const t=o.Yb(2);return t.addToCart(t.image._id)}),o.rc(1," Agregar al carrito "),o.Kb(2,"app-feather-icons",23),o.Nb()}if(2&e){const e=o.Yb(2);o.cc("disabled",e.loading),o.xb(2),o.cc("icon","shopping-cart")}}function Q(e,t){1&e&&(o.Ob(0,"button",24),o.rc(1," Agregado al carrito "),o.Kb(2,"app-feather-icons",23),o.Nb()),2&e&&(o.xb(2),o.cc("icon","check"))}function ee(e,t){if(1&e&&(o.Ob(0,"div",19),o.qc(1,X,3,2,"button",20),o.qc(2,Q,3,1,"button",21),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngIf",e.cart.indexOf(e.image._id)<0),o.xb(1),o.cc("ngIf",e.cart.indexOf(e.image._id)>=0)}}function te(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",25),o.Ob(1,"button",26),o.Vb("click",function(){o.kc(e);const t=o.Yb();return t.downloadImage(t.image)}),o.rc(2," Descargar imagen "),o.Kb(3,"app-feather-icons",23),o.Nb(),o.Nb()}2&e&&(o.xb(3),o.cc("icon","download"))}function ie(e,t){1&e&&(o.Ob(0,"div",27),o.Kb(1,"i",28),o.Nb())}const ne=function(e){return{added:e}};function ae(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",29),o.Vb("click",function(){o.kc(e);const t=o.Yb();return t.markAsFavorite(t.image._id,!0)}),o.Kb(1,"app-feather-icons",30),o.Nb()}if(2&e){const e=o.Yb();o.cc("ngClass",o.fc(1,ne,e.authService.user.favorites.indexOf(e.image._id)>=0))}}let re=(()=>{class e{constructor(e,t,i,n,a,r){this.cartService=e,this.authService=t,this.profileService=i,this.router=n,this.imgFiltersService=a,this.paginationService=r,this.image=new B,this.cart=[],this.loading=!1}addToCart(e){if(!this.loading){if(!this.authService.user)return this.router.navigate(["/login"]),q.a.fire({title:"Debes iniciar sesi\xf3n para agregar im\xe1genes al carrito",icon:"warning"}),void(this.imgFiltersService&&(this.imgFiltersService.lastSeenImg=this.image,this.imgFiltersService.paginationData=this.paginationService.paginationData));this.loading=!0,this.cartService.addToCart(e).subscribe(t=>{this.cartService.cartUpdated.emit(e),this.loading=!1,this.markAsFavorite(e,!1)})}}goToImage(e){this.imgFiltersService.lastSeenImg=e,this.router.navigate(["/producto",e._id])}getUserProfile(e=!1){this.loading=!0,this.profileService.getUserProfile().subscribe(t=>{if(e){const e=localStorage.getItem("user");if(e){const i=JSON.parse(e);i.favorites=t.user.favorites,this.authService.saveInStorage(i,this.authService.token,this.authService.tokenExpiration)}this.loading=!1}})}markAsFavorite(e,t=!0){this.loading=!0;let i=this.authService.user.favorites;const n=i.indexOf(e);n>=0&&t&&i.splice(n,1),n<0&&i.push(e),this.profileService.editProfile({email:this.authService.user.email,favorites:i}).subscribe(e=>{this.loading=!1,this.getUserProfile(!0)})}downloadImage(e){window.open(e.fileName,"_blank")}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(M.a),o.Jb(x.a),o.Jb(G),o.Jb(s.f),o.Jb(_.a),o.Jb(P.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-image-card"]],inputs:{image:"image",cart:"cart"},decls:6,vars:5,consts:[[1,"image-card-container"],["class","image-content",3,"id","click",4,"ngIf"],["class","options",4,"ngIf"],["class","options download-image",4,"ngIf"],["class","loading fixed",4,"ngIf"],["class","favorites-btn",3,"ngClass","click",4,"ngIf"],[1,"image-content",3,"id","click"],[1,"thumbnail","image-not-purchased",3,"ngClass"],[3,"src","ngClass","error"],["class","tag-list mt-2",4,"ngIf"],["class","no-tags",4,"ngIf"],[1,"image-info","mt-3"],[1,"creation-date"],[1,"bold"],[1,"image-info"],[1,"tag-list","mt-2"],["class","badge badge-pill badge-secondary",4,"ngFor","ngForOf"],[1,"badge","badge-pill","badge-secondary"],[1,"no-tags"],[1,"options"],["class","btn btn-secondary mr-2 minify-feather mb-1",3,"disabled","click",4,"ngIf"],["routerLink","/carrito","class","btn btn-success mr-2 minify-feather mb-1",4,"ngIf"],[1,"btn","btn-secondary","mr-2","minify-feather","mb-1",3,"disabled","click"],[3,"icon"],["routerLink","/carrito",1,"btn","btn-success","mr-2","minify-feather","mb-1"],[1,"options","download-image"],[1,"btn","btn-success","mr-2","minify-feather","mb-1",3,"click"],[1,"loading","fixed"],[1,"fa","fa-spinner","fa-spin"],[1,"favorites-btn",3,"ngClass","click"],["icon","star"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.qc(1,W,16,13,"div",1),o.qc(2,ee,3,2,"div",2),o.qc(3,te,4,1,"div",3),o.qc(4,ie,2,0,"div",4),o.qc(5,ae,2,3,"div",5),o.Nb()),2&e&&(o.xb(1),o.cc("ngIf",t.image),o.xb(1),o.cc("ngIf",!t.authService.user||t.authService.user.purchases.indexOf(t.image._id)<0),o.xb(1),o.cc("ngIf",t.authService.user&&t.authService.user.purchases.indexOf(t.image._id)>=0),o.xb(1),o.cc("ngIf",t.loading),o.xb(1),o.cc("ngIf",t.authService.user&&t.authService.user._id))},directives:[n.m,n.k,n.l,F.a,s.g],pipes:[n.e],styles:[".image-card-container[_ngcontent-%COMP%]{position:relative}.image-content[_ngcontent-%COMP%]   .no-tags[_ngcontent-%COMP%]{min-height:30px;width:100%;display:block}.options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%!important;margin:0!important}.favorites-btn[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px}"]}),e})();function oe(e,t){if(1&e&&(o.Ob(0,"h5"),o.rc(1),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.tc("Fotos (",e.paginationService.paginationData.total," encontradas)")}}function se(e,t){if(1&e&&(o.Ob(0,"h5"),o.rc(1),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.tc(" ",e.mainView==e.mainViews.favorites?"en favoritos":"compradas"," ")}}function ce(e,t){if(1&e){const e=o.Pb();o.Ob(0,"li",53),o.Vb("click",function(){o.kc(e);const i=t.$implicit;return o.Yb(3).photographerSelected(i)}),o.rc(1),o.Nb()}if(2&e){const e=t.$implicit;o.xb(1),o.tc(" ",e.name+" "+(e.lastName?e.lastName:"")," ")}}function ge(e,t){if(1&e&&(o.Ob(0,"div",51),o.Ob(1,"ul"),o.qc(2,ce,2,1,"li",52),o.Nb(),o.Nb()),2&e){const e=o.Yb(2);o.xb(2),o.cc("ngForOf",e.photographers)}}function le(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",54),o.Ob(1,"button",55),o.Vb("click",function(){return o.kc(e),o.Yb(2).hidePhotographersList()}),o.Kb(2,"i",56),o.Nb(),o.Nb()}}function be(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",57),o.Ob(1,"div",58),o.Ob(2,"label",59),o.rc(3," Fotos favoritas "),o.Nb(),o.Ob(4,"label",60),o.Ob(5,"input",61,62),o.Vb("change",function(){o.kc(e);const t=o.ic(6);return o.Yb(2).showOnlyFavorites(t.checked)}),o.Nb(),o.Kb(7,"span",63),o.Nb(),o.Nb(),o.Nb()}if(2&e){const e=o.Yb(2);o.xb(5),o.cc("checked",e.filters.favorites.active)}}function de(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",64),o.Ob(1,"div",58),o.Ob(2,"label",65),o.rc(3," Fotos compradas "),o.Nb(),o.Ob(4,"label",60),o.Ob(5,"input",66,67),o.Vb("change",function(){o.kc(e);const t=o.ic(6);return o.Yb(2).showOnlyPurchases(t.checked)}),o.Nb(),o.Kb(7,"span",63),o.Nb(),o.Nb(),o.Nb()}if(2&e){const e=o.Yb(2);o.xb(5),o.cc("checked",e.filters.purchases.active)}}function he(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",27),o.Ob(1,"div",28),o.Ob(2,"div",29),o.Ob(3,"div",30),o.Ob(4,"div",31),o.Ob(5,"label",32),o.rc(6,"Fot\xf3grafo (nombre/alias)"),o.Nb(),o.Ob(7,"input",33),o.Vb("ngModelChange",function(t){return o.kc(e),o.Yb().photographerTerm=t})("keyup",function(t){return o.kc(e),o.Yb().filterPhotographer(t)})("focus",function(t){return o.kc(e),o.Yb().filterPhotographer(t)}),o.Nb(),o.qc(8,ge,3,1,"div",34),o.qc(9,le,3,0,"div",35),o.Nb(),o.Nb(),o.Ob(10,"div",30),o.Ob(11,"div",36),o.Ob(12,"label",37),o.Kb(13,"app-feather-icons",38),o.rc(14," Desde: "),o.Nb(),o.Ob(15,"dp-date-picker",39),o.Vb("ngModelChange",function(t){return o.kc(e),o.Yb().filters.date.from=t}),o.Nb(),o.Nb(),o.Ob(16,"div",36),o.Ob(17,"label",37),o.Kb(18,"app-feather-icons",38),o.rc(19," Hasta: "),o.Nb(),o.Ob(20,"dp-date-picker",40),o.Vb("ngModelChange",function(t){return o.kc(e),o.Yb().filters.date.to=t}),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(21,"div",41),o.Ob(22,"button",42),o.Vb("click",function(){return o.kc(e),o.Yb().getImages()}),o.Kb(23,"app-feather-icons",43),o.rc(24," Buscar "),o.Nb(),o.Ob(25,"button",44),o.Vb("click",function(){return o.kc(e),o.Yb().resetFilters()}),o.Kb(26,"app-feather-icons",45),o.Nb(),o.Nb(),o.Nb(),o.Ob(27,"div",46),o.qc(28,be,8,1,"div",47),o.qc(29,de,8,1,"div",48),o.Nb(),o.Ob(30,"div",49),o.Kb(31,"app-tags-selector",50),o.Nb(),o.Kb(32,"hr"),o.Nb()}if(2&e){const e=o.Yb();o.xb(7),o.cc("ngModel",e.photographerTerm),o.xb(1),o.cc("ngIf",e.showPhotographersList),o.xb(1),o.cc("ngIf",e.showPhotographersList),o.xb(6),o.cc("ngModel",e.filters.date.from)("config",e.datePickerConfig),o.xb(5),o.cc("ngModel",e.filters.date.to)("config",e.datePickerConfig),o.xb(8),o.cc("ngIf",e.authService.user),o.xb(1),o.cc("ngIf",e.authService.user),o.xb(2),o.cc("isHome",!0)}}function ue(e,t){if(1&e){const e=o.Pb();o.Ob(0,"i",68),o.Vb("click",function(){return o.kc(e),o.Yb().bigImagesActive=!0}),o.Nb()}}function me(e,t){if(1&e){const e=o.Pb();o.Ob(0,"i",69),o.Vb("click",function(){return o.kc(e),o.Yb().bigImagesActive=!1}),o.Nb()}}function pe(e,t){if(1&e&&(o.Ob(0,"div",72),o.Kb(1,"app-image-card",73),o.Nb()),2&e){const e=t.$implicit,i=o.Yb(2);o.xb(1),o.cc("cart",i.itemsInCart)("image",e)}}function fe(e,t){if(1&e&&(o.Ob(0,"div",70),o.qc(1,pe,2,2,"div",71),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngForOf",e.images)}}function Oe(e,t){if(1&e&&(o.Ob(0,"div",72),o.Kb(1,"app-image-card",73),o.Nb()),2&e){const e=t.$implicit,i=o.Yb(2);o.xb(1),o.cc("cart",i.itemsInCart)("image",e)}}function ve(e,t){if(1&e&&(o.Ob(0,"div",70),o.qc(1,Oe,2,2,"div",71),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngForOf",e.imagespurchased)}}function xe(e,t){1&e&&(o.Ob(0,"div",74),o.Kb(1,"i",75),o.Nb())}const Pe=function(e){return{"big-images":e}};let Ce=(()=>{class e{constructor(e,t,i,n,a,r,o,s,c,g,l,b,d){if(this.imagesService=e,this.authService=t,this.router=i,this.tagsService=n,this.cartService=a,this.route=r,this.galleryService=o,this.paginationService=s,this.usersService=c,this.imgFiltersService=g,this.viewScroller=l,this.previousRouteService=b,this.backToService=d,this.filters=null,this.photographerTerm="",this.photographers=[],this.showPhotographersList=!1,this.showonlypaied=!1,this.mainViews=m,this.mainView=m.gallery,this.favoritesChecked=!1,this.onlyPurchasesChecked=!1,this.images=[],this.imagespurchased=[],this.datePickerConfig={locale:"es"},this.itemsInCart=[],this.bigImagesActive=!1,this.loading=!1,this.filters=this.imgFiltersService.filters,this.imgFiltersService.resetFiltersEmitter.subscribe(()=>{this.filters=this.imgFiltersService.filters,this.getImages()}),this.filters.tags=[],this.authService.user&&"CLIENT_ROLE"!==this.authService.user.role){if("ADMIN_ROLE"==this.authService.user.role)return void this.router.navigate(["/admin"]);if("CASHIER_ROLE"==this.authService.user.role)return void this.router.navigate(["/caja"]);this.router.navigate(["/imagenes"])}this.route.url.subscribe(e=>{this.getImages()}),this.getItemsInCart(),this.cartService.cartUpdated.subscribe(()=>{this.getItemsInCart()}),this.tagsService.tagsSelected.subscribe(e=>{this.filters.tags=e,this.getImages()}),this.paginationService.pageChanged.subscribe(e=>{setTimeout(()=>{this.getImages(!0)})})}scrollTo(e=!1){if(e&&setTimeout(()=>{this.viewScroller.scrollToPosition([0,400])}),this.imgFiltersService.lastSeenImg){const e="image_"+this.imgFiltersService.lastSeenImg._id;setTimeout(()=>{const t=document.getElementById(e);if(t){t.scrollIntoView({behavior:"smooth",block:"center"});let e=t.closest(".image");e&&e.classList.add("last-seen")}this.imgFiltersService.lastSeenImg=null})}}getImages(e=!1){this.setMainView(),this.filters.favorites.active||this.filters.purchases.active||(e||this.imgFiltersService.paginationData&&(this.paginationService.paginationData=this.imgFiltersService.paginationData),null!=this.previousRouteService.getPreviousUrl()&&0==this.previousRouteService.getPreviousUrl().indexOf("Producto")&&(this.filters=this.imgFiltersService.resetFilters()),this.imgFiltersService.setData({paginationData:this.paginationService.paginationData,filters:this.filters})),this.loading=!0;const t=this.galleryService.parseFilters(this.filters);switch(this.mainView){case m.favorites:this.imagesService.getFavorites(t,null,this.paginationService.paginationData.actualPage).subscribe(t=>{this.images=this.processImages(t,e)});break;case m.myfotos:null!=this.authService.user&&this.imagesService.getImagePurchased(this.authService.user).subscribe(t=>{t.tags=[],this.imagespurchased=this.processImages(t,e)});break;default:this.imagesService.getImagesClientWhitOutCalculatePagination(t,null,this.paginationService.paginationData.actualPage).subscribe(t=>{this.images=this.processImages(t,e)})}}processImages(e,t=!1){this.loading=!1;const i=e.images;return i.forEach(e=>{e.fullpath=this.filters.purchases.active?e.fileName:e.copyFileName,e.exifData.Orientation=this.filters.purchases.active?5:e.exifData.Orientation}),this.galleryService.setData(i,this.filters),this.scrollTo(t),this.tagsService.gettingFilterTags.emit(e.tags),i}filterPhotographer(e){this.showPhotographersList=!0,this.usersService.getPhotographers(e.target.value).subscribe(e=>{this.photographers=e.photographers})}hidePhotographersList(){this.showPhotographersList=!1,(this.filters.photographer||this.filters.photographer)&&(this.filters.photographer="",this.photographerTerm="",this.getImages())}photographerSelected(e){const t=e.email?e.email:e.username;this.filters.photographer=t,this.photographerTerm=t,this.getImages(),this.showPhotographersList=!1}resetFilters(){this.filters=this.imgFiltersService.resetFilters(),this.galleryService.filters=this.filters,this.getImages()}getItemsInCart(){this.authService.user&&this.authService.user._id&&"CLIENT_ROLE"===this.authService.user.role&&this.cartService.getCart().subscribe(e=>{this.itemsInCart=[],e.cart.products.forEach(e=>{var t;(null===(t=null==e?void 0:e.imageId)||void 0===t?void 0:t._id)&&this.itemsInCart.push(e.imageId._id)})})}showOnlyFavorites(e){var t,i;this.favoritesChecked=e,this.filters.favorites.active=this.favoritesChecked,this.filters.favorites.images=[],this.favoritesChecked&&(this.filters.favorites.images=null===(i=null===(t=this.authService)||void 0===t?void 0:t.user)||void 0===i?void 0:i.favorites),this.getImages()}showOnlyPurchases(e){var t;this.onlyPurchasesChecked=e,this.filters.purchases.active=this.onlyPurchasesChecked,this.filters.purchases.images=[],this.onlyPurchasesChecked&&(this.filters.purchases.images=null===(t=this.authService.user)||void 0===t?void 0:t.purchases),this.getImages()}setMainView(){var e,t,i,n;switch(this.router.url){case"/favoritos":this.filters.favorites.active=!0,this.filters.purchases.active=!1,this.filters.favorites.images=null===(t=null===(e=this.authService)||void 0===e?void 0:e.user)||void 0===t?void 0:t.favorites,this.filters.date={from:null,to:null},this.mainView=m.favorites,this.backToService.backTo="/favoritos";break;case"/mis-imagenes":this.showonlypaied=!0,this.filters.favorites.active=!1,this.filters.purchases.active=!0,this.filters.purchases.images=(null===(n=null===(i=this.authService)||void 0===i?void 0:i.user)||void 0===n?void 0:n.purchases)?this.authService.user.purchases:[],this.filters.date={from:null,to:null},this.mainView=m.myfotos,this.backToService.backTo="/mis-imagenes";break;default:this.filters.favorites.active=this.favoritesChecked,this.filters.purchases.active=this.onlyPurchasesChecked,this.mainView=m.gallery,this.backToService.backTo="/"}}addAlltoCart(){this.loading=!0;try{this.galleryService.imagesId.forEach(e=>{this.cartService.cartItems.filter(t=>t._id===e)[0]||(console.log("Yes"),this.loading=!1)})}catch(e){}}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(C),o.Jb(x.a),o.Jb(s.f),o.Jb(N.a),o.Jb(M.a),o.Jb(s.a),o.Jb(y),o.Jb(P.a),o.Jb(I.a),o.Jb(_.a),o.Jb(n.s),o.Jb(S),o.Jb(w))},e.\u0275cmp=o.Db({type:e,selectors:[["app-home"]],decls:41,vars:13,consts:[[1,"container-fluid","images-list",3,"ngClass"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[4,"ngIf"],[1,"card-body","custom-datatable"],["class","filters-section",4,"ngIf"],[1,"row","orders"],[1,"col-12","col-sm-6"],[1,"order-by"],["for","order_by"],["name","orderBy","id","order_by",1,"form-control",3,"ngModel","ngModelChange","change"],["value","creationDate"],[1,"order-type"],["for","order_type"],["name","orderType","id","order_type",1,"form-control",3,"ngModel","ngModelChange","change"],["value","-1","selected",""],["value","1"],[1,"row","list-type"],[1,"list-type-container","mt-3"],[1,"buttons"],["class","fa fa-list",3,"click",4,"ngIf"],["class","fa fa-image",3,"click",4,"ngIf"],[1,"row","top-pagination","mb-3"],["class","images",4,"ngIf"],["class","loading",4,"ngIf"],[1,"filters-section"],[1,"filters","pb-3","d-flex","justify-content-between","align-items-center"],[1,"row","filters-options","w-75"],[1,"col-12","col-lg-6"],[1,"form-group","filter-fotografo"],["for","filterEmail"],["name","photographerTerm","autocomplete","off","type","text","id","filterEmail","placeholder","Todos los fot\xf3grafos",1,"form-control","mb-0","w-100",3,"ngModel","ngModelChange","keyup","focus"],["class","options",4,"ngIf"],["class","close-list",4,"ngIf"],[1,"picker","w-100","minify-feather","mb-1"],[2,"margin-right","10px"],["icon","calendar"],["name","dateFrom","placeholder","Fecha desde",3,"ngModel","config","ngModelChange"],["name","dateTo","placeholder","Fecha hasta",3,"ngModel","config","ngModelChange"],[1,"filter-btn","mb-3","w-25","text-right","d-flex","align-items-center"],[1,"btn","btn-secondary","w-100","minify-feather",2,"max-width","200px",3,"click"],["icon","search"],[1,"btn","btn-danger","reset-btn",3,"click"],["icon","x"],[1,"filters","d-flex"],["class","filter-switch",4,"ngIf"],["class","filter-switch ml-3",4,"ngIf"],[1,"filter-tags","mt-2"],[3,"isHome"],[1,"options"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"close-list"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-times"],[1,"filter-switch"],[1,"checkbox-group","switch-sm","mt-2"],["for","filterFavorite",1,"checkbox-label"],[1,"switch"],["id","filterFavorite","type","checkbox",3,"checked","change"],["check",""],[1,"switch-state"],[1,"filter-switch","ml-3"],["for","filterPurchases",1,"checkbox-label"],["id","filterPurchases","type","checkbox",3,"checked","change"],["checkPurchase",""],[1,"fa","fa-list",3,"click"],[1,"fa","fa-image",3,"click"],[1,"images"],["class","image",4,"ngFor","ngForOf"],[1,"image"],[3,"cart","image"],[1,"loading"],[1,"fa","fa-spinner","fa-spin"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"div",3),o.Ob(4,"div",4),o.qc(5,oe,2,1,"h5",5),o.qc(6,se,2,1,"h5",5),o.Nb(),o.Ob(7,"div",6),o.qc(8,he,33,10,"div",7),o.Ob(9,"div",8),o.Ob(10,"div",9),o.Ob(11,"div",10),o.Ob(12,"label",11),o.rc(13,"Ordenar por"),o.Nb(),o.Ob(14,"select",12),o.Vb("ngModelChange",function(e){return t.filters.order.by=e})("change",function(){return t.getImages()}),o.Ob(15,"option",13),o.rc(16,"Fecha de creaci\xf3n"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(17,"div",9),o.Ob(18,"div",14),o.Ob(19,"label",15),o.rc(20,"Tipo"),o.Nb(),o.Ob(21,"select",16),o.Vb("ngModelChange",function(e){return t.filters.order.order=e})("change",function(){return t.getImages()}),o.Ob(22,"option",17),o.rc(23,"Descendente"),o.Nb(),o.Ob(24,"option",18),o.rc(25,"Ascendente"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(26,"div",19),o.Ob(27,"div",2),o.Ob(28,"div",20),o.Ob(29,"p"),o.rc(30,"Vista"),o.Nb(),o.Ob(31,"div",21),o.qc(32,ue,1,0,"i",22),o.qc(33,me,1,0,"i",23),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(34,"div",24),o.Ob(35,"div",2),o.Kb(36,"app-pagination"),o.Nb(),o.Nb(),o.qc(37,fe,2,1,"div",25),o.qc(38,ve,2,1,"div",25),o.qc(39,xe,2,0,"div",26),o.Kb(40,"app-pagination"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&e&&(o.cc("ngClass",o.fc(11,Pe,t.bigImagesActive)),o.xb(5),o.cc("ngIf",t.mainView===t.mainViews.gallery),o.xb(1),o.cc("ngIf",t.mainView!=t.mainViews.gallery),o.xb(2),o.cc("ngIf",t.mainView===t.mainViews.gallery),o.xb(6),o.cc("ngModel",t.filters.order.by),o.xb(7),o.cc("ngModel",t.filters.order.order),o.xb(11),o.cc("ngIf",!t.bigImagesActive),o.xb(1),o.cc("ngIf",t.bigImagesActive),o.xb(4),o.cc("ngIf",!t.loading&&!t.showonlypaied),o.xb(1),o.cc("ngIf",!t.loading&&t.showonlypaied),o.xb(1),o.cc("ngIf",t.loading))},directives:[n.k,n.m,k.p,k.i,k.k,k.l,k.r,D.a,k.a,F.a,T.a,U,n.l,re],styles:[".images-list[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%]{align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]{display:flex;align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.checkbox-label[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:0;margin-right:15px}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.switch[_ngcontent-%COMP%]{margin:0}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{display:flex!important;justify-content:flex-end}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]   .reset-btn[_ngcontent-%COMP%]{margin-left:8px;padding:5px 5px 0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;margin-top:40px;margin-bottom:10px;margin-right:0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--theme-secondary);margin-bottom:0;margin-right:10px;font-size:16px}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:var(--theme-secondary);border:1px solid var(--theme-secondary);padding:10px;border-radius:3px;cursor:pointer}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:24%;margin-left:1%;padding:10px;border-radius:5px;background:#ecf3fa;box-shadow:1px 1px 3px grey;cursor:pointer;margin-bottom:15px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:hover{transition:all .2s ease;box-shadow:2px 2px 5px grey}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{width:100%;height:190px;overflow:hidden;display:flex;align-items:center;justify-content:center}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#8f9aa5!important}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;margin-top:10px;padding:10px 0}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .whole[_ngcontent-%COMP%]{width:100%;margin-top:10px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px;width:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image.selected[_ngcontent-%COMP%]{background:#ffcc01;box-shadow:2px 2px 5px grey}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{height:1200px!important}.image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto!important;height:66.5%!important;vertical-align:top}.image[_ngcontent-%COMP%]   .image-owned.img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px!important;width:auto!important}@media screen and (max-width:1600px){.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}}@media screen and (max-width:1500px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:32%!important}}@media screen and (max-width:1200px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}}@media screen and (max-width:992px){.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{flex-direction:column}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:15px}}@media screen and (max-width:768px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center}}@media screen and (max-width:400px){.images-list[_ngcontent-%COMP%]   .picker[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px!important}.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.375rem 0!important;width:48%}}",".filter-btn[_ngcontent-%COMP%]{align-items:stretch!important}.filter-btn[_ngcontent-%COMP%]   .reset-btn[_ngcontent-%COMP%]{margin-left:5px}.filter-fotografo[_ngcontent-%COMP%]{position:relative}.filter-fotografo[_ngcontent-%COMP%]   .close-list[_ngcontent-%COMP%]{position:absolute;top:45%;right:0}.filter-fotografo[_ngcontent-%COMP%]   .close-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:36px;width:40px;padding:0;font-size:18px}.filter-fotografo[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:absolute;background:#fff;width:100%;z-index:999;box-shadow:1px 1px 3px #000;max-height:40vh;overflow-y:scroll}.filter-fotografo[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{cursor:pointer;padding:5px;border-bottom:1px solid var(--theme-secondary)}.filter-fotografo[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{transition:all .3s ease;background:var(--theme-secondary);color:#fff}"]}),e})();var Ne=i("Tj/N"),Me=i("JuEE");let ye=(()=>{class e{constructor(e,t){this.profileService=e,this.authService=t,this.user=new Ne.a,this.getUserProfile()}getUserProfile(e=!1){this.profileService.getUserProfile().subscribe(t=>{if(this.user=t.user,e){const e=JSON.parse(localStorage.getItem("user"));e.name=t.user.name,e.email=t.user.email,this.authService.saveInStorage(e,this.authService.token,this.authService.tokenExpiration)}})}editProfile(){this.user.password&&this.user.password.length<8?q.a.fire("Error","La contrase\xf1a debe ser de minimo 8 caracteres","error"):this.user.password&&this.user.password!==this.repassword?q.a.fire("Error","Las contrase\xf1as no coinciden","error"):this.profileService.editProfile(this.user).subscribe(e=>{Object(p.c)(e),this.getUserProfile(!0),this.repassword=null},e=>{console.log(e),e.error&&Object(p.c)(e.error)})}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(G),o.Jb(x.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-my-profile"]],decls:43,vars:9,consts:[[1,"container-fluid","users"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-header","d-flex","justify-content-between"],[1,"card-body"],[1,"form-group","row"],["for","inputRole",1,"col-12","col-sm-3","col-form-label"],[1,"col-12","col-sm-9"],["id","inputRole","type","text","disabled","",1,"form-control",3,"value"],["for","inputEmail",1,"col-12","col-sm-3","col-form-label"],["name","email","id","inputEmail","type","email","placeholder","Email",1,"form-control",3,"ngModel","ngModelChange"],["for","inputAlias",1,"col-12","col-sm-3","col-form-label"],["id","inputAlias","type","text","disabled","","placeholder","Alias",1,"form-control",3,"value"],["for","inputName",1,"col-12","col-sm-3","col-form-label"],["name","name","id","inputName","type","text","placeholder","Nombre",1,"form-control",3,"ngModel","ngModelChange"],["for","inputPassword",1,"col-12","col-sm-3","col-form-label"],["name","password","id","inputPassword","type","password","placeholder","Contrase\xf1a",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","row","mb-3"],["for","inputRePassword",1,"col-12","col-sm-3","col-form-label"],["name","repassword","id","inputRePassword","type","password","placeholder","Repetir contrase\xf1a",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","mt-4","d-flex","justify-content-center"],[1,"btn","btn-primary","w-100","mt-4",2,"max-width","800px",3,"click"],[3,"icon"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"div",3),o.Ob(4,"div",4),o.Ob(5,"h5"),o.rc(6,"Mis datos"),o.Nb(),o.Nb(),o.Ob(7,"div",5),o.Ob(8,"div",6),o.Ob(9,"label",7),o.rc(10,"Rol"),o.Nb(),o.Ob(11,"div",8),o.Kb(12,"input",9),o.Zb(13,"role"),o.Nb(),o.Nb(),o.Ob(14,"div",6),o.Ob(15,"label",10),o.rc(16,"Email"),o.Nb(),o.Ob(17,"div",8),o.Ob(18,"input",11),o.Vb("ngModelChange",function(e){return t.user.email=e}),o.Nb(),o.Nb(),o.Nb(),o.Ob(19,"div",6),o.Ob(20,"label",12),o.rc(21,"Alias"),o.Nb(),o.Ob(22,"div",8),o.Kb(23,"input",13),o.Nb(),o.Nb(),o.Ob(24,"div",6),o.Ob(25,"label",14),o.rc(26,"Nombre"),o.Nb(),o.Ob(27,"div",8),o.Ob(28,"input",15),o.Vb("ngModelChange",function(e){return t.user.name=e}),o.Nb(),o.Nb(),o.Nb(),o.Ob(29,"div",6),o.Ob(30,"label",16),o.rc(31,"Contrase\xf1a"),o.Nb(),o.Ob(32,"div",8),o.Ob(33,"input",17),o.Vb("ngModelChange",function(e){return t.user.password=e}),o.Nb(),o.Nb(),o.Nb(),o.Ob(34,"div",18),o.Ob(35,"label",19),o.rc(36,"Repetir contrase\xf1a"),o.Nb(),o.Ob(37,"div",8),o.Ob(38,"input",20),o.Vb("ngModelChange",function(e){return t.repassword=e}),o.Nb(),o.Nb(),o.Nb(),o.Ob(39,"div",21),o.Ob(40,"button",22),o.Vb("click",function(){return t.editProfile()}),o.Kb(41,"app-feather-icons",23),o.rc(42," Guardar mis datos "),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&e&&(o.xb(12),o.cc("value",o.ac(13,7,t.user.role)),o.xb(6),o.cc("ngModel",t.user.email),o.xb(5),o.cc("value",t.user.username),o.xb(5),o.cc("ngModel",t.user.name),o.xb(5),o.cc("ngModel",t.user.password),o.xb(5),o.cc("ngModel",t.repassword),o.xb(3),o.cc("icon","save"))},directives:[k.a,k.i,k.k,F.a],pipes:[Me.a],styles:[""]}),e})();function Ie(e,t){1&e&&o.Kb(0,"div",11)}let _e=(()=>{class e{constructor(e,t){this.imagesService=e,this.tagsService=t,this.images=[],this.imagesSelected=[],this.loadingTags=!1,this.creationDate=null,this.tags=[],this.datePickerConfig={locale:"es"},this.tagsService.tagsSelected.subscribe(e=>{this.tags=e})}ngOnInit(){}getImagesToEdit(){let e=[];for(let t=0;t<this.images.length;t++)this.imagesSelected.indexOf(this.images[t]._id)>=0&&e.push(this.images[t]);return e}editImages(e=null,t=0){e||(e=this.getImagesToEdit());const i=this.imagesService.editImageTags({imageId:e[t]._id,creationDate:this.creationDate,tags:this.tags}).subscribe(n=>{if(i.unsubscribe(),++t==e.length)return q.a.fire("Correcto","Imagenes modificadas correctamente","success"),this.imagesService.imagesEdited.emit("edited"),this.tagsService.resetTags.emit("reset"),void(this.tags=[]);this.editImages(e,t)},e=>Object(p.c)(e.error))}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(C),o.Jb(N.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-edit-images"]],inputs:{images:"images",imagesSelected:"imagesSelected"},decls:20,vars:3,consts:[[1,"modal-body"],[1,"creation-date"],[1,"picker","mt-4","w-100"],[2,"margin-right","10px"],["name","creationDate","placeholder","Fecha de creaci\xf3n",3,"ngModel","config","ngModelChange"],[1,"tags-management"],[1,"tags"],["class","loading",4,"ngIf"],[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary",3,"click"],[1,"loading"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"h4"),o.rc(3,"Fecha de creaci\xf3n de la imagen (Por defecto dato del EXIF)"),o.Nb(),o.Ob(4,"div",2),o.Ob(5,"label",3),o.rc(6,"Fecha de creaci\xf3n:"),o.Nb(),o.Ob(7,"dp-date-picker",4),o.Vb("ngModelChange",function(e){return t.creationDate=e}),o.Nb(),o.Nb(),o.Kb(8,"hr"),o.Nb(),o.Ob(9,"div",5),o.Ob(10,"h4"),o.rc(11,"Modificar tags a las imagenes seleccionadas"),o.Nb(),o.Ob(12,"div",6),o.Kb(13,"app-tags-selector"),o.qc(14,Ie,1,0,"div",7),o.Nb(),o.Nb(),o.Nb(),o.Ob(15,"div",8),o.Ob(16,"button",9),o.rc(17,"Cerrar"),o.Nb(),o.Ob(18,"button",10),o.Vb("click",function(){return t.editImages()}),o.rc(19," Guardar cambios "),o.Nb(),o.Nb()),2&e&&(o.xb(7),o.cc("ngModel",t.creationDate)("config",t.datePickerConfig),o.xb(7),o.cc("ngIf",t.loadingTags))},directives:[T.a,k.i,k.k,U,n.m],styles:[""]}),e})();function Se(e,t){if(1&e){const e=o.Pb();o.Ob(0,"li",64),o.Vb("click",function(){o.kc(e);const i=t.$implicit;return o.Yb(3).photographerSelected(i)}),o.rc(1),o.Nb()}if(2&e){const e=t.$implicit;o.xb(1),o.tc(" ",e.name+" "+(e.lastName?e.lastName:"")," ")}}function we(e,t){if(1&e&&(o.Ob(0,"div",62),o.Ob(1,"ul"),o.qc(2,Se,2,1,"li",63),o.Nb(),o.Nb()),2&e){const e=o.Yb(2);o.xb(2),o.cc("ngForOf",e.photographers)}}function ke(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",65),o.Ob(1,"button",66),o.Vb("click",function(){return o.kc(e),o.Yb(2).hidePhotographersList()}),o.Kb(2,"i",67),o.Nb(),o.Nb()}}function De(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",57),o.Ob(1,"label",58),o.rc(2,"Fotografo"),o.Nb(),o.Ob(3,"input",59),o.Vb("ngModelChange",function(t){return o.kc(e),o.Yb().photographerTerm=t})("keyup",function(t){return o.kc(e),o.Yb().filterPhotographer(t)})("focus",function(t){return o.kc(e),o.Yb().filterPhotographer(t)}),o.Nb(),o.qc(4,we,3,1,"div",60),o.qc(5,ke,3,0,"div",61),o.Nb()}if(2&e){const e=o.Yb();o.xb(3),o.cc("ngModel",e.photographerTerm),o.xb(1),o.cc("ngIf",e.showPhotographersList),o.xb(1),o.cc("ngIf",e.showPhotographersList)}}function Fe(e,t){if(1&e){const e=o.Pb();o.Ob(0,"i",68),o.Vb("click",function(){return o.kc(e),o.Yb().bigImagesActive=!0}),o.Nb()}}function Te(e,t){if(1&e){const e=o.Pb();o.Ob(0,"i",69),o.Vb("click",function(){return o.kc(e),o.Yb().bigImagesActive=!1}),o.Nb()}}function Ae(e,t){if(1&e&&(o.Ob(0,"span",83),o.rc(1),o.Nb()),2&e){const e=t.$implicit;o.xb(1),o.tc(" ",e," ")}}function Ee(e,t){if(1&e&&(o.Ob(0,"div",81),o.qc(1,Ae,2,1,"span",82),o.Nb()),2&e){const e=o.Yb().$implicit;o.xb(1),o.cc("ngForOf",e.tags)}}const qe=function(e){return{whole:e}};function Ye(e,t){if(1&e){const e=o.Pb();o.Ob(0,"button",84),o.Vb("click",function(){o.kc(e);const t=o.Yb().$implicit;return o.Yb(2).askToRestore(t)}),o.Kb(1,"app-feather-icons",79),o.rc(2," Restaurar "),o.Nb()}if(2&e){const e=o.Yb(3);o.cc("ngClass",o.fc(2,qe,"ADMIN_ROLE"==e.authService.user.role)),o.xb(1),o.cc("icon","refresh-cw")}}const Ve=function(e){return{selected:e}},Re=function(e){return{"img-vertical":e}};function je(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",72),o.Ob(1,"div",73),o.Vb("click",function(){o.kc(e);const i=t.$implicit;return o.Yb(2).goToImage(i)}),o.Ob(2,"img",74),o.Vb("error",function(i){o.kc(e);const n=t.$implicit;return o.Yb(2).setDefaultPic(i,n)}),o.Nb(),o.Nb(),o.qc(3,Ee,2,1,"div",75),o.Ob(4,"div",76),o.Ob(5,"div",77),o.Ob(6,"span",78),o.rc(7,"Fecha creaci\xf3n:"),o.Nb(),o.rc(8),o.Zb(9,"date"),o.Nb(),o.Ob(10,"div",77),o.Ob(11,"span",78),o.rc(12,"Fecha subida:"),o.Nb(),o.rc(13),o.Zb(14,"date"),o.Nb(),o.Ob(15,"div",77),o.Ob(16,"span",78),o.rc(17,"Fot\xf3grafo:"),o.Nb(),o.rc(18),o.Nb(),o.Nb(),o.Ob(19,"div",62),o.Ob(20,"button",6),o.Vb("click",function(){o.kc(e);const i=t.$implicit;return o.Yb(2).selectImage(i._id)}),o.Kb(21,"app-feather-icons",79),o.rc(22," Seleccionar "),o.Nb(),o.qc(23,Ye,3,4,"button",80),o.Nb(),o.Nb()}if(2&e){const e=t.$implicit,i=o.Yb(2);o.cc("ngClass",o.fc(17,Ve,i.imagesSelected.indexOf(e._id)>=0)),o.xb(1),o.cc("id","image_"+e._id)("ngClass",o.fc(19,Re,e.exifData&&e.exifData.Orientation>=5)),o.xb(1),o.cc("src",e.fullpath,o.mc)("ngClass",3==e.exifData.Orientation?"rotate-180":6==e.exifData.Orientation?"rotate-90":8==e.exifData.Orientation?"rotate-270":2==e.exifData.Orientation||4==e.exifData.Orientation?"flip-180":"noclass"),o.xb(1),o.cc("ngIf",e.tags.length>0),o.xb(5),o.tc(" ",o.bc(9,11,e.creationDate,"dd/MM/yyyy HH:mm:ss")," "),o.xb(5),o.tc(" ",o.bc(14,14,e.uploadDate,"dd/MM/yyyy HH:mm:ss")," "),o.xb(5),o.tc(" ",e.photographerData.name+" "+(e.photographerData.lastName?e.photographerData.lastName:"")," "),o.xb(3),o.cc("icon","check-circle"),o.xb(2),o.cc("ngIf","deleted"==e.status)}}function Je(e,t){if(1&e&&(o.Ob(0,"div",70),o.qc(1,je,24,21,"div",71),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngForOf",e.images)}}function Ke(e,t){1&e&&(o.Ob(0,"div",85),o.Kb(1,"i",86),o.Nb())}function Le(e,t){if(1&e&&(o.Ob(0,"div",87),o.Ob(1,"span",88),o.rc(2),o.Nb(),o.rc(3),o.Nb()),2&e){const e=o.Yb();o.xb(2),o.sc(e.imagesSelected.length),o.xb(1),o.uc(" ",e.imagesSelected.length>1?"Imagenes":"Imagen"," ",e.imagesSelected.length>1?"seleccionadas":"seleccionada",". Click para editar\n")}}const Ue=function(e){return{"big-images":e}};let Be=(()=>{class e{constructor(e,t,i,n,a,r,o,s){this.imagesService=e,this.authService=t,this.galleryService=i,this.paginationService=n,this.usersService=a,this.imgFiltersService=r,this.router=o,this.viewScroller=s,this.filters=null,this.photographerTerm="",this.photographers=[],this.showPhotographersList=!1,this.imagesSelected=[],this.images=[],this.datePickerConfig={locale:"es"},this.loading=!1,this.bigImagesActive=!1,this.authService.user?(this.filters=this.imgFiltersService.adminFilters,this.imgFiltersService.resetFiltersEmitter.subscribe(()=>{this.filters=this.imgFiltersService.adminFilters,this.getImages()}),this.filters.tags=[],this.getImages(),this.imagesService.imagesEdited.subscribe(()=>{this.getImages(!0)}),this.paginationService.pageChanged.subscribe(e=>{this.getImages(!0)})):this.router.navigate(["/"])}ngOnInit(){}scrollTo(e=!1){if(e&&setTimeout(()=>{this.viewScroller.scrollToPosition([0,400])},1e3),this.imgFiltersService.lastSeenImg){const e="image_"+this.imgFiltersService.lastSeenImg._id;setTimeout(()=>{const t=document.getElementById(e);t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),t.closest(".image").classList.add("last-seen")),this.imgFiltersService.lastSeenImg=null},1e3)}}setDefaultPic(e,t){}getImages(e=!1){e||(this.paginationService.resetPagination(),this.imgFiltersService.paginationData&&(this.paginationService.paginationData=this.imgFiltersService.paginationData)),this.imgFiltersService.setData({paginationData:this.paginationService.paginationData,adminFilters:this.filters}),this.paginationService.paginationData.perPage=99,this.loading=!0;const t=this.galleryService.parseFilters(this.filters);this.imagesService.getImages(t).subscribe(t=>{this.images=t.images,this.images.forEach(e=>{e.fullpath=e.copyFileName}),this.galleryService.setData(this.images,this.filters),this.loading=!1,this.scrollTo(e)})}goToImage(e){this.imgFiltersService.lastSeenImg=e,this.router.navigate(["/producto",e._id])}filterPhotographer(e){this.showPhotographersList=!0,this.usersService.getPhotographers(e.target.value).subscribe(e=>{this.photographers=e.photographers})}hidePhotographersList(){this.showPhotographersList=!1,(this.filters.photographer||this.filters.photographer)&&(this.filters.photographer="",this.photographerTerm="",this.getImages())}photographerSelected(e){const t=e.email?e.email:e.username;this.filters.photographer=t,this.photographerTerm=t,this.getImages(),this.showPhotographersList=!1}resetFilters(){this.filters=this.imgFiltersService.resetFilters(!0),this.galleryService.filters=this.filters,this.getImages()}showRecycledChanged(e){this.filters.showRecycled=e,this.getImages()}selectImage(e){if(this.imagesSelected.indexOf(e)>=0){const t=this.imagesSelected.indexOf(e);this.imagesSelected.splice(t,1)}else this.imagesSelected.push(e)}selectAllImages(){this.imagesSelected.length!=this.images.length?(this.imagesSelected=[],this.images.forEach((e,t)=>{this.selectImage(e._id)})):this.imagesSelected=[]}deleteImage(e){this.imagesService.deleteImage(e).subscribe(e=>{Object(p.c)(e),this.getImages()},e=>Object(p.c)(e))}restoreImage(e){this.imagesService.restoreImage(e).subscribe(e=>{Object(p.c)(e),this.getImages()},e=>Object(p.c)(e))}recycleImage(e){this.imagesService.recycleImage(e).subscribe(e=>{Object(p.c)(e),this.getImages()},e=>Object(p.c)(e))}askToDelete(e){q.a.fire({title:"\xbfEst\xe1s seguro?",text:"Haz seleccionado esta imagen para su eliminaci\xf3n, \xbfDeseas continuar?",icon:"question",showCancelButton:!0,confirmButtonText:"Eliminar",confirmButtonColor:"#dc3545",cancelButtonText:"Cancelar",cancelButtonColor:"#cdcdcd"}).then(t=>{t.isConfirmed&&q.a.fire({title:"Confirma nuevamente",text:"Estas a punto de eliminar esta im\xe1gen, \xbfDeseas continuar?",icon:"warning",showCancelButton:!0,confirmButtonText:"Eliminar",confirmButtonColor:"#dc3545",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&("ADMIN_ROLE"==this.authService.user.role?this.deleteImage(e):this.recycleImage(e))})})}askToRestore(e){q.a.fire({title:"\xbfEst\xe1s seguro?",text:"Estas a punto de restaurar esta im\xe1gen, \xbfDeseas continuar?",icon:"question",showCancelButton:!0,confirmButtonText:"Restaurar",confirmButtonColor:"#51bb25",cancelButtonText:"Cancelar",cancelButtonColor:"#cdcdcd"}).then(t=>{t.isConfirmed&&this.restoreImage(e)})}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(C),o.Jb(x.a),o.Jb(y),o.Jb(P.a),o.Jb(I.a),o.Jb(_.a),o.Jb(s.f),o.Jb(n.s))},e.\u0275cmp=o.Db({type:e,selectors:[["app-images-management"]],decls:83,vars:19,consts:[[1,"container-fluid","images-list",3,"ngClass"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"select-all-btn"],[1,"btn","btn-secondary","mr-2","minify-feather",3,"click"],[1,"mr-2",3,"icon"],[1,"card-body","custom-datatable"],[1,"filters","pb-3","d-flex","justify-content-between","align-items-center"],[1,"row","filters-options","w-75"],[1,"col-12","col-lg-6"],["class","form-group filter-fotografo",4,"ngIf"],[1,"checkbox-group","switch-sm"],["for","filterRecycled",1,"checkbox-label"],[1,"switch"],["id","filterRecycled","type","checkbox",3,"change"],["check",""],[1,"switch-state"],[1,"picker","w-100"],[2,"margin-right","10px"],["name","dateFrom","placeholder","Fecha desde",3,"ngModel","config","ngModelChange"],["name","dateTo","placeholder","Fecha hasta",3,"ngModel","config","ngModelChange"],[1,"filter-btn","mb-3","w-25","text-right","d-flex","align-items-center"],[1,"btn","btn-secondary","w-100","minify-feather",2,"max-width","200px",3,"click"],["icon","search"],[1,"btn","btn-danger","reset-btn",3,"click"],["icon","x"],[1,"row","orders"],[1,"col-12","col-sm-6"],[1,"order-by"],["for","order_by"],["name","orderBy","id","order_by",1,"form-control",3,"ngModel","ngModelChange","change"],["value","creationDate"],["value","uploadDate"],[1,"order-type"],["for","order_type"],["name","orderType","id","order_type",1,"form-control",3,"ngModel","ngModelChange","change"],["value","-1","selected",""],["value","1"],[1,"row","list-type"],[1,"list-type-container","mt-3"],[1,"buttons"],["class","fa fa-list",3,"click",4,"ngIf"],["class","fa fa-image",3,"click",4,"ngIf"],[1,"row","top-pagination","mb-3"],["class","images",4,"ngIf"],["class","loading",4,"ngIf"],["class","images-selected-edit","data-toggle","modal","data-target","#editImageModal",4,"ngIf"],["id","editImageModal","tabindex","-1","aria-labelledby","editImageModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","editImageModalLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[3,"images","imagesSelected"],[1,"form-group","filter-fotografo"],["for","filterEmail"],["name","photographerTerm","autocomplete","off","type","text","id","filterEmail","placeholder","Todos los fot\xf3grafos",1,"form-control","mb-0","w-100",3,"ngModel","ngModelChange","keyup","focus"],["class","options",4,"ngIf"],["class","close-list",4,"ngIf"],[1,"options"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"close-list"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-times"],[1,"fa","fa-list",3,"click"],[1,"fa","fa-image",3,"click"],[1,"images"],["class","image",3,"ngClass",4,"ngFor","ngForOf"],[1,"image",3,"ngClass"],[1,"thumbnail","image-owned",3,"id","ngClass","click"],[3,"src","ngClass","error"],["class","tag-list mt-2",4,"ngIf"],[1,"image-info","mt-3"],[1,"creation-date"],[1,"bold"],[3,"icon"],["class","btn btn-success minify-feather mb-1",3,"ngClass","click",4,"ngIf"],[1,"tag-list","mt-2"],["class","badge badge-pill badge-secondary",4,"ngFor","ngForOf"],[1,"badge","badge-pill","badge-secondary"],[1,"btn","btn-success","minify-feather","mb-1",3,"ngClass","click"],[1,"loading"],[1,"fa","fa-spinner","fa-spin"],["data-toggle","modal","data-target","#editImageModal",1,"images-selected-edit"],[1,"number"]],template:function(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"div",3),o.Ob(4,"div",4),o.Ob(5,"h5"),o.rc(6),o.Nb(),o.Ob(7,"div",5),o.Ob(8,"button",6),o.Vb("click",function(){return t.selectAllImages()}),o.Kb(9,"app-feather-icons",7),o.rc(10," Seleccionar toda la p\xe1gina "),o.Nb(),o.Nb(),o.Nb(),o.Ob(11,"div",8),o.Ob(12,"div",9),o.Ob(13,"div",10),o.Ob(14,"div",11),o.qc(15,De,6,3,"div",12),o.Ob(16,"div",13),o.Ob(17,"label",14),o.rc(18," Solo imagenes en papelera "),o.Nb(),o.Ob(19,"label",15),o.Ob(20,"input",16,17),o.Vb("change",function(){o.kc(e);const i=o.ic(21);return t.showRecycledChanged(i.checked)}),o.Nb(),o.Kb(22,"span",18),o.Nb(),o.Nb(),o.Nb(),o.Ob(23,"div",11),o.Ob(24,"div",19),o.Ob(25,"label",20),o.rc(26,"Desde:"),o.Nb(),o.Ob(27,"dp-date-picker",21),o.Vb("ngModelChange",function(e){return t.filters.date.from=e}),o.Nb(),o.Nb(),o.Ob(28,"div",19),o.Ob(29,"label",20),o.rc(30,"Hasta:"),o.Nb(),o.Ob(31,"dp-date-picker",22),o.Vb("ngModelChange",function(e){return t.filters.date.to=e}),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(32,"div",23),o.Ob(33,"button",24),o.Vb("click",function(){return t.getImages()}),o.Kb(34,"app-feather-icons",25),o.rc(35," Buscar "),o.Nb(),o.Ob(36,"button",26),o.Vb("click",function(){return t.resetFilters()}),o.Kb(37,"app-feather-icons",27),o.Nb(),o.Nb(),o.Nb(),o.Kb(38,"hr"),o.Ob(39,"div",28),o.Ob(40,"div",29),o.Ob(41,"div",30),o.Ob(42,"label",31),o.rc(43,"Ordenar por"),o.Nb(),o.Ob(44,"select",32),o.Vb("ngModelChange",function(e){return t.filters.order.by=e})("change",function(){return t.getImages()}),o.Ob(45,"option",33),o.rc(46,"Fecha de creaci\xf3n"),o.Nb(),o.Ob(47,"option",34),o.rc(48,"Fecha de subida"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(49,"div",29),o.Ob(50,"div",35),o.Ob(51,"label",36),o.rc(52,"Tipo"),o.Nb(),o.Ob(53,"select",37),o.Vb("ngModelChange",function(e){return t.filters.order.order=e})("change",function(){return t.getImages()}),o.Ob(54,"option",38),o.rc(55,"Descendente"),o.Nb(),o.Ob(56,"option",39),o.rc(57,"Ascendente"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(58,"div",40),o.Ob(59,"div",2),o.Ob(60,"div",41),o.Ob(61,"p"),o.rc(62,"Vista"),o.Nb(),o.Ob(63,"div",42),o.qc(64,Fe,1,0,"i",43),o.qc(65,Te,1,0,"i",44),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(66,"div",45),o.Ob(67,"div",2),o.Kb(68,"app-pagination"),o.Nb(),o.Nb(),o.qc(69,Je,2,1,"div",46),o.qc(70,Ke,2,0,"div",47),o.Kb(71,"app-pagination"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.qc(72,Le,4,3,"div",48),o.Ob(73,"div",49),o.Ob(74,"div",50),o.Ob(75,"div",51),o.Ob(76,"div",52),o.Ob(77,"h5",53),o.rc(78,"Modificar tags"),o.Nb(),o.Ob(79,"button",54),o.Ob(80,"span",55),o.rc(81,"\xd7"),o.Nb(),o.Nb(),o.Nb(),o.Kb(82,"app-edit-images",56),o.Nb(),o.Nb(),o.Nb()}2&e&&(o.cc("ngClass",o.fc(17,Ue,t.bigImagesActive)),o.xb(6),o.tc("Imagenes (",t.paginationService.paginationData.total,")"),o.xb(3),o.cc("icon","check-circle"),o.xb(6),o.cc("ngIf","ADMIN_ROLE"==t.authService.user.role),o.xb(12),o.cc("ngModel",t.filters.date.from)("config",t.datePickerConfig),o.xb(4),o.cc("ngModel",t.filters.date.to)("config",t.datePickerConfig),o.xb(13),o.cc("ngModel",t.filters.order.by),o.xb(9),o.cc("ngModel",t.filters.order.order),o.xb(11),o.cc("ngIf",!t.bigImagesActive),o.xb(1),o.cc("ngIf",t.bigImagesActive),o.xb(4),o.cc("ngIf",!t.loading),o.xb(1),o.cc("ngIf",t.loading),o.xb(2),o.cc("ngIf",t.imagesSelected.length>0),o.xb(10),o.cc("images",t.images)("imagesSelected",t.imagesSelected))},directives:[n.k,F.a,n.m,T.a,k.i,k.k,k.p,k.l,k.r,D.a,_e,k.a,n.l],pipes:[n.e],styles:[".images-list[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%]{align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]{display:flex;align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.checkbox-label[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:0;margin-right:15px}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.switch[_ngcontent-%COMP%]{margin:0}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{display:flex!important;justify-content:flex-end}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]   .reset-btn[_ngcontent-%COMP%]{margin-left:8px;padding:5px 5px 0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;margin-top:40px;margin-bottom:10px;margin-right:0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--theme-secondary);margin-bottom:0;margin-right:10px;font-size:16px}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:var(--theme-secondary);border:1px solid var(--theme-secondary);padding:10px;border-radius:3px;cursor:pointer}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:24%;margin-left:1%;padding:10px;border-radius:5px;background:#ecf3fa;box-shadow:1px 1px 3px grey;cursor:pointer;margin-bottom:15px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:hover{transition:all .2s ease;box-shadow:2px 2px 5px grey}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{width:100%;height:190px;overflow:hidden;display:flex;align-items:center;justify-content:center}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#8f9aa5!important}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;margin-top:10px;padding:10px 0}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .whole[_ngcontent-%COMP%]{width:100%;margin-top:10px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px;width:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image.selected[_ngcontent-%COMP%]{background:#ffcc01;box-shadow:2px 2px 5px grey}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{height:1200px!important}.image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto!important;height:66.5%!important;vertical-align:top}.image[_ngcontent-%COMP%]   .image-owned.img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px!important;width:auto!important}@media screen and (max-width:1600px){.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}}@media screen and (max-width:1500px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:32%!important}}@media screen and (max-width:1200px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}}@media screen and (max-width:992px){.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{flex-direction:column}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:15px}}@media screen and (max-width:768px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center}}@media screen and (max-width:400px){.images-list[_ngcontent-%COMP%]   .picker[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px!important}.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.375rem 0!important;width:48%}}",""]}),e})();var Ge=i("mrSG"),$e=i("iCQh"),He=i("b0Xh");function ze(e,t){if(1&e&&(o.Ob(0,"div",7),o.Ob(1,"div",8),o.Ob(2,"p"),o.rc(3),o.Nb(),o.Nb(),o.Nb()),2&e){const e=o.Yb();o.xb(3),o.uc("",e.filesService.uploadIndex," / ",e.files.length,' fotos cargadas. Click en "Subir im\xe1genes" para comenzar la carga')}}function Ze(e,t){1&e&&(o.Ob(0,"div",9),o.Kb(1,"i",10),o.Nb())}let We=(()=>{class e{constructor(e){this.filesService=e,this.files=[],this.filesDroppedElem=null,this.loading=!1,this.filesService.filesUploaded.subscribe(e=>{"uploaded"==e&&(this.files=[],this.filesDroppedElem.value="")})}ngOnInit(){}getExifData(e){return new Promise((t,i)=>{const n=new Image;n.onload=()=>{const e={width:n.width,height:n.height};He.getData(n,function(){let i=He.getAllTags(this);i=Object.assign(Object.assign({},i),{Dimensions:e}),t(i)})},n.onerror=()=>{i(new Error("Failed to load the image."))},n.src=URL.createObjectURL(e)})}filesDropped(e,t){this.filesDroppedElem=t,this.loading=!0;let i=[];const n=this.files.length;for(let a=0;a<e.length;a++)e[a].type.indexOf("image")>=0?this.getExifData(e[a]).then(t=>{if(!t)return i.push({fileName:e[a].name,error:"No se han podido obtener los datos exif"}),this.displayErrors(i),void(this.loading=!1);t={DateTime:t.DateTime?t.DateTime:null,Orientation:t.Orientation?JSON.stringify(t.Orientation):null,Copyright:t.Copyright?JSON.stringify(t.Copyright):null,ExposureTime:t.ExposureTime?JSON.stringify(t.ExposureTime):null,FNumber:t.FNumber?JSON.stringify(t.FNumber):null,Dimensions:t.Dimensions?t.Dimensions:null,ISOSpeedRatings:t.ISOSpeedRatings?JSON.stringify(t.ISOSpeedRatings):null},this.filesService.imagesData[e[a].name]={fileName:e[a].name,format:e[a].type,index:a,progress:{current:0,total:0,percentage:0},exifData:t},this.files.push(e[a]),this.emitFiles(),this.files.length==n+e.length&&(this.loading=!1)}):i.push({fileName:e[a].name,error:`La extensi\xf3n .${Object(p.b)(e[a].name)} no es v\xe1lida`});this.displayErrors(i)}displayErrors(e){if(e.length>0){let t="";e.forEach(e=>{t+=`${e.fileName}: ${e.error}. \n\r`}),q.a.fire("Error",t,"error")}}removeFile(e){this.files.splice(e,1),this.emitFiles()}emitFiles(){this.filesService.filesUpdated.emit(this.files)}}return e.\u0275fac=function(t){return new(t||e)(o.Jb($e.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-upload-images"]],decls:17,vars:2,consts:[[1,"dropzone","dropzone-primary"],[1,"dz-message","needsclick"],[1,"icon-cloud-up"],["enctype","multipart/form-data","accept","image/*","type","file","id","fileDropRef","multiple","",3,"change"],["fileDropRef",""],["class","files-list mt-1",4,"ngIf"],["class","loading-bar",4,"ngIf"],[1,"files-list","mt-1"],[1,"row","upload-status"],[1,"loading-bar"],[1,"fa","fa-spinner","fa-spin"]],template:function(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",0),o.Ob(1,"div",1),o.Kb(2,"i",2),o.Ob(3,"h6"),o.rc(4,"Arrastra las im\xe1genes aqu\xed o hac\xe9 click para seleccionarlas."),o.Nb(),o.Ob(5,"span"),o.rc(6,"(Los formatos "),o.Ob(7,"strong"),o.rc(8,"deben ser"),o.Nb(),o.rc(9," de tipo "),o.Ob(10,"strong"),o.rc(11,"imagen"),o.Nb(),o.rc(12,")"),o.Nb(),o.Nb(),o.Ob(13,"input",3,4),o.Vb("change",function(i){o.kc(e);const n=o.ic(14);return t.filesDropped(i.target.files,n)}),o.Nb(),o.Nb(),o.qc(15,ze,4,2,"div",5),o.qc(16,Ze,2,0,"div",6)}2&e&&(o.xb(15),o.cc("ngIf",t.files),o.xb(1),o.cc("ngIf",t.loading))},directives:[n.m],styles:["#swal2-content{white-space:break-spaces}.dropzone{position:relative}.dropzone:hover{transition:all .3s ease;background-color:azure}.dropzone input{opacity:0;position:absolute;width:100%;height:100%;top:0;left:0;cursor:pointer}.dark-only .dropzone:hover{color:#000!important}.files-list .file-item-wrapper{padding:0 5px!important;flex:0 0 33.3333%;max-width:33.3333%}.upload-status p{width:100%;text-align:center;margin-bottom:10px!important}.file-item{display:flex;justify-content:space-between;align-items:center;background:hsla(0,0%,94.5%,.6705882352941176);padding:10px;border-radius:5px;border:1px solid #d6d6d6;margin-bottom:5px}.file-item .img-custom{padding:5px;background:#fff;border-radius:5px;max-height:50px;width:auto}.file-item .right-side{flex-direction:column;align-items:center}.file-item .right-side,.file-item .right-side .content{width:100%;display:flex}.file-item .right-side .content p{font-size:12px!important}.file-item p{margin-bottom:0}.file-item .btn{padding:5px 7px}.file-item .btn svg{margin-bottom:-5px;height:17px;width:17px}.status{margin:0 20px;display:flex;align-items:center}.status,.status .progress{width:100%}@media screen and (max-width:1700px){.files-list .file-item-wrapper{flex:0 0 50%;max-width:50%}}@media screen and (max-width:1400px){.files-list .file-item-wrapper{flex:0 0 100%;max-width:100%}}"],encapsulation:2}),e})();function Xe(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",8),o.Ob(1,"button",9),o.Vb("click",function(){return o.kc(e),o.Yb(2).removePhotographer()}),o.rc(2),o.Kb(3,"app-feather-icons",10),o.Nb(),o.Nb()}if(2&e){const e=o.Yb(2);o.xb(2),o.tc(" ",e.photographerSelected.name," ")}}function Qe(e,t){1&e&&(o.Ob(0,"li"),o.rc(1," No se ha encontrado fot\xf3grafos con este t\xe9rmino. "),o.Nb())}function et(e,t){1&e&&(o.Ob(0,"li"),o.rc(1," Buscando fot\xf3grafos... "),o.Nb())}function tt(e,t){if(1&e&&(o.Ob(0,"div",11),o.Ob(1,"ul"),o.qc(2,Qe,2,0,"li",12),o.qc(3,et,2,0,"li",12),o.Nb(),o.Nb()),2&e){const e=o.Yb(2);o.xb(2),o.cc("ngIf",e.photographerTerm.length>=3&&!e.loading),o.xb(1),o.cc("ngIf",e.loading)}}function it(e,t){if(1&e){const e=o.Pb();o.Ob(0,"li",15),o.Vb("click",function(){o.kc(e);const i=t.$implicit;return o.Yb(3).selectPhotographer(i)}),o.rc(1),o.Nb()}if(2&e){const e=t.$implicit;o.xb(1),o.tc(" ",e.email," ")}}function nt(e,t){if(1&e&&(o.Ob(0,"div",13),o.Ob(1,"ul"),o.qc(2,it,2,1,"li",14),o.Nb(),o.Nb()),2&e){const e=o.Yb(2);o.xb(2),o.cc("ngForOf",e.photographersResults)}}function at(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",1),o.qc(1,Xe,4,1,"div",2),o.Ob(2,"div",3),o.Ob(3,"label",4),o.rc(4,"Fot\xf3grafo"),o.Nb(),o.Ob(5,"input",5),o.Vb("ngModelChange",function(t){return o.kc(e),o.Yb().photographerTerm=t})("keyup",function(){return o.kc(e),o.Yb().searchPhotographers()}),o.Nb(),o.Nb(),o.qc(6,tt,4,2,"div",6),o.qc(7,nt,3,1,"div",7),o.Nb()}if(2&e){const e=o.Yb();o.xb(1),o.cc("ngIf",e.photographerSelected),o.xb(4),o.cc("ngModel",e.photographerTerm)("disabled",e.photographerSelected),o.xb(1),o.cc("ngIf",e.photographersResults.length<=0&&e.photographerTerm),o.xb(1),o.cc("ngIf",e.photographersResults.length>0&&!e.loading)}}let rt=(()=>{class e{constructor(e,t,i){this.authService=e,this.imagesService=t,this.usersService=i,this.loading=!1,this.photographerTerm=null,this.photographersResults=[],this.photographerSelected=null}ngOnInit(){}searchPhotographers(){this.photographerTerm&&(this.photographerTerm.length<3?console.log("Escribe al menos 3 letras"):(this.loading=!0,this.usersService.getUsers({email:this.photographerTerm,role:"PHOTOGRAPHER_ROLE"}).subscribe(e=>{this.photographersResults=e.users,this.loading=!1})))}selectPhotographer(e){this.imagesService.photographerData=Object.assign({id:e._id},e),this.photographerSelected=e,this.photographerTerm=null,this.photographersResults=[]}removePhotographer(){q.a.fire({title:"\xbfEst\xe1s seguro/a?",text:"Estas a punto de remover este fot\xf3grafo, \xbfDeseas continuar?",icon:"question",showCancelButton:!0,confirmButtonText:"Remover",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&(this.photographerSelected=null)})}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(x.a),o.Jb(C),o.Jb(I.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-select-photographer"]],decls:1,vars:1,consts:[["class","photographer",4,"ngIf"],[1,"photographer"],["class","photographer-added mb-4 minify-feather",4,"ngIf"],[1,"form-group"],["for","photographer_term"],["name","photographerTerm","id","photographer_term","type","text","placeholder","Busqueda por email o nombre",1,"form-control",3,"ngModel","disabled","ngModelChange","keyup"],["class","photographer-results no-results",4,"ngIf"],["class","photographer-results",4,"ngIf"],[1,"photographer-added","mb-4","minify-feather"],["type","button",3,"click"],["icon","x"],[1,"photographer-results","no-results"],[4,"ngIf"],[1,"photographer-results"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&o.qc(0,at,8,5,"div",0),2&e&&o.cc("ngIf","ADMIN_ROLE"==t.authService.user.role)},directives:[n.m,k.a,k.i,k.k,F.a,n.l],styles:[""]}),e})();function ot(e,t){if(1&e&&(o.Ob(0,"div",13),o.Kb(1,"i",14),o.Ob(2,"div",15),o.Ob(3,"p"),o.rc(4,"Subiendo im\xe1genes... Estado: "),o.Ob(5,"strong"),o.rc(6),o.Nb(),o.rc(7),o.Nb(),o.Nb(),o.Nb()),2&e){const e=o.Yb();o.xb(6),o.tc("",e.uploadProgress,"%"),o.xb(1),o.tc(" ",100==e.uploadProgress?"Procesando im\xe1genes... A\xfan restan algunos unos minutos":""," ")}}function st(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",16),o.Ob(1,"div",17),o.Ob(2,"label"),o.rc(3,"Tipo de carga"),o.Nb(),o.Ob(4,"div",18),o.Ob(5,"div",17),o.Ob(6,"input",19),o.Vb("ngModelChange",function(t){return o.kc(e),o.Yb().uploadType=t}),o.Nb(),o.Ob(7,"label",20),o.rc(8,"Carga local"),o.Nb(),o.Nb(),o.Ob(9,"div",21),o.Ob(10,"input",22),o.Vb("ngModelChange",function(t){return o.kc(e),o.Yb().uploadType=t}),o.Nb(),o.Ob(11,"label",23),o.rc(12,"Carga cloud"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(13,"small"),o.rc(14,"La carga cloud sincroniza al instante con el servidor en la nube, por lo cual tomar\xe1 mucho m\xe1s tiempo en procesar cada imagen. La carga local tendra una sincronizaci\xf3n cloud posterior en segundo plano. "),o.Nb(),o.Nb()}if(2&e){const e=o.Yb();o.xb(6),o.cc("ngModel",e.uploadType),o.xb(4),o.cc("ngModel",e.uploadType)}}let ct=(()=>{class e{constructor(e,t,i,n){this.filesService=e,this.imagesService=t,this.tagsService=i,this.authService=n,this.images=[],this.tags=[],this.loading=!1,this.uploadType=f.b?"cloud_upload":"local_upload",this.uploadProgress=0,this.isCloud=f.b,this.filesService.filesUpdated.subscribe(e=>{this.images=e}),this.tagsService.tagsSelected.subscribe(e=>{this.tags=e}),this.filesService.uploadProgress.subscribe(e=>{this.uploadProgress=e})}ngOnInit(){}uploadImages(){return Object(Ge.a)(this,void 0,void 0,function*(){this.imagesService.photographerData.id||"ADMIN_ROLE"!=this.authService.user.role?(this.loading=!0,"local_upload"===this.uploadType?this.filesService.uploadImages(this.images).subscribe(e=>{var t;(null==e?void 0:e.body)&&(null===(t=e.body)||void 0===t?void 0:t.imagesSaved)&&this.saveImagesData(e.body.imagesSaved)},e=>{this.loading=!1,q.a.fire("Error","Ha ocurrido un error al cargar las imagenes","error"),console.log(e)}):this.cloudUpload()):q.a.fire("Error","Debes seleccionar un fot\xf3grafo","error")})}cloudUpload(){this.filesService.cloudUpload(this.images).subscribe(e=>{var t;(null==e?void 0:e.body)&&(null===(t=e.body)||void 0===t?void 0:t.imagesSaved)&&this.saveImagesData(e.body.imagesSaved,!0)},e=>{this.loading=!1,q.a.fire("Error","Ha ocurrido un error al cargar las imagenes","error"),console.log(e)})}updateTags(e){return new Promise((t,i)=>{const n=this.tagsService.updateTags(this.tags,e).subscribe(e=>{n.unsubscribe(),t(e)},e=>{console.log(e),t(e)})})}uploadFinished(e,t){q.a.fire("Correcto",this.filesService.uploadIndex+" Imagenes subidas correctamente","success"),this.images=[],this.filesService.filesUploaded.emit("uploaded"),this.filesService.uploadIndex=0,this.loading=!1,this.tags=[],this.tagsService.resetTags.emit(!0),e&&q.a.fire("Errores registrados:",e,"error")}saveImagesData(e,t=!1){return Object(Ge.a)(this,void 0,void 0,function*(){let i=[];for(let n=0;n<Object.keys(e).length;n++){const a=Object.keys(e)[n],r=this.filesService.imagesData[a];r.fileName=e[a],r.copyFileName="copy-"+e[a],r.tags=this.tags,r.imgSync=!1,r.wasCloud=t,i.push(this.saveImage(r)),n%100==0&&(yield Promise.all(i),i=[])}console.log("processing last images, length: ",i.length),yield Promise.all(i),this.uploadFinished(null,e)})}saveImage(e){return new Promise((t,i)=>Object(Ge.a)(this,void 0,void 0,function*(){try{yield this.imagesService.saveImage(e).toPromise(),this.filesService.uploadIndex++,t(e)}catch(n){console.log(n),i(n)}}))}}return e.\u0275fac=function(t){return new(t||e)(o.Jb($e.a),o.Jb(C),o.Jb(N.a),o.Jb(x.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-add-images"]],decls:19,vars:3,consts:[[1,"container-fluid"],[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"photographer"],[1,"tags"],["class","loading-bar",4,"ngIf"],["class","upload-options",4,"ngIf"],[1,"upload-images-btn","mt-4"],[1,"btn","btn-secondary","upload-icon",3,"disabled","click"],["icon","upload"],[1,"loading-bar"],[1,"fa","fa-spinner","fa-spin"],[1,"row","upload-status","mt-2"],[1,"upload-options"],[1,"form-group","mb-0"],[1,"d-flex"],["type","radio","name","uploadType","id","local_upload","value","local_upload",3,"ngModel","ngModelChange"],["for","local_upload",1,"ml-1"],[1,"form-group","mb-0","ml-3"],["type","radio","name","uploadType","id","cloud_upload","value","cloud_upload",3,"ngModel","ngModelChange"],["for","cloud_upload",1,"ml-1"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"div",3),o.Ob(4,"div",4),o.Ob(5,"h5"),o.rc(6,"Cargar im\xe1genes"),o.Nb(),o.Nb(),o.Ob(7,"div",5),o.Kb(8,"app-upload-images"),o.Ob(9,"div",6),o.Kb(10,"app-select-photographer"),o.Nb(),o.Ob(11,"div",7),o.Kb(12,"app-tags-selector"),o.qc(13,ot,8,2,"div",8),o.Nb(),o.qc(14,st,15,2,"div",9),o.Ob(15,"div",10),o.Ob(16,"button",11),o.Vb("click",function(){return t.uploadImages()}),o.rc(17," Subir im\xe1genes "),o.Kb(18,"app-feather-icons",12),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&e&&(o.xb(13),o.cc("ngIf",t.loading),o.xb(1),o.cc("ngIf",!t.isCloud),o.xb(2),o.cc("disabled",0==t.images.length))},directives:[We,rt,U,n.m,F.a,k.m,k.a,k.i,k.k],styles:[".upload-images-btn[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:40px}.upload-images-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;max-width:200px}.loading-bar[_ngcontent-%COMP%]{position:fixed;background-color:#fff;flex-direction:column}"]}),e})();var gt=i("Gkrs"),lt=i("qv1T");let bt=(()=>{class e{constructor(e,t){this.cartService=e,this.parametersService=t,this.cartItems=[],this.total=0,this.getCart(),this.cartService.cartUpdated.subscribe(()=>{this.getCart()})}ngOnInit(){}getCart(){this.cartService.getCart().subscribe(e=>{this.cartItems=e.cart.products,this.getTotal()})}getParameters(){return new Promise((e,t)=>{this.parametersService.getParameters().subscribe(t=>{this.parameters=t.parameters,e(t.parameters)})})}getTotal(){this.total=0,this.getParameters().then(()=>{this.cartItems.forEach(e=>{this.total+=this.parameters.unityPrice*e.quantity})})}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(M.a),o.Jb(gt.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-cart-detail"]],decls:1,vars:1,consts:[[3,"isHeader"]],template:function(e,t){1&e&&o.Kb(0,"app-cart",0),2&e&&o.cc("isHeader",!1)},directives:[lt.a],styles:[""]}),e})();const dt=function(e){return{"img-vertical":e}};function ht(e,t){if(1&e&&(o.Ob(0,"div",8),o.Ob(1,"div",19),o.Kb(2,"img",20),o.Nb(),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngClass",o.fc(3,dt,(null==e.image||null==e.image.exifData?null:e.image.exifData.Orientation)&&e.image.exifData.Orientation>=5)),o.xb(1),o.cc("src",e.image.fullpath,o.mc)("ngClass",3==e.image.exifData.Orientation?"rotate-180":6==e.image.exifData.Orientation?"rotate-90":8==e.image.exifData.Orientation?"rotate-270":2==e.image.exifData.Orientation||4==e.image.exifData.Orientation?"flip-180":"noclass")}}function ut(e,t){if(1&e&&(o.Ob(0,"div",21),o.rc(1),o.Zb(2,"number"),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.tc(" $",o.bc(2,1,e.parameters&&e.parameters.unityPrice?e.parameters.unityPrice:0,"1.2-2")," ")}}function mt(e,t){if(1&e&&(o.Ob(0,"span",24),o.rc(1),o.Nb()),2&e){const e=t.$implicit;o.xb(1),o.tc(" ",e," ")}}function pt(e,t){if(1&e&&(o.Ob(0,"div",22),o.qc(1,mt,2,1,"span",23),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngForOf",e.image.tags)}}function ft(e,t){1&e&&(o.Ob(0,"div",25),o.Kb(1,"i",26),o.Nb())}function Ot(e,t){if(1&e){const e=o.Pb();o.Ob(0,"button",30),o.Vb("click",function(){o.kc(e);const t=o.Yb(2);return t.addToCart(t.image._id)}),o.Kb(1,"i",34),o.rc(2," Agregar al carrito "),o.Nb()}if(2&e){const e=o.Yb(2);o.cc("disabled",e.loading)}}function vt(e,t){if(1&e&&(o.Ob(0,"button",35),o.rc(1," Agregado al carrito "),o.Kb(2,"app-feather-icons",36),o.Nb()),2&e){const e=o.Yb(2);o.cc("disabled",e.loading),o.xb(2),o.cc("icon","check")}}function xt(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",27),o.qc(1,Ot,3,1,"button",28),o.qc(2,vt,3,2,"button",29),o.Ob(3,"button",30),o.Vb("click",function(){o.kc(e);const t=o.Yb();return t.addToCart(t.image._id,!0)}),o.Kb(4,"i",31),o.rc(5," Comprar ahora "),o.Nb(),o.Ob(6,"a",32),o.Vb("click",function(){o.kc(e);const t=o.Yb();return t.markAsFavorite(t.image._id,!0)}),o.Kb(7,"i",33),o.rc(8),o.Nb(),o.Nb()}if(2&e){const e=o.Yb();o.xb(1),o.cc("ngIf",e.image&&e.cart.indexOf(e.image._id)<0),o.xb(1),o.cc("ngIf",e.image&&e.cart.indexOf(e.image._id)>=0),o.xb(1),o.cc("disabled",e.loading),o.xb(3),o.cc("disabled",e.loading),o.xb(2),o.tc(" ",e.authService.user&&e.image&&e.authService.user.favorites.indexOf(e.image._id)>=0?"En favoritas":"Agregar a favoritas"," ")}}function Pt(e,t){if(1&e){const e=o.Pb();o.Ob(0,"button",37),o.Vb("click",function(){return o.kc(e),o.Yb().setNextImagenIndex(-1)}),o.Kb(1,"i",38),o.rc(2," Anterior "),o.Nb()}}function Ct(e,t){if(1&e){const e=o.Pb();o.Ob(0,"button",39),o.Vb("click",function(){return o.kc(e),o.Yb().setNextImagenIndex(1)}),o.rc(1," Siguiente "),o.Kb(2,"i",40),o.Nb()}}let Nt=(()=>{class e{constructor(e,t,i,n,a,r,o,s,c,g,l){var b,d;this.parametersService=e,this.cartService=t,this.route=i,this.router=n,this.profileService=a,this.authService=r,this.galleryService=o,this.paginationService=s,this.imgFiltersService=c,this.backToService=g,this.imagesService=l,this.loading=!1,this.cart=null,this.imageIndex=0,this.imagesAmountOnPage=0,this.currentPage=1,this.lastPage=1,this.isImageOnFavorites=!1,this.isImageOnPurchases=!1,(null===(d=null===(b=this.imgFiltersService)||void 0===b?void 0:b.lastSeenImg)||void 0===d?void 0:d._id)?this.imageIndex=this.galleryService.imagesId.indexOf(this.imgFiltersService.lastSeenImg._id):this.router.navigate([this.backToService.backTo]),this.isImageOnFavorites=this.imgFiltersService.filters.favorites.active,this.isImageOnPurchases=this.imgFiltersService.filters.purchases.active,this.imagesAmountOnPage=this.galleryService.imagesId.length,this.currentPage=this.isImageOnFavorites||this.isImageOnPurchases?1:this.imgFiltersService.paginationData.actualPage,this.lastPage=this.isImageOnFavorites||this.isImageOnPurchases?1:this.imgFiltersService.paginationData.pages[this.imgFiltersService.paginationData.pages.length-1],this.route.params.subscribe(e=>{this.productId=e.productId,this.image=this.imgFiltersService.lastSeenImg,this.galleryService.setGalleryIndex(this.productId),this.getParameters(),this.authService.user&&"CLIENT_ROLE"===this.authService.user.role&&this.getCart(),this.loading=!1})}goHomePage(){this.router.navigate([this.backToService.backTo])}refreshData(){this.galleryService.imagesId.length||this.galleryService.getDataIfExists(),this.galleryService.setGalleryIndex(this.productId)}getParameters(){this.parametersService.getParameters().subscribe(e=>{this.parameters=e.parameters})}getCart(){this.cart=[],this.cartService.getCart().subscribe(e=>{e.cart.products.forEach(e=>{this.cart.push(e._id)})})}addToCart(e,t=!1){if(!this.loading){if(!this.authService.user)return q.a.fire({title:"Debes iniciar sesi\xf3n para poder agregar al carrito",icon:"warning"}),void this.router.navigate(["/login"]);this.loading=!0,this.cartService.addToCart(e).subscribe(i=>{this.cartService.cartUpdated.emit(e),this.loading=!1,this.markAsFavorite(e,!1),t?this.router.navigate(["/checkout"],{queryParams:{fromProductDetail:!0}}):this.getCart()},e=>this.loading=!1)}}getUserProfile(e=!1){this.profileService.getUserProfile().subscribe(t=>{if(e){const e=JSON.parse(localStorage.getItem("user"));e.favorites=t.user.favorites,this.authService.saveInStorage(e,this.authService.token,this.authService.tokenExpiration)}})}markAsFavorite(e,t=!0){if(!this.authService.user)return q.a.fire({title:"Debes iniciar sesi\xf3n para poder marcar como favorito",icon:"warning"}),void this.router.navigate(["/login"]);let i=this.authService.user.favorites;const n=i.indexOf(e);n>=0&&t&&i.splice(n,1),n<0&&i.push(e),this.profileService.editProfile({email:this.authService.user.email,favorites:i}).subscribe(e=>{this.getUserProfile(!0)})}setNextImagenIndex(e){if(this.loading=!0,this.imageIndex=this.galleryService.imagesId.indexOf(this.productId),this.imageIndex=this.imageIndex+e,this.imageIndex===this.imagesAmountOnPage||this.imageIndex<0){const t=this.imageIndex===this.imagesAmountOnPage;this.currentPage=0!=this.imageIndex||t?this.currentPage+e:this.currentPage,this.paginationService.handlePagination(this.currentPage),this.imagesService.getImagesClient(this.imgFiltersService.filters).subscribe(e=>{const i=e.images;i.forEach(e=>{e.fullpath=e.copyFileName}),this.imagesAmountOnPage=i.length,this.imageIndex=this.imageIndex<0?this.imagesAmountOnPage-1:t?0:this.imageIndex,this.galleryService.setData(i,this.imgFiltersService.filters),this.galleryService.setActualPage(this.currentPage),this.processNextImage()})}else this.processNextImage()}processNextImage(){this.galleryService.setGalleryIndex(this.galleryService.imagesId[this.imageIndex]);const e=this.galleryService.imagesId[this.galleryService.imageIndex];this.imgFiltersService.lastSeenImg=this.galleryService.images.filter(t=>t._id===e)[0],this.router.navigate(["producto",e])}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(gt.a),o.Jb(M.a),o.Jb(s.a),o.Jb(s.f),o.Jb(G),o.Jb(x.a),o.Jb(y),o.Jb(P.a),o.Jb(_.a),o.Jb(w),o.Jb(C))},e.\u0275cmp=o.Db({type:e,selectors:[["app-product-detail"]],decls:45,vars:13,consts:[[1,"container-fluid"],[1,"card"],[1,"card-body"],[1,"go-back"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-arrow-left"],[1,"row","product-page-main"],["class","col-xl-6",4,"ngIf"],[1,"col-xl-6"],[1,"product-page-details"],["class","product-price",4,"ngIf"],[1,"product-page-width"],[1,"txt-success","pl-1"],["class","tag-list mt-2",4,"ngIf"],["class","loading",4,"ngIf"],["class","m-t-15 final-btns",4,"ngIf"],[3,"ngClass"],["class","btn btn-primary prev",3,"click",4,"ngIf"],["class","btn btn-primary next",3,"click",4,"ngIf"],[1,"product-img","d-flex","justify-content-center",3,"ngClass"],[2,"max-width","100%",3,"src","ngClass"],[1,"product-price"],[1,"tag-list","mt-2"],["class","badge badge-pill tagProduct",4,"ngFor","ngForOf"],[1,"badge","badge-pill","tagProduct"],[1,"loading"],[1,"fa","fa-spinner","fa-spin"],[1,"m-t-15","final-btns"],["class","btn btn-primary m-r-10","type","button","title","",3,"disabled","click",4,"ngIf"],["routerLink","/carrito","class","btn btn-success mr-2 minify-feather mb-1",3,"disabled",4,"ngIf"],["type","button","title","",1,"btn","btn-primary","m-r-10",3,"disabled","click"],[1,"fa","fa-shopping-cart","mr-1"],[1,"btn","btn-secondary","add-to-favorites",3,"disabled","click"],[1,"fa","fa-star","mr-1"],[1,"fa","fa-shopping-basket","mr-1"],["routerLink","/carrito",1,"btn","btn-success","mr-2","minify-feather","mb-1",3,"disabled"],[3,"icon"],[1,"btn","btn-primary","prev",3,"click"],[1,"fa","fa-chevron-left","pr-1"],[1,"btn","btn-primary","next",3,"click"],[1,"fa","fa-chevron-right","pl-1"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"div"),o.Ob(2,"div",1),o.Ob(3,"div",2),o.Ob(4,"div",3),o.Ob(5,"a",4),o.Vb("click",function(){return t.goHomePage()}),o.Kb(6,"i",5),o.rc(7," Volver "),o.Nb(),o.Nb(),o.Ob(8,"div",6),o.qc(9,ht,3,5,"div",7),o.Ob(10,"div",8),o.Ob(11,"div",9),o.Ob(12,"h3"),o.rc(13,"Foto Digital"),o.Nb(),o.Nb(),o.qc(14,ut,3,4,"div",10),o.Kb(15,"hr"),o.Ob(16,"div"),o.Ob(17,"table",11),o.Ob(18,"tbody"),o.Ob(19,"tr"),o.Ob(20,"td"),o.Ob(21,"b"),o.rc(22,"Fecha:"),o.Nb(),o.Nb(),o.Ob(23,"td"),o.rc(24),o.Zb(25,"date"),o.Nb(),o.Nb(),o.Ob(26,"tr"),o.Ob(27,"td"),o.Ob(28,"b"),o.rc(29,"Fotografo:"),o.Nb(),o.Nb(),o.Ob(30,"td",12),o.rc(31),o.Nb(),o.Nb(),o.Ob(32,"tr"),o.Ob(33,"td"),o.Ob(34,"b"),o.rc(35,"Tags:"),o.Nb(),o.Nb(),o.Ob(36,"td"),o.qc(37,pt,2,1,"div",13),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Kb(38,"hr"),o.qc(39,ft,2,0,"div",14),o.qc(40,xt,9,5,"div",15),o.Nb(),o.Nb(),o.Ob(41,"div"),o.Ob(42,"div",16),o.qc(43,Pt,3,0,"button",17),o.qc(44,Ct,3,0,"button",18),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&e&&(o.xb(9),o.cc("ngIf",t.image),o.xb(5),o.cc("ngIf",!t.authService.user||"CLIENT_ROLE"==t.authService.user.role),o.xb(10),o.sc(o.bc(25,10,null==t.image?null:t.image.creationDate,"dd/MM/yyyy HH:mm:ss")),o.xb(7),o.sc(null==t.image||null==t.image.photographerData?null:t.image.photographerData.name),o.xb(6),o.cc("ngIf",(null==t.image?null:t.image.tags)&&(null==t.image.tags?null:t.image.tags.length)>0),o.xb(2),o.cc("ngIf",t.loading),o.xb(1),o.cc("ngIf",t.cart&&t.image&&!(t.authService.user&&t.authService.user.purchases.indexOf(t.image._id)>=0)),o.xb(2),o.cc("ngClass",t.image&&8==t.image.exifData.Orientation?"increse-margin":""),o.xb(1),o.cc("ngIf",t.imageIndex>0||t.currentPage>1),o.xb(1),o.cc("ngIf",t.imageIndex<t.imagesAmountOnPage-1||t.currentPage<t.lastPage))},directives:[n.m,n.k,n.l,s.g,F.a],pipes:[n.e,n.f],styles:[".card[_ngcontent-%COMP%]{min-height:70vh!important}.tagProduct[_ngcontent-%COMP%]{background-color:#8f9aa5;color:#fff}.product-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{box-shadow:1px 1px 3px #000;padding:5px;border-radius:5px}.img-vertical[_ngcontent-%COMP%]{margin-top:50px}.img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:500px!important}.increse-margin[_ngcontent-%COMP%]{margin-top:81px}button.next[_ngcontent-%COMP%]{float:right}@media screen and (max-width:1785px){.final-btns[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-top:12px}}@media screen and (max-width:1500px){.img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:400px!important}}@media screen and (max-width:1200px){.img-vertical[_ngcontent-%COMP%]{margin:60px 0}}@media screen and (max-width:500px){.final-btns[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.final-btns[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:block;width:100%}}"]}),e})();var Mt=i("SqMf"),yt=i("24vF"),It=i("uQub");let _t=(()=>{class e{constructor(e,t){this.http=e,this.authService=t,this.refreshMpButton=new o.n}placerOrder(e){let t=f.a+"/checkout/mercadopago/qr/";return t+=this.authService.user._id,t+="?token="+this.authService.token,this.http.post(t,e)}generatePreference(e){let t=f.a+"/checkout/mercadopago/preference/";return t+=this.authService.user._id,t+="?token="+this.authService.token,this.http.post(t,e)}parseProducts(e){let t=[],i=[];e.products.forEach(n=>{t.push({title:"Imagen fotiar",description:"Imagen fotiar",unit_price:e.unityPrice,quantity:n.quantity,unit_measure:"unit",total_amount:e.total}),i.push(n.imageId._id)});const n=this.addDiscounts(e);return{items:[...t,...n],imageIds:i}}addDiscounts(e){return e.discounts.map(e=>({title:e.title,unit_price:-1*e.discountAmount,unit_measure:"unit",quantity:1}))}}return e.\u0275fac=function(t){return new(t||e)(o.Sb(v.b),o.Sb(x.a))},e.\u0275prov=o.Fb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function St(e,t){if(1&e&&(o.Ob(0,"li"),o.rc(1),o.Ob(2,"span"),o.rc(3),o.Zb(4,"number"),o.Nb(),o.Nb()),2&e){const e=t.$implicit,i=o.Yb();o.xb(1),o.tc(" Foto \xd7 ",e.quantity," "),o.xb(2),o.tc("$",o.bc(4,2,i.data.unityPrice,"1.2-2"),"")}}function wt(e,t){if(1&e&&(o.Ob(0,"li"),o.rc(1),o.Ob(2,"span",23),o.rc(3),o.Zb(4,"number"),o.Nb(),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.tc(" ",e.comboDiscount.title," "),o.xb(2),o.tc("- $",o.bc(4,2,e.comboDiscount.discountAmount,"1.2-2"),"")}}function kt(e,t){if(1&e&&(o.Ob(0,"li"),o.rc(1),o.Ob(2,"span",23),o.rc(3),o.Zb(4,"number"),o.Nb(),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.uc(" ",e.couponApplied.title," - ",e.couponApplied.percentage,"%OFF "),o.xb(2),o.tc("- $",o.bc(4,3,e.couponApplied.discountAmount,"1.2-2"),"")}}let Dt=(()=>{class e{constructor(e,t,i,n,a,r,o,s,c){var g,l;this.cartService=e,this.parametersService=t,this.authService=i,this.checkoutService=n,this.comboDiscountsService=a,this.couponsService=r,this.mercadopagoService=o,this.router=s,this.route=c,this.data={products:[],discounts:[],paymentOption:"cashier",subtotal:0,total:0,email:null===(l=null===(g=this.authService)||void 0===g?void 0:g.user)||void 0===l?void 0:l.email,unityPrice:0},this.couponCode=null,this.activeCoupon=null,this.comboDiscount=null,this.couponApplied=null,this.cardNotValid=!1,this.loading=!1,this.callIsCommingFromDetail=!1,this.loading=!0,this.getCart()}ngOnInit(){}commingFromDetail(){this.route.queryParamMap.subscribe(e=>{this.callIsCommingFromDetail="true"==e.get("fromProductDetail")}),this.callIsCommingFromDetail&&q.a.fire({title:"\xbfComo deseas pagar?",text:"Puedes elegir entre el pago manual o pago con tarjeta",icon:"question",showCancelButton:!0,allowOutsideClick:!1,confirmButtonText:"Tarjeta",cancelButtonText:"Manual"}).then(e=>{e.isConfirmed?(this.data.paymentOption="mercadopago",this.placeOrder()):(this.data.paymentOption="cashier",this.placeOrder())})}getCart(){this.cartService.getCart().subscribe(e=>{this.data.products=e.cart.products,0==this.data.products.length&&(q.a.fire("Error","Tu carrito se encuentra vac\xedo","error"),this.router.navigate(["/"])),this.getParameters()})}getParameters(){this.parametersService.getParameters().subscribe(e=>{this.data.unityPrice=e.parameters.unityPrice,this.getTotals()})}getTotals(){return Object(Ge.a)(this,void 0,void 0,function*(){this.data.subtotal=0,this.data.products.forEach(e=>{this.data.subtotal+=this.data.unityPrice*e.quantity}),yield this.checkComboDiscounts()})}checkComboDiscounts(){return Object(Ge.a)(this,void 0,void 0,function*(){const e=this.checkoutService.getImagesAmount(this.data),{discountApplies:t,discountAmount:i}=yield this.comboDiscountsService.checkIfDiscountApplies(e);if(t){const{total:t}=this.checkoutService.applyDiscount(this.data.subtotal,i);this.data.total=t;const n={type:"imagesAmount",title:`Descuento por ${e} im\xe1genes`,discountAmount:i};this.data.discounts.push(n),this.comboDiscount=n}else this.data.total=this.data.subtotal;this.loading=!1,this.commingFromDetail()})}applyCoupon(){this.couponCode&&!this.activeCoupon&&this.couponsService.getCouponByCode(this.couponCode).subscribe(e=>{if(!e.coupon)return void q.a.fire("Error","No existe un cup\xf3n con ese c\xf3digo","error");this.activeCoupon=e.coupon;const{total:t,discountAmount:i}=this.checkoutService.applyCoupon(this.data.total,this.activeCoupon.discountPercentage);this.data.total=t;const n={type:"coupon",title:this.activeCoupon.title,percentage:this.activeCoupon.discountPercentage,discountAmount:i};this.data.discounts.push(n),this.couponApplied=n})}placeOrder(){switch(this.loading=!0,this.data.paymentOption){case"mercadopago":this.generatePreference().then(e=>{window.location.href=e,this.loading=!1});break;case"paypal":break;default:const e=Object.assign(Object.assign({},this.data),{imageIds:this.checkoutService.getImagesId(this.data.products)});this.checkoutService.placeCashierOrder(e).subscribe(e=>{this.orderPlaced()},e=>{q.a.fire("Error","Ha ocurrido un error en la transacci\xf3n","error")}),this.loading=!1}}orderPlaced(){this.loading=!1,this.cartService.cartUpdated.emit("cart updated"),q.a.fire("Correcto","Orden creada correctamente, acercate a la caja para concretarla","success"),this.router.navigate(["/"])}generatePreference(){return new Promise((e,t)=>{const{items:i,imageIds:n}=this.mercadopagoService.parseProducts(this.data),a=Object.assign(Object.assign({},this.data),{amount:this.data.total,items:i,imageIds:n});this.mercadopagoService.generatePreference(a).subscribe(t=>{e(t.initPoint)},e=>{t(e)})})}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(M.a),o.Jb(gt.a),o.Jb(x.a),o.Jb(Mt.a),o.Jb(yt.a),o.Jb(It.a),o.Jb(_t),o.Jb(s.f),o.Jb(s.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-checkout"]],decls:57,vars:21,consts:[[1,"container-fluid"],[1,"card"],[1,"card-header"],[1,"card-body","checkout"],[1,"row"],[1,"col-lg-6","col-lg-12"],[1,"checkout-details"],[1,"order-box"],[1,"details"],[1,"payment-group"],[1,"payment-method-title"],[1,"payment-method-item-group"],[1,"payment-method-item"],["for","payment-cashier"],["id","payment-cashier","type","radio","name","payment",3,"value","ngModel","checked","ngModelChange"],["for","payment-mercadopago"],["id","payment-mercadopago","type","radio","name","payment",3,"ngModel","value","disabled","ngModelChange"],[1,"results-group"],[1,"title-box"],[1,"checkbox-title"],[1,"qty"],[4,"ngFor","ngForOf"],[1,"sub-total"],[1,"count"],[1,"discounts","sub-total"],[4,"ngIf"],[1,"sub-total","total"],[1,"coupon-section"],["name","couponCode","type","text","placeholder","Ingresar c\xf3digo",1,"form-control",3,"ngModel","disabled","keyup.enter","ngModelChange"],[1,"btn","btn-primary",3,"disabled","click"],[1,"fa","fa-angle-right"],[1,"text-right"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"h5"),o.rc(4,"Detalles de facturaci\xf3n"),o.Nb(),o.Nb(),o.Ob(5,"div",3),o.Ob(6,"div",4),o.Ob(7,"div",5),o.Ob(8,"div",6),o.Ob(9,"div",7),o.Ob(10,"div",8),o.Ob(11,"div",9),o.Ob(12,"div",10),o.rc(13,"M\xe9todo de pago"),o.Nb(),o.Ob(14,"div",11),o.Ob(15,"div",12),o.Ob(16,"label",13),o.rc(17," Pago Manual "),o.Nb(),o.Ob(18,"input",14),o.Vb("ngModelChange",function(e){return t.data.paymentOption=e}),o.Nb(),o.Nb(),o.Nb(),o.Ob(19,"div",11),o.Ob(20,"div",12),o.Ob(21,"label",15),o.rc(22," Pago con Tarjeta "),o.Nb(),o.Ob(23,"input",16),o.Vb("ngModelChange",function(e){return t.data.paymentOption=e}),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(24,"div",17),o.Ob(25,"div",18),o.Ob(26,"div",19),o.Ob(27,"h4"),o.rc(28,"Productos "),o.Nb(),o.Ob(29,"span"),o.rc(30,"Total"),o.Nb(),o.Nb(),o.Nb(),o.Ob(31,"ul",20),o.qc(32,St,5,5,"li",21),o.Nb(),o.Ob(33,"ul",22),o.Ob(34,"li"),o.rc(35,"Subtotal "),o.Ob(36,"span",23),o.rc(37),o.Zb(38,"number"),o.Nb(),o.Nb(),o.Nb(),o.Ob(39,"ul",24),o.qc(40,wt,5,5,"li",25),o.qc(41,kt,5,6,"li",25),o.Nb(),o.Ob(42,"ul",26),o.Ob(43,"li"),o.rc(44,"Total "),o.Ob(45,"span",23),o.rc(46),o.Zb(47,"number"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(48,"div",27),o.Ob(49,"h6"),o.rc(50,"Aplicar cup\xf3n"),o.Nb(),o.Ob(51,"input",28),o.Vb("keyup.enter",function(){return t.applyCoupon()})("ngModelChange",function(e){return t.couponCode=e}),o.Nb(),o.Ob(52,"button",29),o.Vb("click",function(){return t.applyCoupon()}),o.Kb(53,"i",30),o.Nb(),o.Nb(),o.Ob(54,"div",31),o.Ob(55,"button",29),o.Vb("click",function(){return t.placeOrder()}),o.rc(56," Realizar compra "),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&e&&(o.xb(18),o.cc("value","cashier")("ngModel",t.data.paymentOption)("checked","cashier"===t.data.paymentOption),o.xb(5),o.cc("ngModel",t.data.paymentOption)("value","mercadopago")("disabled",t.data.total<=0),o.xb(9),o.cc("ngForOf",t.data.products),o.xb(5),o.tc("$",o.bc(38,15,t.data.subtotal,"1.2-2"),""),o.xb(3),o.cc("ngIf",t.comboDiscount),o.xb(1),o.cc("ngIf",t.couponApplied),o.xb(5),o.tc("$",o.bc(47,18,t.data.total,"1.2-2"),""),o.xb(5),o.cc("ngModel",t.couponCode)("disabled",t.activeCoupon),o.xb(1),o.cc("disabled",t.activeCoupon),o.xb(3),o.cc("disabled",t.loading||t.data.products.length<=0))},directives:[k.m,k.a,k.i,k.k,n.l,n.m],pipes:[n.f],styles:[".discounts[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-weight:300!important}.discounts[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{left:-1rem}.input-error[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-color:red!important}.input-error[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:red!important;margin-top:5px;margin-left:2px}.coupon-section[_ngcontent-%COMP%]{margin:20px 0;display:flex;align-items:center;flex-wrap:wrap}.coupon-section[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{white-space:nowrap;margin-right:15px;margin-bottom:0}.coupon-section[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:180px;border-radius:4px 0 0 4px}.coupon-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0 4px 4px 0;height:calc(1.5em + .75rem + 5px)}.coupon-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:23px}.details[_ngcontent-%COMP%]{display:flex}.details[_ngcontent-%COMP%]   .results-group[_ngcontent-%COMP%]{width:40%}.details[_ngcontent-%COMP%]   .payment-group[_ngcontent-%COMP%]{width:50%;margin-right:10%}.details[_ngcontent-%COMP%]   .payment-group[_ngcontent-%COMP%]   .payment-method-title[_ngcontent-%COMP%]{font-size:22px;padding:10px 0;font-weight:600}.details[_ngcontent-%COMP%]   .payment-group[_ngcontent-%COMP%]   .payment-method-item-group[_ngcontent-%COMP%]{margin-bottom:20px;padding:20px;cursor:pointer;box-shadow:2px 2px 10px 0 rgba(0,0,0,.12);border-radius:5px}.details[_ngcontent-%COMP%]   .payment-group[_ngcontent-%COMP%]   .payment-method-item[_ngcontent-%COMP%]{display:flex}.details[_ngcontent-%COMP%]   .payment-group[_ngcontent-%COMP%]   .payment-method-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:100%;cursor:pointer}.details[_ngcontent-%COMP%]   .payment-group[_ngcontent-%COMP%]   .payment-method-item[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{width:20px!important;cursor:pointer}"]}),e})(),Ft=(()=>{class e{constructor(e,t,i){this.http=e,this.authService=t,this.paginationService=i}getOrders(e){return this.http.post(f.a+"/cashier/get-orders",{filters:e,pagination:this.paginationService.paginationData}).pipe(Object(O.a)(e=>(this.paginationService.updatePagination(e.total,e.skip),e)))}markAsPayed(e){return this.http.post(f.a+"/cashier/mark-as-payed/"+e,{orderId:e})}deleteOrder(e){return this.http.delete(f.a+"/cashier/delete-order/"+e)}}return e.\u0275fac=function(t){return new(t||e)(o.Sb(v.b),o.Sb(x.a),o.Sb(P.a))},e.\u0275prov=o.Fb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Tt(e,t){1&e&&o.Kb(0,"app-feather-icons",24)}function At(e,t){1&e&&o.Kb(0,"app-feather-icons",25)}function Et(e,t){if(1&e&&(o.Ob(0,"div",21),o.qc(1,Tt,1,0,"app-feather-icons",22),o.qc(2,At,1,0,"app-feather-icons",23),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngIf",-1==e.filters.order.order),o.xb(1),o.cc("ngIf",1==e.filters.order.order)}}function qt(e,t){1&e&&o.Kb(0,"app-feather-icons",24)}function Yt(e,t){1&e&&o.Kb(0,"app-feather-icons",25)}function Vt(e,t){if(1&e&&(o.Ob(0,"div",21),o.qc(1,qt,1,0,"app-feather-icons",22),o.qc(2,Yt,1,0,"app-feather-icons",23),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngIf",-1==e.filters.order.order),o.xb(1),o.cc("ngIf",1==e.filters.order.order)}}function Rt(e,t){1&e&&o.Kb(0,"app-feather-icons",24)}function jt(e,t){1&e&&o.Kb(0,"app-feather-icons",25)}function Jt(e,t){if(1&e&&(o.Ob(0,"div",21),o.qc(1,Rt,1,0,"app-feather-icons",22),o.qc(2,jt,1,0,"app-feather-icons",23),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngIf",-1==e.filters.order.order),o.xb(1),o.cc("ngIf",1==e.filters.order.order)}}const Kt=function(e){return["/caja",e]};function Lt(e,t){if(1&e){const e=o.Pb();o.Ob(0,"tr"),o.Ob(1,"td"),o.rc(2),o.Nb(),o.Ob(3,"td"),o.rc(4),o.Zb(5,"date"),o.Nb(),o.Ob(6,"td"),o.rc(7),o.Zb(8,"number"),o.Nb(),o.Ob(9,"td",19),o.Ob(10,"div",26),o.Ob(11,"button",27),o.Vb("click",function(){o.kc(e);const i=t.$implicit;return o.Yb().markAsPayed(i)}),o.Kb(12,"app-feather-icons",28),o.rc(13," Marcar como pago "),o.Nb(),o.Ob(14,"button",29),o.Kb(15,"app-feather-icons",28),o.rc(16," Editar "),o.Nb(),o.Ob(17,"button",30),o.Vb("click",function(){o.kc(e);const i=t.$implicit;return o.Yb().deleteOrder(i)}),o.Kb(18,"app-feather-icons",28),o.rc(19," Eliminar "),o.Nb(),o.Nb(),o.Nb(),o.Nb()}if(2&e){const e=t.$implicit;o.xb(2),o.sc(e.userEmail),o.xb(2),o.sc(o.bc(5,7,e.orderDate,"dd/MM/y HH:mm:ss")),o.xb(3),o.tc("$",o.bc(8,10,e.totalAmount,"1.2-2"),""),o.xb(5),o.cc("icon","sliders"),o.xb(2),o.cc("routerLink",o.fc(13,Kt,e._id)),o.xb(1),o.cc("icon","sliders"),o.xb(3),o.cc("icon","trash")}}let Ut=(()=>{class e{constructor(e,t,i){this.cashierService=e,this.router=t,this.paginationService=i,this.filters={email:"",order:{by:"",order:1}},this.orders=[],this.paginationService.pageChanged.subscribe(e=>{this.getOrders()}),this.getOrders()}ngOnInit(){}getOrders(){this.cashierService.getOrders(this.filters).subscribe(e=>{this.orders=e.orders})}orderBy(e){this.filters.order.by==e&&(this.filters.order.order=1==this.filters.order.order?-1:1),this.filters.order.by=e,this.getOrders()}markAsPayed(e){q.a.fire({title:"\xbfEst\xe1s seguro/a?",text:"Estas a punto de marcar este pedido como pago, \xbfDeseas continuar?",icon:"question",showCancelButton:!0,confirmButtonText:"Marcar como pago",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&this.cashierService.markAsPayed(e._id).subscribe(e=>{Object(p.c)(e),this.getOrders()},e=>{console.log(e)})})}EditOrder(e){this.router.navigate(["/caja/"+e._id])}deleteOrder(e){q.a.fire({title:"\xbfEst\xe1s seguro/a?",text:"Estas a punto de eliminar este pedido, \xbfDeseas continuar?",icon:"question",showCancelButton:!0,confirmButtonText:"Eliminar pedido",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&this.cashierService.deleteOrder(e._id).subscribe(e=>{Object(p.c)(e),this.getOrders()},e=>{console.log(e)})})}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(Ft),o.Jb(s.f),o.Jb(P.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-pending-orders"]],decls:37,vars:6,consts:[[1,"container-fluid","users"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"card-body","custom-datatable"],[1,"filters","d-flex","justify-content-between","align-items-center"],[1,"row","filters-options","w-75"],[1,"col-12","col-sm-6"],[1,"form-group"],["for","filterEmail"],["name","emailFilter","type","text","id","filterEmail","placeholder","Buscar por email",1,"form-control","w-100",3,"ngModel","ngModelChange","keyup.enter"],[1,"filter-btn","mb-3","w-25","text-right"],[1,"btn","btn-secondary","w-100","minify-feather",2,"max-width","200px",3,"click"],["icon","search"],[1,"table-responsive"],[1,"table","table-striped"],["scope","col",1,"sort",3,"click"],["class","normal-sort",4,"ngIf"],[1,"text-center"],[4,"ngFor","ngForOf"],[1,"normal-sort"],["icon","chevron-up",4,"ngIf"],["icon","chevron-down",4,"ngIf"],["icon","chevron-up"],["icon","chevron-down"],[1,"buttons","d-flex","justify-content-center","flex-wrap-no","minify-feather"],[1,"btn","btn-success","mr-2",3,"click"],[3,"icon"],[1,"btn","btn-primary","mr-2",3,"routerLink"],[1,"btn","btn-danger","mr-2",3,"click"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"div",3),o.Ob(4,"div",4),o.Ob(5,"h5"),o.rc(6),o.Nb(),o.Nb(),o.Ob(7,"div",5),o.Ob(8,"div",6),o.Ob(9,"div",7),o.Ob(10,"div",8),o.Ob(11,"div",9),o.Ob(12,"label",10),o.rc(13,"Identificador cliente"),o.Nb(),o.Ob(14,"input",11),o.Vb("ngModelChange",function(e){return t.filters.email=e})("keyup.enter",function(){return t.getOrders()}),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(15,"div",12),o.Ob(16,"button",13),o.Vb("click",function(){return t.getOrders()}),o.Kb(17,"app-feather-icons",14),o.rc(18," Buscar "),o.Nb(),o.Nb(),o.Nb(),o.Ob(19,"div",15),o.Ob(20,"table",16),o.Ob(21,"thead"),o.Ob(22,"tr"),o.Ob(23,"th",17),o.Vb("click",function(){return t.orderBy("userEmail")}),o.rc(24," Usuario "),o.qc(25,Et,3,2,"div",18),o.Nb(),o.Ob(26,"th",17),o.Vb("click",function(){return t.orderBy("orderDate")}),o.rc(27," Fecha "),o.qc(28,Vt,3,2,"div",18),o.Nb(),o.Ob(29,"td",17),o.Vb("click",function(){return t.orderBy("totalAmount")}),o.rc(30," Monto "),o.qc(31,Jt,3,2,"div",18),o.Nb(),o.Ob(32,"th",19),o.rc(33," Acci\xf3n "),o.Nb(),o.Nb(),o.Nb(),o.Ob(34,"tbody"),o.qc(35,Lt,20,15,"tr",20),o.Nb(),o.Nb(),o.Nb(),o.Kb(36,"app-pagination"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&e&&(o.xb(6),o.tc("Ordenes pendientes ( ",t.paginationService.paginationData.total," )"),o.xb(8),o.cc("ngModel",t.filters.email),o.xb(11),o.cc("ngIf","userEmail"==t.filters.order.by),o.xb(3),o.cc("ngIf","orderDate"==t.filters.order.by),o.xb(3),o.cc("ngIf","totalAmount"==t.filters.order.by),o.xb(4),o.cc("ngForOf",t.orders))},directives:[k.a,k.i,k.k,F.a,n.m,n.l,D.a,s.g],pipes:[n.e,n.f],styles:[""]}),e})();var Bt=i("JIr8");let Gt=(()=>{class e{constructor(e,t,i){this.http=e,this.authService=t,this.paginationService=i}getOrders(e){const t={filters:Object.assign(Object.assign({},e),{date:{from:e.date.from?new Date(e.date.from).getTime():null,to:e.date.to?new Date(e.date.to).getTime():null}}),pagination:this.paginationService.paginationData};return this.http.post(f.a+"/orders/search",t).pipe(Object(O.a)(e=>(this.paginationService.updatePagination(e.total,e.skip),e)))}getOrder(e){return this.http.get(f.a+"/orders/"+e)}updateOrder(e){return this.http.post(f.a+"/orders/update/"+e._id,{order:e})}resetpagination(){this.paginationService.resetPagination()}getOrderCaja(e){let t=(new v.e).set("Content-Type","application/json");return this.http.get(f.a+"/orders/"+e,{headers:t}).pipe(Object(O.a)(e=>e),Object(Bt.a)(e=>Object(Ge.a)(this,void 0,void 0,function*(){return console.log(e)})))}getClientOrder(e){return this.http.post(f.a+"/orders/client/order/"+this.authService.user._id,{orderId:e})}}return e.\u0275fac=function(t){return new(t||e)(o.Sb(v.b),o.Sb(x.a),o.Sb(P.a))},e.\u0275prov=o.Fb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),$t=(()=>{class e{transform(e){return"cashier"==e?"En caja":"MercadoPago"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=o.Ib({name:"paymentMethod",type:e,pure:!0}),e})();function Ht(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",8),o.Ob(1,"div",27),o.Ob(2,"label",28),o.rc(3,"Estado"),o.Nb(),o.Ob(4,"select",29),o.Vb("ngModelChange",function(t){return o.kc(e),o.Yb().filters.status=t}),o.Ob(5,"option",30),o.rc(6,"Todos"),o.Nb(),o.Ob(7,"option",31),o.rc(8,"Pendiente"),o.Nb(),o.Ob(9,"option",32),o.rc(10,"Completada"),o.Nb(),o.Nb(),o.Nb(),o.Nb()}if(2&e){const e=o.Yb();o.xb(4),o.cc("ngModel",e.filters.status)}}function zt(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",33),o.Ob(1,"label",34),o.rc(2,"Usuario (Email o username)"),o.Nb(),o.Ob(3,"input",35),o.Vb("ngModelChange",function(t){return o.kc(e),o.Yb().filters.email=t})("keyup.enter",function(){return o.kc(e),o.Yb().getOrders()}),o.Nb(),o.Nb()}if(2&e){const e=o.Yb();o.xb(3),o.cc("ngModel",e.filters.email)}}function Zt(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",33),o.Ob(1,"label",36),o.rc(2,"N\xb0 Pedido"),o.Nb(),o.Ob(3,"input",37),o.Vb("ngModelChange",function(t){return o.kc(e),o.Yb().filters.orderId=t})("keyup.enter",function(){return o.kc(e),o.Yb().getOrders()}),o.Nb(),o.Nb()}if(2&e){const e=o.Yb();o.xb(3),o.cc("ngModel",e.filters.orderId)}}function Wt(e,t){1&e&&o.Kb(0,"app-feather-icons",41)}function Xt(e,t){1&e&&o.Kb(0,"app-feather-icons",42)}function Qt(e,t){if(1&e&&(o.Ob(0,"div",38),o.qc(1,Wt,1,0,"app-feather-icons",39),o.qc(2,Xt,1,0,"app-feather-icons",40),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngIf",-1==e.filters.order.order),o.xb(1),o.cc("ngIf",1==e.filters.order.order)}}function ei(e,t){1&e&&o.Kb(0,"app-feather-icons",41)}function ti(e,t){1&e&&o.Kb(0,"app-feather-icons",42)}function ii(e,t){if(1&e&&(o.Ob(0,"div",38),o.qc(1,ei,1,0,"app-feather-icons",39),o.qc(2,ti,1,0,"app-feather-icons",40),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngIf",-1==e.filters.order.order),o.xb(1),o.cc("ngIf",1==e.filters.order.order)}}function ni(e,t){1&e&&o.Kb(0,"app-feather-icons",41)}function ai(e,t){1&e&&o.Kb(0,"app-feather-icons",42)}function ri(e,t){if(1&e&&(o.Ob(0,"div",38),o.qc(1,ni,1,0,"app-feather-icons",39),o.qc(2,ai,1,0,"app-feather-icons",40),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngIf",-1==e.filters.order.order),o.xb(1),o.cc("ngIf",1==e.filters.order.order)}}function oi(e,t){1&e&&o.Kb(0,"app-feather-icons",41)}function si(e,t){1&e&&o.Kb(0,"app-feather-icons",42)}function ci(e,t){if(1&e&&(o.Ob(0,"div",38),o.qc(1,oi,1,0,"app-feather-icons",39),o.qc(2,si,1,0,"app-feather-icons",40),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngIf",-1==e.filters.order.order),o.xb(1),o.cc("ngIf",1==e.filters.order.order)}}function gi(e,t){1&e&&o.Kb(0,"app-feather-icons",41)}function li(e,t){1&e&&o.Kb(0,"app-feather-icons",42)}function bi(e,t){if(1&e&&(o.Ob(0,"div",38),o.qc(1,gi,1,0,"app-feather-icons",39),o.qc(2,li,1,0,"app-feather-icons",40),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngIf",-1==e.filters.order.order),o.xb(1),o.cc("ngIf",1==e.filters.order.order)}}function di(e,t){1&e&&o.Kb(0,"app-feather-icons",41)}function hi(e,t){1&e&&o.Kb(0,"app-feather-icons",42)}function ui(e,t){if(1&e&&(o.Ob(0,"div",38),o.qc(1,di,1,0,"app-feather-icons",39),o.qc(2,hi,1,0,"app-feather-icons",40),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngIf",-1==e.filters.order.order),o.xb(1),o.cc("ngIf",1==e.filters.order.order)}}const mi=function(e){return["/venta",e]},pi=function(e,t){return{"badge-warning":e,"badge-success":t}};function fi(e,t){if(1&e&&(o.Ob(0,"tr"),o.Ob(1,"td"),o.Ob(2,"a",43),o.rc(3),o.Nb(),o.Nb(),o.Ob(4,"td"),o.rc(5),o.Zb(6,"date"),o.Nb(),o.Ob(7,"td"),o.rc(8),o.Zb(9,"number"),o.Nb(),o.Ob(10,"td"),o.rc(11),o.Nb(),o.Ob(12,"td"),o.rc(13),o.Zb(14,"paymentMethod"),o.Nb(),o.Ob(15,"td"),o.Ob(16,"span",44),o.rc(17),o.Nb(),o.Nb(),o.Nb()),2&e){const e=t.$implicit;o.xb(2),o.cc("routerLink",o.fc(16,mi,e._id)),o.xb(1),o.sc(e.orderId),o.xb(2),o.sc(o.bc(6,8,e.paymentDate,"dd/MM/y")),o.xb(3),o.tc("$",o.bc(9,11,e.totalAmount,"1.2-2"),""),o.xb(3),o.sc(e.userData?e.userData.username:e.userEmail),o.xb(2),o.sc(o.ac(14,14,e.paymentMethod)),o.xb(3),o.cc("ngClass",o.gc(18,pi,"pending"==e.status,"completed"==e.status)),o.xb(1),o.tc(" ","pending"==e.status?"Pendiente":"Completada"," ")}}function Oi(e,t){if(1&e&&(o.Ob(0,"div",22),o.Ob(1,"div",23),o.Ob(2,"div",24),o.Ob(3,"h3"),o.rc(4,"Informaci\xf3n usuario"),o.Nb(),o.Nb(),o.Ob(5,"div",25),o.Ob(6,"div",26),o.Ob(7,"p"),o.Ob(8,"span",27),o.rc(9,"Nombre:"),o.Nb(),o.rc(10),o.Nb(),o.Ob(11,"p"),o.Ob(12,"span",27),o.rc(13,"Nombre usuario:"),o.Nb(),o.rc(14),o.Nb(),o.Ob(15,"p"),o.Ob(16,"span",27),o.rc(17,"Email:"),o.Nb(),o.rc(18),o.Nb(),o.Ob(19,"p"),o.Ob(20,"span",27),o.rc(21,"Observaciones:"),o.Nb(),o.rc(22),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&e){const e=o.Yb(2);o.xb(10),o.tc(" ",e.order.userData.name,""),o.xb(4),o.tc(" ",e.order.userData.username,""),o.xb(4),o.tc(" ",e.order.userData.email,""),o.xb(4),o.tc(" ",e.order.userData.observation?e.order.userData.observation:"Ninguna","")}}function vi(e,t){if(1&e){const e=o.Pb();o.Ob(0,"button",28),o.Vb("click",function(){return o.kc(e),o.Yb(2).updateOrder()}),o.Kb(1,"app-feather-icons",29),o.rc(2," Devolver a Caja "),o.Nb()}2&e&&(o.xb(1),o.cc("icon","refresh-cw"))}function xi(e,t){if(1&e&&(o.Ob(0,"tr"),o.Ob(1,"td"),o.rc(2),o.Nb(),o.Ob(3,"td"),o.rc(4),o.Nb(),o.Ob(5,"td"),o.rc(6),o.Nb(),o.Ob(7,"td"),o.rc(8),o.Nb(),o.Nb()),2&e){const e=o.Yb(2);o.xb(2),o.tc("$",e.originalImgsPrice,""),o.xb(2),o.sc(e.couponDiscount.percentage>0?"$"+e.couponDiscount.discountAmount/e.originalImgsAmount:"N/A"),o.xb(2),o.sc(e.imagesAmountDiscountPerImage>0?"$"+e.imagesAmountDiscountPerImage:"N/A"),o.xb(2),o.tc("$",e.totalPerImage,"")}}function Pi(e,t){if(1&e&&(o.Ob(0,"tr"),o.Ob(1,"td",15),o.Ob(2,"strong"),o.rc(3,"Descuento por cantidad"),o.Nb(),o.Nb(),o.Ob(4,"td",30),o.rc(5),o.Nb(),o.Nb()),2&e){const e=o.Yb(2);o.xb(5),o.tc(" -$",e.imagesAmountDiscountPerImage*e.order.images.length," ")}}function Ci(e,t){if(1&e&&(o.Ob(0,"tr"),o.Ob(1,"td",15),o.Ob(2,"strong"),o.rc(3,"Descuento por cup\xf3n"),o.Nb(),o.Nb(),o.Ob(4,"td",30),o.rc(5),o.Nb(),o.Nb()),2&e){const e=o.Yb(2);o.xb(5),o.tc(" -$",e.couponDiscount.discountAmount," ")}}function Ni(e,t){if(1&e&&(o.Ob(0,"span",40),o.rc(1),o.Nb()),2&e){const e=t.$implicit;o.xb(1),o.tc(" ",e," ")}}function Mi(e,t){if(1&e&&(o.Ob(0,"div",38),o.qc(1,Ni,2,1,"span",39),o.Nb()),2&e){const e=o.Yb().$implicit;o.xb(1),o.cc("ngForOf",e.tags)}}function yi(e,t){if(1&e&&(o.Ob(0,"div",37),o.Ob(1,"span",27),o.rc(2,"Fot\xf3grafo:"),o.Nb(),o.rc(3),o.Nb()),2&e){const e=o.Yb().$implicit;o.xb(3),o.tc(" ",e.photographerId," ")}}const Ii=function(e){return{"img-vertical":e}};function _i(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",31),o.Vb("click",function(){o.kc(e);const i=t.$implicit;return o.Yb(2).goToImage(i._id)}),o.Ob(1,"div",32),o.Kb(2,"img",33),o.Nb(),o.qc(3,Mi,2,1,"div",34),o.Ob(4,"div",35),o.qc(5,yi,4,1,"div",36),o.Ob(6,"div",37),o.Ob(7,"span",27),o.rc(8,"Fecha creaci\xf3n:"),o.Nb(),o.rc(9),o.Zb(10,"date"),o.Nb(),o.Ob(11,"div",37),o.Ob(12,"span",27),o.rc(13,"Fecha subida:"),o.Nb(),o.rc(14),o.Zb(15,"date"),o.Nb(),o.Nb(),o.Nb()}if(2&e){const e=t.$implicit,i=o.Yb(2);o.xb(1),o.cc("ngClass",o.fc(12,Ii,e.exifData.Orientation>=5)),o.xb(1),o.cc("src",e.fullpath,o.mc),o.xb(1),o.cc("ngIf",e.tags.length>0),o.xb(2),o.cc("ngIf","ADMIN_ROLE"==i.authService.user.role),o.xb(4),o.tc(" ",o.bc(10,6,e.creationDate,"dd/MM/yyyy HH:mm:ss")," "),o.xb(5),o.tc(" ",o.bc(15,9,e.uploadDate,"dd/MM/yyyy HH:mm:ss")," ")}}function Si(e,t){if(1&e&&(o.Ob(0,"div",4),o.Ob(1,"div",5),o.Ob(2,"div",6),o.Ob(3,"h2"),o.rc(4),o.Nb(),o.Kb(5,"hr"),o.Nb(),o.Nb(),o.qc(6,Oi,23,4,"div",7),o.Ob(7,"div",8),o.qc(8,vi,3,1,"button",9),o.Kb(9,"br"),o.Nb(),o.Ob(10,"div",10),o.Ob(11,"div",11),o.Ob(12,"h3"),o.rc(13,"Desglose del pedido"),o.Nb(),o.Nb(),o.Ob(14,"table",12),o.Ob(15,"thead"),o.Ob(16,"tr"),o.Ob(17,"th"),o.rc(18,"Subtotal (precio imagen)"),o.Nb(),o.Ob(19,"th"),o.rc(20,"Desc. por cup\xf3n"),o.Nb(),o.Ob(21,"th"),o.rc(22,"Desc. por cantidad"),o.Nb(),o.Ob(23,"th"),o.rc(24,"Total x img."),o.Nb(),o.Nb(),o.Nb(),o.Ob(25,"tbody"),o.qc(26,xi,9,4,"tr",13),o.Ob(27,"tr",14),o.Ob(28,"td",15),o.Ob(29,"strong"),o.rc(30,"Subtotal"),o.Nb(),o.Nb(),o.Ob(31,"td"),o.rc(32),o.Nb(),o.Nb(),o.qc(33,Pi,6,1,"tr",16),o.qc(34,Ci,6,1,"tr",16),o.Ob(35,"tr",17),o.Ob(36,"td",15),o.Ob(37,"strong"),o.rc(38,"Total"),o.Nb(),o.Nb(),o.Ob(39,"td"),o.Ob(40,"strong"),o.rc(41),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(42,"div",18),o.Ob(43,"div",19),o.Ob(44,"h3"),o.rc(45,"Imagenes adquiridas"),o.Nb(),o.Nb(),o.Ob(46,"div",20),o.qc(47,_i,16,14,"div",21),o.Nb(),o.Nb(),o.Nb()),2&e){const e=o.Yb();o.xb(4),o.tc("Pedido N\xb0 ",e.order.orderId,""),o.xb(2),o.cc("ngIf","ADMIN_ROLE"==e.authService.user.role),o.xb(2),o.cc("ngIf",e.devolvercaja),o.xb(18),o.cc("ngForOf",e.order.images),o.xb(6),o.tc("$",e.subtotal,""),o.xb(1),o.cc("ngIf",(null==e.imagesAmountDiscount?null:e.imagesAmountDiscount.discountAmount)&&e.imagesAmountDiscount.discountAmount>0),o.xb(1),o.cc("ngIf",(null==e.couponDiscount?null:e.couponDiscount.discountAmount)&&e.couponDiscount.discountAmount>0),o.xb(7),o.tc("$",e.total,""),o.xb(6),o.cc("ngForOf",e.order.images)}}function wi(e,t){if(1&e){const e=o.Pb();o.Ob(0,"tr"),o.Ob(1,"td"),o.rc(2),o.Nb(),o.Ob(3,"td"),o.rc(4),o.Nb(),o.Ob(5,"button",28),o.Vb("click",function(){o.kc(e);const i=t.$implicit;return o.Yb(2).RemoveItemDetail(i)}),o.Kb(6,"app-feather-icons",18),o.rc(7," Eliminar "),o.Nb(),o.Nb()}if(2&e){const e=o.Yb(2);o.xb(2),o.tc("$",e.originalImgsPrice,""),o.xb(2),o.tc("$",e.totalPerImage,""),o.xb(2),o.cc("icon","trash")}}function ki(e,t){if(1&e&&(o.Ob(0,"tr"),o.Ob(1,"td",22),o.Ob(2,"strong"),o.rc(3,"Descuento por cantidad"),o.Nb(),o.Nb(),o.Ob(4,"td",29),o.rc(5),o.Nb(),o.Nb()),2&e){const e=o.Yb(2);o.xb(5),o.tc(" -$",e.imagesAmountDiscountPerImage*e.order.images.length," ")}}function Di(e,t){if(1&e&&(o.Ob(0,"tr"),o.Ob(1,"td",22),o.Ob(2,"strong"),o.rc(3,"Descuento por cup\xf3n"),o.Nb(),o.Nb(),o.Ob(4,"td",29),o.rc(5),o.Nb(),o.Nb()),2&e){const e=o.Yb(2);o.xb(5),o.tc(" -%",e.couponDiscount.discountAmount," ")}}function Fi(e,t){if(1&e&&(o.Ob(0,"span",39),o.rc(1),o.Nb()),2&e){const e=t.$implicit;o.xb(1),o.tc(" ",e," ")}}function Ti(e,t){if(1&e&&(o.Ob(0,"div",37),o.qc(1,Fi,2,1,"span",38),o.Nb()),2&e){const e=o.Yb().$implicit;o.xb(1),o.cc("ngForOf",e.tags)}}function Ai(e,t){if(1&e&&(o.Ob(0,"div",36),o.Ob(1,"span",12),o.rc(2,"Fot\xf3grafo:"),o.Nb(),o.rc(3),o.Nb()),2&e){const e=o.Yb().$implicit;o.xb(3),o.tc(" ",e.photographerId," ")}}const Ei=function(e){return{"img-vertical":e}};function qi(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",30),o.Vb("click",function(){o.kc(e);const i=t.$implicit;return o.Yb(2).goToImage(i._id)}),o.Ob(1,"div",31),o.Kb(2,"img",32),o.Nb(),o.qc(3,Ti,2,1,"div",33),o.Ob(4,"div",34),o.qc(5,Ai,4,1,"div",35),o.Ob(6,"div",36),o.Ob(7,"span",12),o.rc(8,"Fecha creaci\xf3n:"),o.Nb(),o.rc(9),o.Zb(10,"date"),o.Nb(),o.Ob(11,"div",36),o.Ob(12,"span",12),o.rc(13,"Fecha subida:"),o.Nb(),o.rc(14),o.Zb(15,"date"),o.Nb(),o.Nb(),o.Nb()}if(2&e){const e=t.$implicit,i=o.Yb(2);o.xb(1),o.cc("ngClass",o.fc(12,Ei,e.exifData.Orientation>=5)),o.xb(1),o.cc("src",e.fullpath,o.mc),o.xb(1),o.cc("ngIf",e.tags.length>0),o.xb(2),o.cc("ngIf","ADMIN_ROLE"==i.authService.user.role),o.xb(4),o.tc(" ",o.bc(10,6,e.creationDate,"dd/MM/yyyy HH:mm:ss")," "),o.xb(5),o.tc(" ",o.bc(15,9,e.uploadDate,"dd/MM/yyyy HH:mm:ss")," ")}}function Yi(e,t){if(1&e){const e=o.Pb();o.Ob(0,"div",4),o.Ob(1,"div",5),o.Ob(2,"div",6),o.Ob(3,"h2"),o.rc(4),o.Nb(),o.Kb(5,"hr"),o.Nb(),o.Nb(),o.Ob(6,"div",7),o.Ob(7,"div",8),o.Ob(8,"div",9),o.Ob(9,"h3"),o.rc(10,"Informaci\xf3n usuario"),o.Nb(),o.Nb(),o.Ob(11,"div",10),o.Ob(12,"div",11),o.Ob(13,"p"),o.Ob(14,"span",12),o.rc(15,"Nombre:"),o.Nb(),o.rc(16),o.Nb(),o.Ob(17,"p"),o.Ob(18,"span",12),o.rc(19,"Nombre usuario:"),o.Nb(),o.rc(20),o.Nb(),o.Ob(21,"p"),o.Ob(22,"span",12),o.rc(23,"Email:"),o.Nb(),o.rc(24),o.Nb(),o.Ob(25,"p"),o.Ob(26,"span",12),o.rc(27,"Observaciones:"),o.Nb(),o.rc(28),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(29,"div",13),o.Ob(30,"h3"),o.rc(31,"Desglose del pedido"),o.Nb(),o.Ob(32,"table"),o.Ob(33,"tr"),o.Ob(34,"th"),o.Ob(35,"label"),o.rc(36,"Descuento Total"),o.Nb(),o.Nb(),o.Nb(),o.Ob(37,"tr"),o.Ob(38,"td"),o.Ob(39,"input",14),o.Vb("ngModelChange",function(t){return o.kc(e),o.Yb().discuountotal=t}),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(40,"div",15),o.Ob(41,"div",16),o.Ob(42,"button",17),o.Vb("click",function(){return o.kc(e),o.Yb().Recalculate()}),o.Kb(43,"app-feather-icons",18),o.rc(44," Recalcular "),o.Nb(),o.Nb(),o.Nb(),o.Ob(45,"table",19),o.Ob(46,"thead"),o.Ob(47,"tr"),o.Ob(48,"th"),o.rc(49,"Subtotal (precio imagen)"),o.Nb(),o.Ob(50,"th"),o.rc(51,"Total x img."),o.Nb(),o.Ob(52,"th"),o.rc(53,"Eliminar?"),o.Nb(),o.Nb(),o.Nb(),o.Ob(54,"tbody"),o.qc(55,wi,8,3,"tr",20),o.Ob(56,"tr",21),o.Ob(57,"td",22),o.Ob(58,"strong"),o.rc(59,"Subtotal"),o.Nb(),o.Nb(),o.Ob(60,"td"),o.rc(61),o.Nb(),o.Nb(),o.qc(62,ki,6,1,"tr",23),o.qc(63,Di,6,1,"tr",23),o.Ob(64,"tr",24),o.Ob(65,"td",22),o.Ob(66,"strong"),o.rc(67,"Total"),o.Nb(),o.Nb(),o.Ob(68,"td"),o.Ob(69,"strong"),o.rc(70),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Ob(71,"div",15),o.Ob(72,"div",16),o.Ob(73,"h3"),o.rc(74,"Imagenes adquiridas"),o.Nb(),o.Nb(),o.Ob(75,"div",25),o.qc(76,qi,16,14,"div",26),o.Nb(),o.Nb(),o.Ob(77,"div",15),o.Ob(78,"div",16),o.Ob(79,"button",17),o.Vb("click",function(){return o.kc(e),o.Yb().updateOrder()}),o.Kb(80,"app-feather-icons",18),o.rc(81," Guardar Cambios "),o.Nb(),o.Kb(82,"br"),o.Kb(83,"br"),o.Ob(84,"button",27),o.Vb("click",function(){return o.kc(e),o.Yb().volver()}),o.rc(85," Volver "),o.Nb(),o.Nb(),o.Nb(),o.Nb()}if(2&e){const e=o.Yb();o.xb(4),o.tc("Pedido N\xb0 ",e.order.orderId,""),o.xb(12),o.tc(" ",e.order.userData.name,""),o.xb(4),o.tc(" ",e.order.userData.username,""),o.xb(4),o.tc(" ",e.order.userData.email,""),o.xb(4),o.tc(" ",e.order.userData.observation?e.order.userData.observation:"Ninguna",""),o.xb(11),o.cc("ngModel",e.discuountotal),o.xb(4),o.cc("icon","refresh-cw"),o.xb(12),o.cc("ngForOf",e.order.images),o.xb(6),o.tc("$",e.subtotal,""),o.xb(1),o.cc("ngIf",(null==e.imagesAmountDiscount?null:e.imagesAmountDiscount.discountAmount)&&e.imagesAmountDiscount.discountAmount>0),o.xb(1),o.cc("ngIf",(null==e.couponDiscount?null:e.couponDiscount.discountAmount)&&e.couponDiscount.discountAmount>0),o.xb(7),o.tc("$",e.total,""),o.xb(6),o.cc("ngForOf",e.order.images),o.xb(4),o.cc("icon","save")}}function Vi(e,t){1&e&&(o.Ob(0,"div",7),o.Ob(1,"div",8),o.Kb(2,"i",9),o.Nb(),o.Ob(3,"h2"),o.rc(4,'El pago se encuentra en estado "pendiente", el tiempo de acreditaci\xf3n podr\xeda variar seg\xfan el m\xe9todo elegido'),o.Nb(),o.Nb())}function Ri(e,t){1&e&&(o.Ob(0,"div",10),o.Ob(1,"div",8),o.Kb(2,"i",11),o.Nb(),o.Ob(3,"h2"),o.rc(4,"El pago ha sido rechazado"),o.Nb(),o.Nb())}function ji(e,t){1&e&&(o.Ob(0,"div",7),o.Ob(1,"div",8),o.Kb(2,"i",12),o.Nb(),o.Ob(3,"h2"),o.rc(4,"Compra realizada con \xe9xito!"),o.Nb(),o.Nb())}function Ji(e,t){if(1&e&&(o.Ob(0,"div",2),o.qc(1,Vi,5,0,"div",3),o.qc(2,Ri,5,0,"div",4),o.qc(3,ji,5,0,"div",3),o.Ob(4,"div",5),o.Ob(5,"a",6),o.rc(6," Volver al inicio "),o.Nb(),o.Nb(),o.Nb()),2&e){const e=o.Yb();o.xb(1),o.cc("ngIf","pending"==e.status),o.xb(1),o.cc("ngIf","failure"==e.status||"rejected"==e.status),o.xb(1),o.cc("ngIf","success"==e.status)}}function Ki(e,t){1&e&&(o.Ob(0,"div",13),o.Kb(1,"i",14),o.Nb())}const Li=[{path:"",component:u,children:[{path:"",component:Ce},{path:"favoritos",component:Ce},{path:"mis-imagenes",component:Ce},{path:"mis-datos",component:ye},{path:"imagenes",component:Be},{path:"imagenes/new",component:ct},{path:"producto/:productId",component:Nt},{path:"carrito",component:bt},{path:"caja",component:Ut},{path:"checkout",component:Dt},{path:"ventas",component:(()=>{class e{constructor(e,t,i,n){this.authService=e,this.router=t,this.ordersService=i,this.paginationService=n,this.isPhotographer=!1,this.filters={date:{from:null,to:null},orderId:"",status:"completed",email:"",order:{by:"",order:1}},this.datePickerConfig={locale:"es"},this.orders=[],"ADMIN_ROLE"!==this.authService.user.role&&"PHOTOGRAPHER_ROLE"!==this.authService.user.role&&this.router.navigate(["/"]),"PHOTOGRAPHER_ROLE"==this.authService.user.role&&(this.isPhotographer=!0),this.paginationService.pageChanged.subscribe(e=>{this.getOrders(!0)}),this.getOrders()}ngOnInit(){}getOrders(e=!1){e||this.paginationService.resetPagination();const t=this.filters;this.filters.date.from&&t.date.from.startOf("day").toDate(),this.filters.date.to&&t.date.to.endOf("day").toDate(),this.ordersService.getOrders(t).subscribe(e=>{this.orders=e.orders,this.scrollToTop(),this.calculateTotals()})}orderBy(e){this.filters.order.by==e&&(this.filters.order.order=1==this.filters.order.order?-1:1),this.filters.order.by=e,this.getOrders()}calculateTotals(){this.orders.forEach(e=>{const t=e.images.length;e.images=this.getOwnedImages(e),e.totalAmount=e.subtotal/t*e.images.length,e.discounts.forEach(i=>{"imagesAmount"==i.type?e.totalAmount-=i.discountAmount/t*e.images.length:e.totalAmount=e.totalAmount*(1-i.percentage/100)})})}getOwnedImages(e){const t=this.authService.user,i=[],n=e.images;for(let a=0;a<n.length;a++){const e=n[a];e.photographerId!=t.email&&e.photographerId!=t.username&&"ADMIN_ROLE"!=t.role||i.push(e)}return i}scrollToTop(){window.scrollTo(0,0)}resetFilters(){this.filters={date:{from:null,to:null},status:"",email:"",orderId:"",order:{by:"",order:1}},this.getOrders()}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(x.a),o.Jb(s.f),o.Jb(Gt),o.Jb(P.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-orders"]],decls:58,vars:14,consts:[[1,"container-fluid","orders-list"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"card-body","custom-datatable"],[1,"filters","pb-3"],[1,"row","filters-options"],[1,"col-12","col-lg-6"],[1,"picker","w-100"],[2,"margin-right","10px"],["name","dateFrom","placeholder","Fecha desde",3,"ngModel","config","ngModelChange"],["name","dateTo","placeholder","Fecha hasta",3,"ngModel","config","ngModelChange"],["class","col-12 col-lg-6",4,"ngIf"],[1,"col-12","col-sm-6"],["class","form-group mt-2",4,"ngIf"],[1,"filter-btn","mb-3","d-flex","justify-content-end"],[1,"btn","btn-secondary","w-100","mr-2","minify-feather",2,"max-width","200px",3,"click"],["icon","search"],[1,"btn","btn-danger","reset-btn",3,"click"],["icon","x"],[1,"orders"],[1,"table-responsive"],[1,"table","table-striped"],["scope","col",1,"sort",3,"click"],["class","normal-sort",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"form-group"],["for","filterStatus"],["name","statusFilter","type","text","id","filterStatus",1,"form-control","mb-0","w-100",3,"ngModel","ngModelChange"],["value",""],["value","pending"],["value","completed"],[1,"form-group","mt-2"],["for","filterEmail"],["name","emailFilter","type","text","id","filterEmail","placeholder","buscar por usuario",1,"form-control","mb-0","w-100",3,"ngModel","ngModelChange","keyup.enter"],["for","filterOrderId"],["name","orderIdFilter","type","text","id","filterOrderId","placeholder","Buscar por pedido",1,"form-control","mb-0","w-100",3,"ngModel","ngModelChange","keyup.enter"],[1,"normal-sort"],["icon","chevron-up",4,"ngIf"],["icon","chevron-down",4,"ngIf"],["icon","chevron-up"],["icon","chevron-down"],[3,"routerLink"],[1,"badge","badge-pill",3,"ngClass"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.Ob(3,"div",3),o.Ob(4,"div",4),o.Ob(5,"h5"),o.rc(6,"Imagenes cargadas"),o.Nb(),o.Nb(),o.Ob(7,"div",5),o.Ob(8,"div",6),o.Ob(9,"div",7),o.Ob(10,"div",8),o.Ob(11,"div",9),o.Ob(12,"label",10),o.rc(13,"Desde:"),o.Nb(),o.Ob(14,"dp-date-picker",11),o.Vb("ngModelChange",function(e){return t.filters.date.from=e}),o.Nb(),o.Nb(),o.Ob(15,"div",9),o.Ob(16,"label",10),o.rc(17,"Hasta:"),o.Nb(),o.Ob(18,"dp-date-picker",12),o.Vb("ngModelChange",function(e){return t.filters.date.to=e}),o.Nb(),o.Nb(),o.Nb(),o.qc(19,Ht,11,1,"div",13),o.Nb(),o.Ob(20,"div",1),o.Ob(21,"div",14),o.qc(22,zt,4,1,"div",15),o.Nb(),o.Ob(23,"div",14),o.qc(24,Zt,4,1,"div",15),o.Nb(),o.Nb(),o.Ob(25,"div",16),o.Ob(26,"button",17),o.Vb("click",function(){return t.getOrders()}),o.Kb(27,"app-feather-icons",18),o.rc(28," Buscar "),o.Nb(),o.Ob(29,"button",19),o.Vb("click",function(){return t.resetFilters()}),o.Kb(30,"app-feather-icons",20),o.Nb(),o.Nb(),o.Nb(),o.Kb(31,"hr"),o.Ob(32,"div",21),o.Ob(33,"div",22),o.Ob(34,"table",23),o.Ob(35,"thead"),o.Ob(36,"tr"),o.Ob(37,"th",24),o.Vb("click",function(){return t.orderBy("orderId")}),o.rc(38," N\xb0 Pedido "),o.qc(39,Qt,3,2,"div",25),o.Nb(),o.Ob(40,"th",24),o.Vb("click",function(){return t.orderBy("orderDate")}),o.rc(41," Fecha creaci\xf3n "),o.qc(42,ii,3,2,"div",25),o.Nb(),o.Ob(43,"th",24),o.Vb("click",function(){return t.orderBy("totalAmount")}),o.rc(44," Importe "),o.qc(45,ri,3,2,"div",25),o.Nb(),o.Ob(46,"th",24),o.Vb("click",function(){return t.orderBy("userData.username")}),o.rc(47," Usuario "),o.qc(48,ci,3,2,"div",25),o.Nb(),o.Ob(49,"th",24),o.Vb("click",function(){return t.orderBy("paymentMethod")}),o.rc(50," M\xe9todo de pago "),o.qc(51,bi,3,2,"div",25),o.Nb(),o.Ob(52,"th",24),o.Vb("click",function(){return t.orderBy("status")}),o.rc(53," Estado "),o.qc(54,ui,3,2,"div",25),o.Nb(),o.Nb(),o.Nb(),o.Ob(55,"tbody"),o.qc(56,fi,18,21,"tr",26),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Kb(57,"app-pagination"),o.Nb(),o.Nb(),o.Nb(),o.Nb(),o.Nb()),2&e&&(o.xb(14),o.cc("ngModel",t.filters.date.from)("config",t.datePickerConfig),o.xb(4),o.cc("ngModel",t.filters.date.to)("config",t.datePickerConfig),o.xb(1),o.cc("ngIf","ADMIN_ROLE"==t.authService.user.role),o.xb(3),o.cc("ngIf","ADMIN_ROLE"==t.authService.user.role),o.xb(2),o.cc("ngIf","ADMIN_ROLE"==t.authService.user.role),o.xb(15),o.cc("ngIf","orderId"==t.filters.order.by),o.xb(3),o.cc("ngIf","paymentDate"==t.filters.order.by),o.xb(3),o.cc("ngIf","totalAmount"==t.filters.order.by),o.xb(3),o.cc("ngIf","userData.username"==t.filters.order.by),o.xb(3),o.cc("ngIf","paymentMethod"==t.filters.order.by),o.xb(3),o.cc("ngIf","status"==t.filters.order.by),o.xb(2),o.cc("ngForOf",t.orders))},directives:[T.a,k.i,k.k,n.m,F.a,n.l,D.a,k.p,k.l,k.r,k.a,s.i,n.k],pipes:[n.e,n.f,$t],styles:[""]}),e})()},{path:"venta/:orderId",component:(()=>{class e{constructor(e,t,i,n,a,r,o){this.ordersService=e,this.route=t,this.router=i,this.authService=n,this.backToService=a,this.galleryService=r,this.imgFiltersService=o,this.devolvercaja=!1,this.imagesAmountDiscount=null,this.imagesAmountDiscountPerImage=0,this.couponDiscount={percentage:0},this.originalImgsPrice=null,this.originalImgsAmount=0,this.totalPerImage=null,this.subtotal=0,this.total=0,this.backToService.backTo="/imagenes",this.route.params.subscribe(e=>{e.orderId||this.router.navigate(["/"]),this.orderId=e.orderId}),this.getOrder()}ngOnInit(){}calculateDiff(e){let t=new Date(e),i=new Date;return Math.floor((Date.UTC(i.getFullYear(),i.getMonth(),i.getDate())-Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()))/864e5)}updateOrder(){this.order.status="pending",this.ordersService.updateOrder(this.order).subscribe(e=>{this.router.navigate(["/ventas"])})}getOrder(){this.ordersService.getOrder(this.orderId).subscribe(e=>{this.order=e.order,this.originalImgsAmount=e.originalImgsAmount,this.originalImgsPrice=this.order.subtotal/e.originalImgsAmount,this.totalPerImage=this.originalImgsPrice,this.calculateTotal(),this.order.images.forEach(e=>{e.fullpath=e.copyFileName}),this.devolvercaja=this.calculateDiff(this.order.orderDate)<=7})}downloadImage(e){window.open(e.fileName,"_blank")}goToImage(e){this.imgFiltersService.lastSeenImg=this.order.images.filter(t=>t._id===e)[0],window.open(this.imgFiltersService.lastSeenImg.fileName,"_blank")}calculateTotal(){this.subtotal=this.originalImgsPrice*this.order.images.length,this.total=this.originalImgsPrice*this.order.images.length,this.order.discounts.forEach(e=>{const t=e.discountAmount/this.originalImgsAmount;"imagesAmount"==e.type?(this.imagesAmountDiscount=e,this.imagesAmountDiscountPerImage=t.toFixed(2),this.totalPerImage-=t,this.total-=t*this.order.images.length):(this.couponDiscount=e,this.totalPerImage-=t,this.total=this.total*(1-e.percentage/100))})}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(Gt),o.Jb(s.a),o.Jb(s.f),o.Jb(x.a),o.Jb(w),o.Jb(y),o.Jb(_.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-order-detail"]],decls:4,vars:1,consts:[[1,"container-fluid"],[1,"card"],[1,"card-body"],["class","row product-page-main",4,"ngIf"],[1,"row","product-page-main"],[1,"col-12"],[1,"title","mb-4","text-center"],["class","col-12 mt-4",4,"ngIf"],[1,"col-12",2,"margin-bottom","20px"],["class","btn btn-success minify-feather mb-1",3,"click",4,"ngIf"],[1,"col-12","desglose"],[1,"sub-title"],[1,"table"],[4,"ngFor","ngForOf"],[1,"subtotal"],["colspan","3",2,"text-align","right"],[4,"ngIf"],[1,"total"],[1,"col-12","mt-4","images-list"],[1,"sub-title","mt-4","mb-4"],[1,"images","mt-4"],["class","image",3,"click",4,"ngFor","ngForOf"],[1,"col-12","mt-4"],[1,"user-info","mt-4","mb-4"],[1,"sub-title","mb-4"],[1,"info"],[1,"info-row"],[1,"bold"],[1,"btn","btn-success","minify-feather","mb-1",3,"click"],[3,"icon"],[2,"position","relative","left","-5px"],[1,"image",3,"click"],[1,"thumbnail","image-owned",3,"ngClass"],["alt","",3,"src"],["class","tag-list mt-2",4,"ngIf"],[1,"image-info","mt-3"],["class","creation-date",4,"ngIf"],[1,"creation-date"],[1,"tag-list","mt-2"],["class","badge badge-pill badge-secondary",4,"ngFor","ngForOf"],[1,"badge","badge-pill","badge-secondary"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.qc(3,Si,48,9,"div",3),o.Nb(),o.Nb(),o.Nb()),2&e&&(o.xb(3),o.cc("ngIf",t.order))},directives:[n.m,n.l,F.a,n.k],pipes:[n.e],styles:[".images-list[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%]{align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]{display:flex;align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.checkbox-label[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:0;margin-right:15px}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.switch[_ngcontent-%COMP%]{margin:0}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{display:flex!important;justify-content:flex-end}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]   .reset-btn[_ngcontent-%COMP%]{margin-left:8px;padding:5px 5px 0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;margin-top:40px;margin-bottom:10px;margin-right:0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--theme-secondary);margin-bottom:0;margin-right:10px;font-size:16px}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:var(--theme-secondary);border:1px solid var(--theme-secondary);padding:10px;border-radius:3px;cursor:pointer}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:24%;margin-left:1%;padding:10px;border-radius:5px;background:#ecf3fa;box-shadow:1px 1px 3px grey;cursor:pointer;margin-bottom:15px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:hover{transition:all .2s ease;box-shadow:2px 2px 5px grey}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{width:100%;height:190px;overflow:hidden;display:flex;align-items:center;justify-content:center}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#8f9aa5!important}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;margin-top:10px;padding:10px 0}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .whole[_ngcontent-%COMP%]{width:100%;margin-top:10px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px;width:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image.selected[_ngcontent-%COMP%]{background:#ffcc01;box-shadow:2px 2px 5px grey}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{height:1200px!important}.image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto!important;height:66.5%!important;vertical-align:top}.image[_ngcontent-%COMP%]   .image-owned.img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px!important;width:auto!important}@media screen and (max-width:1600px){.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}}@media screen and (max-width:1500px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:32%!important}}@media screen and (max-width:1200px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}}@media screen and (max-width:992px){.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{flex-direction:column}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:15px}}@media screen and (max-width:768px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center}}@media screen and (max-width:400px){.images-list[_ngcontent-%COMP%]   .picker[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px!important}.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.375rem 0!important;width:48%}}",""]}),e})()},{path:"caja/:orderId",component:(()=>{class e{constructor(e,t,i,n,a,r,o){this.ordersService=e,this.route=t,this.router=i,this.authService=n,this.backToService=a,this.galleryService=r,this.imgFiltersService=o,this.discuountotal=0,this.imagesAmountDiscountPerImagePercentaje=0,this.imagesAmountDiscount=null,this.imagesAmountDiscountPerImage=0,this.couponDiscount={percentage:0},this.originalImgsPrice=null,this.originalImgsAmount=0,this.totalPerImage=null,this.subtotal=0,this.total=0,this.backToService.backTo="/imagenes",this.route.params.subscribe(e=>{e.orderId||this.router.navigate(["/"]),this.orderId=e.orderId}),this.getOrder()}ngOnInit(){}getOrder(){this.ordersService.getOrderCaja(this.orderId).subscribe(e=>{this.order=e.order,this.originalImgsAmount=e.originalImgsAmount,this.originalImgsPrice=this.order.subtotal/e.originalImgsAmount,this.totalPerImage=this.originalImgsPrice,this.calculateTotal(),this.order.images.forEach(e=>{e.fullpath=e.copyFileName})})}goToImage(e){this.imgFiltersService.lastSeenImg=this.order.images.filter(t=>t._id===e)[0],this.galleryService.setData(this.order.images,[]),this.backToService.backTo=this.router.url,this.router.navigate(["/producto",e])}RemoveItemDetail(e){this.order.images=this.order.images.filter(t=>t._id!==e._id),this.calculateTotal()}Recalculate(){this.order.discounts=[],this.order.discounts.push({discountAmount:this.discuountotal,title:"Descuento por im\xe1genes",type:"imagesAmount"}),this.RecalculateTotal()}updateOrder(){this.ordersService.updateOrder(this.order).subscribe(e=>{this.router.navigate(["/caja"])})}volver(){this.router.navigate(["/caja"])}calculateTotal(){this.subtotal=this.originalImgsPrice*this.order.images.length,this.total=this.originalImgsPrice*this.order.images.length,this.order.discounts.forEach(e=>{const t=e.discountAmount/this.originalImgsAmount;"imagesAmount"==e.type?(this.imagesAmountDiscount=e,this.imagesAmountDiscountPerImage=t.toFixed(2),this.totalPerImage-=t,this.total-=t*this.order.images.length):(this.couponDiscount=e,this.totalPerImage-=t,this.total=this.total*(1-e.percentage/100))})}RecalculateTotal(){this.couponDiscount={percentage:0},this.subtotal=this.originalImgsPrice*this.order.images.length,this.total=this.originalImgsPrice*this.order.images.length,this.order.discounts.forEach(e=>{"imagesAmount"==e.type&&(this.imagesAmountDiscount=e,this.imagesAmountDiscountPerImage=(this.discuountotal/this.order.images.length).toFixed(2),this.totalPerImage-=this.imagesAmountDiscountPerImage,this.total-=this.discuountotal)})}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(Gt),o.Jb(s.a),o.Jb(s.f),o.Jb(x.a),o.Jb(w),o.Jb(y),o.Jb(_.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-order-caja-detail"]],decls:4,vars:1,consts:[[1,"container-fluid"],[1,"card"],[1,"card-body"],["class","row product-page-main",4,"ngIf"],[1,"row","product-page-main"],[1,"col-12"],[1,"title","mb-4","text-center"],[1,"col-12","mt-4"],[1,"user-info","mt-4","mb-4"],[1,"sub-title","mb-4"],[1,"info"],[1,"info-row"],[1,"bold"],[1,"col-12","desglose"],["type","text","placeholder","Ejemplo: 500",1,"form-control",2,"max-width","180px",3,"ngModel","ngModelChange"],[1,"col-12","mt-4","images-list"],[1,"sub-title","mt-4","mb-4"],[1,"btn","btn-success","lg-col",3,"click"],[3,"icon"],[1,"table"],[4,"ngFor","ngForOf"],[1,"subtotal"],["colspan","2",2,"text-align","right"],[4,"ngIf"],[1,"total"],[1,"images","mt-4"],["class","image",3,"click",4,"ngFor","ngForOf"],[1,"btn","btn-secondary","lg-col",3,"click"],[1,"btn","btn-danger","mr-2",3,"click"],[2,"position","relative","left","-5px"],[1,"image",3,"click"],[1,"thumbnail","image-owned",3,"ngClass"],["alt","",3,"src"],["class","tag-list mt-2",4,"ngIf"],[1,"image-info","mt-3"],["class","creation-date",4,"ngIf"],[1,"creation-date"],[1,"tag-list","mt-2"],["class","badge badge-pill badge-secondary",4,"ngFor","ngForOf"],[1,"badge","badge-pill","badge-secondary"]],template:function(e,t){1&e&&(o.Ob(0,"div",0),o.Ob(1,"div",1),o.Ob(2,"div",2),o.qc(3,Yi,86,14,"div",3),o.Nb(),o.Nb(),o.Nb()),2&e&&(o.xb(3),o.cc("ngIf",t.order))},directives:[n.m,k.a,k.i,k.k,F.a,n.l,n.k],pipes:[n.e],styles:[".images-list[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%]{align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]{display:flex;align-items:center}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.checkbox-label[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:0;margin-right:15px}.images-list[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   label.switch[_ngcontent-%COMP%]{margin:0}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{display:flex!important;justify-content:flex-end}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]   .reset-btn[_ngcontent-%COMP%]{margin-left:8px;padding:5px 5px 0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;margin-top:40px;margin-bottom:10px;margin-right:0}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--theme-secondary);margin-bottom:0;margin-right:10px;font-size:16px}.images-list[_ngcontent-%COMP%]   .list-type[_ngcontent-%COMP%]   .list-type-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:var(--theme-secondary);border:1px solid var(--theme-secondary);padding:10px;border-radius:3px;cursor:pointer}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:24%;margin-left:1%;padding:10px;border-radius:5px;background:#ecf3fa;box-shadow:1px 1px 3px grey;cursor:pointer;margin-bottom:15px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:hover{transition:all .2s ease;box-shadow:2px 2px 5px grey}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{width:100%;height:190px;overflow:hidden;display:flex;align-items:center;justify-content:center}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#8f9aa5!important}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;margin-top:10px;padding:10px 0}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   .whole[_ngcontent-%COMP%]{width:100%;margin-top:10px}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px;width:auto}.images-list[_ngcontent-%COMP%]   .images[_ngcontent-%COMP%]   .image.selected[_ngcontent-%COMP%]{background:#ffcc01;box-shadow:2px 2px 5px grey}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{height:1200px!important}.image[_ngcontent-%COMP%]   .img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto!important;height:66.5%!important;vertical-align:top}.image[_ngcontent-%COMP%]   .image-owned.img-vertical[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:190px!important;width:auto!important}@media screen and (max-width:1600px){.images-list.big-images[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}}@media screen and (max-width:1500px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:32%!important}}@media screen and (max-width:1200px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:49%!important}}@media screen and (max-width:992px){.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{flex-direction:column}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filters-options[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:15px}}@media screen and (max-width:768px){.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{width:100%!important}.images-list[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center}}@media screen and (max-width:400px){.images-list[_ngcontent-%COMP%]   .picker[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px!important}.images-list[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .options[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.375rem 0!important;width:48%}}",""]}),e})()},{path:"mercadopago/payment/:status",component:(()=>{class e{constructor(e,t,i,n,a){this.route=e,this.router=t,this.cartService=i,this.ordersService=n,this.authService=a,this.ALLOWED_STATUS=["success","pending","failure","rejected"],this.status=null,this.loading=!1}ngOnInit(){this.loading=!0,this.getStatus()}getStatus(){this.route.params.subscribe(e=>{this.ALLOWED_STATUS.indexOf(e.status)<0?this.router.navigate(["/"]):(this.status=e.status,this.getQueryParams())})}getQueryParams(){this.route.queryParams.subscribe(e=>{"approved"==e.status?this.cartService.cleanCart().subscribe(t=>{this.cartService.cartUpdated.emit("updated"),this.setUserPurchases(e.external_reference)}):this.loading=!1})}setUserPurchases(e){this.ordersService.getClientOrder(e).subscribe(e=>{e.order.images.forEach(e=>{const t=this.authService.user;t.purchases.indexOf(e)<0&&t.purchases.push(e),this.authService.user=t,this.authService.refreshUser(),this.loading=!1})})}}return e.\u0275fac=function(t){return new(t||e)(o.Jb(s.a),o.Jb(s.f),o.Jb(M.a),o.Jb(Gt),o.Jb(x.a))},e.\u0275cmp=o.Db({type:e,selectors:[["app-payment-status"]],decls:2,vars:2,consts:[["class","payment-status",4,"ngIf"],["class","loading",4,"ngIf"],[1,"payment-status"],["class","success info-container",4,"ngIf"],["class","error info-container",4,"ngIf"],[1,"button-container","text-center"],["routerLink","/",1,"btn","btn-primary"],[1,"success","info-container"],[1,"icon-container"],[1,"fa","fa-exclamation",2,"color","orange"],[1,"error","info-container"],[1,"fa","fa-times",2,"color","red"],[1,"fa","fa-check",2,"color","green"],[1,"loading"],[1,"fa","fa-spinner","fa-spin"]],template:function(e,t){1&e&&(o.qc(0,Ji,7,3,"div",0),o.qc(1,Ki,2,0,"div",1)),2&e&&(o.cc("ngIf",!t.loading),o.xb(1),o.cc("ngIf",t.loading))},directives:[n.m,s.i],styles:[".loading[_ngcontent-%COMP%]{width:100%;height:70vh;display:flex;justify-content:center;align-items:center}.loading[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--theme-deafult);font-size:10vh}.payment-status[_ngcontent-%COMP%] > div.info-container[_ngcontent-%COMP%]{width:100%;margin-top:20vh;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-bottom:4vh}.payment-status[_ngcontent-%COMP%] > div.info-container[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:10vh;margin-bottom:2vh}.payment-status[_ngcontent-%COMP%] > div.info-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center}"]}),e})()}]}];let Ui=(()=>{class e{}return e.\u0275mod=o.Hb({type:e}),e.\u0275inj=o.Gb({factory:function(t){return new(t||e)},imports:[[s.j.forChild(Li)],s.j]}),e})();var Bi=i("PCNd"),Gi=i("O0x4");let $i=(()=>{class e{}return e.\u0275mod=o.Hb({type:e}),e.\u0275inj=o.Gb({factory:function(t){return new(t||e)},providers:[{provide:"Window",useValue:window}],imports:[[n.c,Ui,Bi.a,Gi.a]]}),e})()}}]);